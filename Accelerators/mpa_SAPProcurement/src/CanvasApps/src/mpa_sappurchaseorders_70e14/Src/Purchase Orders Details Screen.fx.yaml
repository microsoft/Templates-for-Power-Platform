"'Purchase Orders Details Screen' As screen":
    Fill: =varThemeColors.background
    OnVisible: |
        =//Logic is only called the first time application loads. Allows for faster app launch time.
        If(
            Or(
                IsBlank(varLoadAppFirstTime),
                varLoadAppFirstTime
            ),
            //Variable drives whether the left navigation menu component is expanded or not across screens
            Set(
                varExpandMenu,
                App.ActiveScreen.Size >= ScreenSize.Large
            );
            Set(
                varISOUserLanguageCode,//Get user's language and map to existing choice values that are supported by the 'SAP Localizations' entity which can be customized to support more languages
                Switch(
                    Left(
                        Language(),
                        2
                    ),
                    "ar",
                    'ISO Language Code'.ar,
                    "de",
                    'ISO Language Code'.de,
                    "en",
                    'ISO Language Code'.en,
                    "es",
                    'ISO Language Code'.es,
                    "fr",
                    'ISO Language Code'.fr,
                    "he",
                    'ISO Language Code'.he,
                    "it",
                    'ISO Language Code'.it,
                    "ja",
                    'ISO Language Code'.ja,
                    "pt",
                    'ISO Language Code'.pt,
                    "zh",
                    'ISO Language Code'.zh,
                    'ISO Language Code'.en
                )
            );
            Concurrent(
                ClearCollect(
                    colUserLocalizedStrings,//Collection used to display localized value according to user's language value
                    Filter(
                        'SAP Localizations',
                        Language = varISOUserLanguageCode,
                        'SAP Localizations (Views)'.'Active SAP Localizations'
                    )
                ),
                Set(
                    varVendorAccess,//Variable used to allow drilling into vendor details app if user has access. Will be blank if user does not have access to the vendor menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.Vendors && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                Set(
                    varRequisitionAccess,//Variable used to allow drilling into requisition details app if user has access. Will be blank if user does not have access to the purchase order menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.Requisitions && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                //Get user's principal name from Office graph and store in variable
                Set(
                    varUserPrincipal,
                    Office365Users.MyProfileV2().userPrincipalName
                );
                //Lookup system user record in Dataverse for the user's principal name and store. Variable will be used when patching search histories
        Set(
                    varSystemUserID,
                    LookUp(
                        Users,
                        'User Name' = varUserPrincipal
                    ).User
                )
            );
            Set(
                varPurchaseOrderItemsSortByColumn,//Default purchase order items sort column variable
                btnPurchaseOrderItemsTableHeaderItem.Text
            );
            Set(
                varPurchaseOrderItemsSortOrder,//Default purchase order items sort order variable
                SortOrder.Ascending
            );
            If(
                !IsBlank(Param("purchaseorder")),//Allows for another app to launch this app with a specific purchase order record in focus
                Set(
                    varSelectedPurchaseOrderID,//Global variable used to invoke ReadPurchaseOrder power automate call to query specific vendor from SAP
                    Param("purchaseorder")
                );
            );
            // Other apps such as vendors may want to launch the this app in default new record mode
            If(
                !IsBlank(Param("mode")) && Param("mode") = "new",
                Set(
                    varIsNew,
                    true
                );
                //check to see if a default vendor was supplied on the application launch such as from create new requisition from vendor app
                If( // If vendor is not blank, store it in varSelectedVendorID variable and execute logic to read the vendor details
                    !IsBlank(Param("vendor")),
                    Set(
                        varSelectedVendorID,
                        Param("vendor")
                    );
                    Select(icoPurchaseOrderDetailsVendorSearch)
                );
                
            );
            Set(
                varLoadAppFirstTime,//All app first time loading logic is complete so set variable to false so not to execute again when navigating to screen
                false
            );
            
        );
        //End app first start logic
        //Reset controls
        Set(
            varResetSelectRows,
            true
        );
        //work around to reset gallery select row checkbox and selected row highlighted
        Set(
            varResetSelectRows,
            false
        );
        Reset(chbPurchaseOrderDetailsItemsSelectAll);
        Reset(txtPurchaseOrderDetailsItemsFilter);
        //Reset all search controls in the component
        UpdateContext({_resetCommandBar:false});
        UpdateContext({_resetCommandBar:true});
        //Collection that tracks cross screen navigation thread and allows to back out in reverse sequence, remove from "thread" if navigating back to this screen
        RemoveIf(
            colAppNavigationThreads,
            Screen = App.ActiveScreen
        );
        //Invoke logic contained in a hidden button control to query purchase order if varSelectedPurchaseOrderID not blank
        If(
            !IsBlank(varSelectedPurchaseOrderID),
            Select(btnPurchaseOrderSearchLogicHidden)
        );

    conPurchaseOrderDetailsMain As groupContainer.verticalAutoLayoutContainer:
        Height: =App.Height-Self.Y
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        PaddingBottom: =20
        Width: =App.Width-Self.X
        X: =cmpPurchaseOrderDetailsLeftNavigation.Width
        Y: =cmpPurchaseOrderDetailsHeader.Height
        ZIndex: =1

        cmpPurchaseOrderDetailsMainCommandBar As CommandBar:
            LayoutMinHeight: =
            LayoutMinWidth: =conPurchaseOrderDetailsData.LayoutMinWidth
            ResetCommandBar: =_resetCommandBar
            Width: =

        conPurchaseOrderDetailsScreenTabs As ScreenTabs:
            LayoutMinHeight: =
            LayoutMinWidth: =conPurchaseOrderDetailsData.LayoutMinWidth
            Width: =

        shpPurchaseOrderDetailsMainDivider As rectangle:
            AccessibleLabel: |-
                =// Define a variable named "Text" with the value "{value}"
                With(
                    {
                        Text: "Divider"
                    },
                    If(
                        // If the localized text is blank, return the default text
                        IsBlank(
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        ),
                        Text,
                        // If a localized text is found, return that instead of the default text
                        LookUp(
                            colUserLocalizedStrings,
                            'English Value' = Text
                        ).'Localized Value'
                    )
                )
            Fill: =varThemeColors.secondaryGray
            Height: =1
            LayoutMinHeight: =
            LayoutMinWidth: =conPurchaseOrderDetailsData.LayoutMinWidth
            Width: =
            ZIndex: =2

        lblPurchaseOrderDetailsMainName As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =varThemeColors.text
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =varThemeColors.primary
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =37
            LayoutMinHeight: =
            LayoutMinWidth: =conPurchaseOrderDetailsData.LayoutMinWidth
            Live: =Live.Assertive
            PaddingBottom: =15
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =22
            Role: =TextRole.Heading1
            Size: =14.5
            Text: |-
                =// Define a variable named "Text" with the value "{value}"
                If(
                    !varIsNew && !IsBlank(varPurchaseOrderHeader),
                    Concatenate(
                        varPurchaseOrderNumber,
                        " - ",
                        varPurchaseOrderHeader.VendorName
                    ),
                    With(
                        {
                            Text: If(
                                varIsNew,
                                "New purchase order",
                                "Purchase order"
                            )
                        },
                        If(
                        // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                        // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                )
            Width: =
            Wrap: =false
            ZIndex: =3

        conPurchaseOrderDetailsData As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =20
            LayoutMinHeight: =
            LayoutMinWidth: =conPurchaseOrderDetailsItems.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =20
            Width: =
            ZIndex: =5

            conPurchaseOrderDetailsPurchaseFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: |-
                    =With(
                        {_defaultHeight: 64},
                        If(
                            Self.Width <= 2130,
                            2 * _defaultHeight + Self.LayoutGap,
                            _defaultHeight
                        )
                    )
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =
                ZIndex: =1

                conPurchaseOrderDetailsVendor As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            254,
                            Len(lblPurchaseOrderDetailsVendor.Text) * 10
                        )
                    X: =40
                    ZIndex: =1

                    btnPurchaseOrderDetailsVendorSelect As button:
                        Align: =Align.Left
                        BorderColor: =RGBA(0,0,0,0)
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =
                        OnSelect: |-
                            =Launch(
                                varVendorAccess.'Application URL',
                                {vendor: Self.Text}
                            )
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedColor: =Self.Color
                        PressedFill: =Color.Transparent
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varPurchaseOrderHeader.Vendor,
                                varNewVendorHeader.Vendor
                            )
                        Tooltip: =Self.Text
                        Visible: |-
                            =!Or(
                                varIsNew,
                                varIsEdit
                            ) && !IsBlank(varPurchaseOrderHeader.Vendor) && !IsBlank(varVendorAccess)
                        Width: =lblPurchaseOrderDetailsVendor.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsVendor.Y+lblPurchaseOrderDetailsVendor.Height
                        ZIndex: =1

                    txtPurchaseOrderDetailsVendor As text:
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =Self.Color
                        BorderThickness: =1
                        Color: |-
                            =Switch(
                                true,
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.text
                            )
                        Default: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varPurchaseOrderHeader.Vendor,
                                varNewVendorHeader.Vendor
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                varIsNew,
                                DisplayMode.Edit,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HintText: |-
                            =If(
                                Self.DisplayMode <> DisplayMode.Disabled,
                            // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Enter vendor number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        Italic: |+
                            =Switch(true,
                                IsBlank(Self.Text),
                                false,
                                IsBlank(varNewVendorHeader.Vendor) && Self.Text = varPurchaseOrderHeader.Vendor,
                                false,
                                !IsBlank(varNewVendorHeader.Vendor) && Self.Text = varNewVendorHeader.Vendor,
                                false,
                                true
                            )
                            
                        OnChange: |
                            =Set(
                                varSelectedVendorID,
                                Trim(Self.Text)
                            );
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =//Check first if the vendor is confirmed/resolved
                            If(
                                Self.Italic,// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Vendor needs to be searched and resolved first"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                ),//Otherwise populate resolved value entered or hint text
                                Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            )
                        Visible: =!btnPurchaseOrderDetailsVendorSelect.Visible
                        Width: =lblPurchaseOrderDetailsVendor.Width-icoPurchaseOrderDetailsVendorAdvancedSearch.Width-10-Self.X
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsVendor.Y+lblPurchaseOrderDetailsVendor.Height
                        ZIndex: =2

                    "icoPurchaseOrderDetailsVendorAdvancedSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        Height: =txtPurchaseOrderDetailsVendor.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.FilterFlat
                        OnSelect: |-
                            =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                            Collect(
                                colAppNavigationThreads,
                                Table(
                                    {
                                        Screen: App.ActiveScreen,
                                        Order: CountRows(colAppNavigationThreads) + 1
                                    }
                                )
                            );
                            //sets global variable so the component knows which screen to navigate back to
                            Navigate(
                                'Purchase Order Vendor Search Screen',
                                ScreenTransition.Cover
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor advanced search"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =varIsNew
                        Width: =Self.Height
                        X: =btnPurchaseOrderDetailsVendorSelect.Width-Self.Width
                        Y: =txtPurchaseOrderDetailsVendor.Y
                        ZIndex: =3

                    "icoPurchaseOrderDetailsVendorSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primaryGray
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        Height: =txtPurchaseOrderDetailsVendor.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.ArrowRight
                        OnSelect: |-
                            =If(
                                !IsBlank(varSelectedVendorID),
                            //Sets processing indicator control behavior 
                                Set(
                                    varIsProcessing,
                                    true
                                );
                                
                            //Call ReadVendor Power Automate to read the vendor from SAP
                            ClearCollect(
                                    colReadVendorResponseTemp,//collection that temporarily stores the vendor response data
                                    ReadVendor.Run(varSelectedVendorID)
                                );
                                
                            //Evalute response conditions
                            Switch(
                                    true,
                                    And(//Check to see if vendor call was successful and process happy path logic
                                        First(colReadVendorResponseTemp).Status = "Success",
                                        !IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                    ),
                                    Set(
                                        varNewVendorHeader,//Variable that stores the returned main vendor header data
                                        First(colReadVendorResponseTemp).Header
                                    );
                                    Patch(
                                        'SAP Search Histories',
                                        Coalesce(
                                            LookUp(
                                                'SAP Search Histories',
                                                And(
                                                    'Object Type' = 'Object Type (SAP Search Histories)'.Vendor,
                                                    'Object ID' = varNewVendorHeader.Vendor,
                                                    'Created By'.User = varSystemUserID
                                                )
                                            ),
                                            Defaults('SAP Search Histories')
                                        ),
                                        {
                                            'Object ID': varNewVendorHeader.Vendor,
                                            'Object Type': 'Object Type (SAP Search Histories)'.Vendor,
                                            Name: varNewVendorHeader.FullName,
                                            'Last Searched On': Now()
                                        }
                                    );
                                    //Check if the patch function was successful and notify if there was any errors.
                            If(
                                        !IsEmpty(Errors('SAP Search Histories')),
                                        Notify(
                                            First(Errors('SAP Search Histories')).Message,
                                            NotificationType.Error,
                                            0
                                        ),
                                        Refresh('SAP Search Histories')
                                    );
                                    ,//End if ReadVendor Power Automate call was success
                                    First(colReadVendorResponseTemp).Status = "Error",//Error response returned
                                    Notify(
                                        Concat(
                                            First(colReadVendorResponseTemp).Messages,
                                            Message,
                                            " "
                                        ),
                                        NotificationType.Error,
                                        0
                                    ),
                                    And(//Check to see if call was successful, but no vendor was found
                                        First(colReadVendorResponseTemp).Status = "Information",
                                        IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                    ),
                                    Notify(
                                        With(
                                            {Text: "Vendor not found"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Information,
                                        7000
                                    ),//Default response for an unhandled error return
                                    Notify(
                                        With(
                                            {Text: "Unexpected error occurred"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                
                            //End vendor response switch statement
                            //done with read vendor temp collections, clear cache
                            Clear(colReadVendorResponseTemp);
                                Reset(cmbPurchaseOrderDetailsPurchasingOrg);
                                Reset(cmbPurchaseOrderDetailsPurchasingGroup);
                                Set(
                                    varSelectedVendorID,
                                    Blank()
                                );
                                Set(
                                    varIsProcessing,//done processing read vendor, set variable back to false stopping any processing control behavior
                                    false
                                );
                                
                            )
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =With(
                                {Text: "Execute vendor search"},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =!IsBlank(txtPurchaseOrderDetailsVendor.Text) && varIsNew
                        Width: =Self.Height
                        X: =txtPurchaseOrderDetailsVendor.X+txtPurchaseOrderDetailsVendor.Width-Self.Width
                        Y: =txtPurchaseOrderDetailsVendor.Y
                        ZIndex: =4

                    lblPurchaseOrderDetailsVendor As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conPurchaseOrderDetailsVendorName As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            312,
                            Len(txtPurchaseOrderDetailsVendorName.HintText) * 10
                        )
                    X: =40
                    ZIndex: =2

                    txtPurchaseOrderDetailsVendorName As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varPurchaseOrderHeader.VendorName,
                                varNewVendorHeader.VendorName
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.View,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderDetailsVendorName.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsVendorName.Y+lblPurchaseOrderDetailsVendorName.Height
                        ZIndex: =2

                    lblPurchaseOrderDetailsVendorName As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor name"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conPurchaseOrderDetailsPurchasingOrg As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            264,
                            Len(
                                cmbPurchaseOrderDetailsPurchasingOrg.AccessibleLabel
                            ) * 9
                        )
                    X: =40
                    ZIndex: =3

                    cmbPurchaseOrderDetailsPurchasingOrg As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of purchase order
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varPurchaseOrderHeader.PurchasingOrganization
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varPurchaseOrderHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbPurchaseOrderDetailsPurchasingOrg.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblPurchaseOrderDetailsPurchasingOrg.Width
                        X: =lblPurchaseOrderDetailsPurchasingOrg.X
                        Y: =lblPurchaseOrderDetailsPurchasingOrg.Y+lblPurchaseOrderDetailsPurchasingOrg.Height
                        ZIndex: =1

                    lblPurchaseOrderDetailsPurchasingOrg As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conPurchaseOrderDetailsPurchasingGroup As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(
                                cmbPurchaseOrderDetailsPurchasingGroup.AccessibleLabel
                            ) * 9
                        )
                    X: =40
                    ZIndex: =4

                    cmbPurchaseOrderDetailsPurchasingGroup As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of purchase order
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varPurchaseOrderHeader.PurchasingGroup
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: =cmbPurchaseOrderDetailsPurchasingOrg.DisplayMode
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbPurchaseOrderDetailsPurchasingGroup.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblPurchaseOrderDetailsPurchasingGroup.Width
                        X: =lblPurchaseOrderDetailsPurchasingGroup.X
                        Y: =lblPurchaseOrderDetailsPurchasingGroup.Y+lblPurchaseOrderDetailsPurchasingGroup.Height
                        ZIndex: =1

                    lblPurchaseOrderDetailsPurchasingGroup As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conPurchaseOrderDetailsLocation As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            212,
                            Len(cmbPurchaseOrderDetailsLocation.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =5

                    cmbPurchaseOrderDetailsLocation As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//If there is only 1 location on the items for an existing purchase order, then default to that location
                            With(
                                {
                                    _defaultLocation: If(
                                        CountRows(
                                            Distinct(
                                                colPurchaseOrderItems,
                                                Location
                                            )
                                        ) = 1,
                                        First(
                                            Distinct(
                                                colPurchaseOrderItems,
                                                Location
                                            )
                                        ).Value
                                    )
                                },
                                If(
                                    And(
                                        !varIsNew,
                                        !IsBlank(_defaultLocation)
                                    ),
                                    Filter(
                                        'SAP List of Values',
                                        Status = 'Status (SAP List of Values)'.Active,
                                        Domain = 'Domain (SAP List of Values)'.Location,
                                        Language = varISOUserLanguageCode,
                                        'Value Code' = _defaultLocation
                                    )
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varPurchaseOrderHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbPurchaseOrderDetailsLocation.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblPurchaseOrderDetailsLocation.Width
                        X: =lblPurchaseOrderDetailsLocation.X
                        Y: =lblPurchaseOrderDetailsLocation.Y+lblPurchaseOrderDetailsLocation.Height
                        ZIndex: =1

                    lblPurchaseOrderDetailsLocation As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conPurchaseOrderDetailsTotal As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtPurchaseOrderDetailsTotal.HintText) * 10
                        )
                    X: =40
                    ZIndex: =6

                    txtPurchaseOrderDetailsTotal As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                Self.DisplayMode <> DisplayMode.Disabled,
                                Text(
                                    If(
                                        !IsEmpty(colPurchaseOrderItems),
                                        Sum(
                                            Filter(
                                                colPurchaseOrderItems,
                                                CrudType <> "D"
                                            ),
                                            TotalPrice
                                        ),
                                        0
                                    ),
                                    "[$-en-US]#,##0.00"
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.View,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderDetailsTotal.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsTotal.Y+lblPurchaseOrderDetailsTotal.Height
                        ZIndex: =2

                    lblPurchaseOrderDetailsTotal As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Total"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(//Add currency code value onto string if items are present
                                !IsBlank(cmbPurchaseOrderDetailsCurrency.Selected.'Value Code'),
                                " (" & cmbPurchaseOrderDetailsCurrency.Selected.'Value Code' & ")"
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conPurchaseOrderDetailsCurrency As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(cmbPurchaseOrderDetailsCurrency.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =7

                    cmbPurchaseOrderDetailsCurrency As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of purchase order
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varPurchaseOrderHeader.Currency
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: =cmbPurchaseOrderDetailsPurchasingOrg.DisplayMode
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbPurchaseOrderDetailsCurrency.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblPurchaseOrderDetailsCurrency.Width
                        X: =lblPurchaseOrderDetailsCurrency.X
                        Y: =lblPurchaseOrderDetailsCurrency.Y+lblPurchaseOrderDetailsCurrency.Height
                        ZIndex: =1

                    lblPurchaseOrderDetailsCurrency As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conPurchaseOrderDetailsCreatedBy As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtPurchaseOrderDetailsCreatedBy.HintText) * 10
                        )
                    X: =40
                    ZIndex: =8

                    txtPurchaseOrderDetailsCreatedBy As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                varPurchaseOrderHeader.CreatedBy
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                varIsEdit,
                                DisplayMode.View,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderDetailsCreatedBy.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsCreatedBy.Y+lblPurchaseOrderDetailsCreatedBy.Height
                        ZIndex: =2

                    lblPurchaseOrderDetailsCreatedBy As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Created by"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conPurchaseOrderDetailsCreatedOn As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtPurchaseOrderDetailsCreatedOn.HintText) * 10
                        )
                    X: =40
                    ZIndex: =9

                    txtPurchaseOrderDetailsCreatedOn As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                Text(
                                    DateValue(
                                        varPurchaseOrderHeader.CreatedOn,
                                        "en-US"
                                    ),
                                    DateTimeFormat.ShortDate
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                varIsEdit,
                                DisplayMode.View,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderDetailsCreatedOn.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsCreatedOn.Y+lblPurchaseOrderDetailsCreatedOn.Height
                        ZIndex: =2

                    lblPurchaseOrderDetailsCreatedOn As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Created on"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conPurchaseOrderDetailsApprovedBy As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtPurchaseOrderDetailsApprovedBy.HintText) * 10
                        )
                    X: =40
                    ZIndex: =10

                    txtPurchaseOrderDetailsApprovedBy As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                varPurchaseOrderHeader.ApprovedBy
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                varIsEdit,
                                DisplayMode.View,
                                IsBlank(varPurchaseOrderHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderDetailsApprovedBy.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderDetailsApprovedBy.Y+lblPurchaseOrderDetailsApprovedBy.Height
                        ZIndex: =2

                    lblPurchaseOrderDetailsApprovedBy As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Approved by"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

            conPurchaseOrderDetailsHeaderText As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.Start
                FillPortions: =0
                Height: =128
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: |-
                    =Max(
                        624,
                        Len(txtPurchaseOrderDetailsHeaderText.HintText) * 10
                    )
                X: =40
                ZIndex: =2

                txtPurchaseOrderDetailsHeaderText As text:
                    AccessibleLabel: =Self.HintText
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =1
                    Clear: =true
                    Color: =varThemeColors.text
                    Default: |-
                        =If(
                            varIsNew,
                            "",
                            varPurchaseOrderHeader.HeaderText
                        )
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =Switch(
                            true,
                            varIsProcessing,
                            DisplayMode.Disabled,
                            And(
                                !varIsNew,
                                !varIsEdit,
                                !IsBlank(varPurchaseOrderHeader)
                            ),
                            DisplayMode.View,
                            Or(
                                varIsNew,
                                varIsEdit
                            ),
                            DisplayMode.Edit,
                            DisplayMode.Disabled
                        )
                    EnableSpellCheck: =true
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    Height: =96
                    HintText: |-
                        =If(
                            Self.DisplayMode <> DisplayMode.Disabled,
                        // Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter header text"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        )
                    HoverBorderColor: =Self.BorderColor
                    HoverColor: =varThemeColors.text
                    HoverFill: =varThemeColors.backgroundFill
                    Mode: =TextMode.MultiLine
                    OnChange: =
                    PaddingBottom: =6
                    PaddingLeft: =8
                    PaddingRight: =8
                    PaddingTop: =6
                    PressedBorderColor: =Self.BorderColor
                    PressedColor: =varThemeColors.text
                    PressedFill: =varThemeColors.backgroundFill
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Reset: =true
                    Size: =10.5
                    Tooltip: |-
                        =Coalesce(
                            Self.Text,
                            Self.HintText
                        )
                    Width: =lblPurchaseOrderDetailsHeaderText.Width
                    X: =Self.FocusedBorderThickness
                    Y: =lblPurchaseOrderDetailsHeaderText.Y+lblPurchaseOrderDetailsHeaderText.Height
                    ZIndex: =2

                lblPurchaseOrderDetailsHeaderText As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Semibold
                    Height: =30
                    PaddingLeft: =0
                    PaddingRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Header text"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Width: =Parent.Width-Self.FocusedBorderThickness*2
                    X: =Self.FocusedBorderThickness
                    ZIndex: =3

            conPurchaseOrderDetailsItems As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conPurchaseOrderItemsTable.LayoutMinHeight + shpPurchaseOrderDetailItemsDivider.Height + conPurchaseOrderDetailsItemsCommandBar.Height + lblPurchaseOrderItemsNumberOfFoundRecords.Height
                LayoutMinWidth: =conPurchaseOrderItemsTable.LayoutMinWidth+Self.PaddingLeft+Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =3

                conPurchaseOrderDetailsItemsCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =39
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    conPurchaseOrderDetailsItemsCommandBarLeft As groupContainer.horizontalAutoLayoutContainer:
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        lblPurchaseOrderDetailsItems As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )&" *"
                            Width: =Len(Self.Text)*7
                            ZIndex: =1

                        conPurchaseOrderDetailsItemsAddButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            LayoutMinWidth: =250
                            Visible: =Or(varIsEdit,varIsNew)
                            Width: =Len(btnPurchaseOrderDetailsItemsAddButton.Text)*10+btnPurchaseOrderDetailsItemsAddButton.PaddingLeft+btnPurchaseOrderDetailsItemsAddButton.PaddingRight
                            X: =lblPurchaseOrderDetailsItems.Width+10
                            ZIndex: =2

                            icoPurchaseOrderDetailsItemsAddButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Add"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderDetailsItemsAddButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Add
                                Width: =16
                                X: =5
                                Y: =btnPurchaseOrderDetailsItemsAddButton.Y+btnPurchaseOrderDetailsItemsAddButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderDetailsItemsAddButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                                    ClearCollect(
                                        colAppNavigationThreads,
                                        Table(
                                            {
                                                Screen: App.ActiveScreen,
                                                Order: CountRows(colAppNavigationThreads) + 1
                                            }
                                        )
                                    );
                                    //Navigate to the item details screen
                                    Navigate(
                                        'Purchase Order Item Details Screen',
                                        ScreenTransition.Cover,
                                        {
                                            _item: Blank(),
                                            _reset: true,
                                            _currencyCode: cmbPurchaseOrderDetailsCurrency.Selected.'Value Code',
                                            _defaultLocation: cmbPurchaseOrderDetailsLocation.Selected.'Value Code'
                                        }
                                    )
                                PaddingLeft: =icoPurchaseOrderDetailsItemsAddButton.X + icoPurchaseOrderDetailsItemsAddButton.Width + 8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Add"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderDetailsItemsCopyButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            LayoutMinWidth: =250
                            Visible: |-
                                =//Make the button visible only if the following conditions are true
                                And(
                                    Or(//if a record is being created or updated
                                        varIsEdit,
                                        varIsNew
                                    ),
                                    !IsEmpty(//if one or more rows is selected
                                        Filter(
                                            galPurchaseOrderItems.AllItems,
                                            chbPurchaseOrderDetailsItemSelectRow.Value
                                        )
                                    )
                                )
                            Width: =Len(btnPurchaseOrderDetailsItemsCopyButton.Text)*11+btnPurchaseOrderDetailsItemsCopyButton.PaddingLeft
                            X: =conPurchaseOrderDetailsItemsAddButton.X+conPurchaseOrderDetailsItemsAddButton.Width+10
                            ZIndex: =3

                            icoPurchaseOrderDetailsItemsCopyButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Delete"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderDetailsItemsCopyButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Copy
                                Width: =16
                                X: =5
                                Y: =btnPurchaseOrderDetailsItemsCopyButton.Y+btnPurchaseOrderDetailsItemsCopyButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderDetailsItemsCopyButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =ForAll(
                                        Filter(
                                            colPurchaseOrderItems,
                                            ItemNumber in Filter(
                                                galPurchaseOrderItems.AllItems,
                                                chbPurchaseOrderDetailsItemSelectRow.Value = true
                                            ).ItemNumber
                                        ),
                                        Collect(
                                            colPurchaseOrderItems,
                                            {
                                                CrudType: "C",
                                                ItemNumber: Text(CountRows(colPurchaseOrderItems) + 1),
                                                Location: Location,
                                                MaterialNumber: MaterialNumber,
                                                Description: Description,
                                                UnitOfMeasure: UnitOfMeasure,
                                                UnitPrice: UnitPrice,
                                                Quantity: Quantity,
                                                TotalPrice: TotalPrice
                                            }
                                        )
                                    );
                                    Reset(chbPurchaseOrderDetailsItemsSelectAll);
                                    //work around to reset gallery select row checkbox and selected row highlighted
                                    Set(
                                        varResetSelectRows,
                                        true
                                    );
                                    Set(
                                        varResetSelectRows,
                                        false
                                    );
                                PaddingLeft: =icoPurchaseOrderDetailsItemsCopyButton.X+icoPurchaseOrderDetailsItemsCopyButton.Width+8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Copy"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderDetailsItemsDeleteButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            LayoutMinWidth: =250
                            Visible: |-
                                =//Make the button visible only if the following conditions are true
                                And(
                                    Or(//if a record is being created or updated
                                        varIsEdit,
                                        varIsNew
                                    ),
                                    !IsEmpty(//if one or more rows is selected
                                        Filter(
                                            galPurchaseOrderItems.AllItems,
                                            chbPurchaseOrderDetailsItemSelectRow.Value
                                        )
                                    )
                                )
                            Width: =Len(btnPurchaseOrderDetailsItemsDeleteButton.Text)*10+btnPurchaseOrderDetailsItemsDeleteButton.PaddingLeft
                            X: =conPurchaseOrderDetailsItemsCopyButton.X+conPurchaseOrderDetailsItemsCopyButton.Width+10
                            ZIndex: =4

                            icoPurchaseOrderDetailsItemsDeleteButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Delete"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderDetailsItemsDeleteButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Cancel
                                Width: =16
                                X: =5
                                Y: =btnPurchaseOrderDetailsItemsDeleteButton.Y+btnPurchaseOrderDetailsItemsDeleteButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderDetailsItemsDeleteButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =RemoveIf(
                                        colPurchaseOrderItems,
                                        And(
                                            ItemNumber in Filter(
                                                galPurchaseOrderItems.AllItems,
                                                chbPurchaseOrderDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType = "C"
                                        )
                                    );
                                    UpdateIf(
                                        colPurchaseOrderItems,
                                        And(
                                            ItemNumber in Filter(
                                                galPurchaseOrderItems.AllItems,
                                                chbPurchaseOrderDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType <> "C"
                                        ),
                                        {CrudType: "D"}
                                    );
                                    Reset(chbPurchaseOrderDetailsItemsSelectAll);
                                    //work around to reset gallery select row checkbox and selected row highlighted
                                    Set(
                                        varResetSelectRows,
                                        true
                                    );
                                    Set(
                                        varResetSelectRows,
                                        false
                                    );
                                PaddingLeft: =icoPurchaseOrderDetailsItemsDeleteButton.X+icoPurchaseOrderDetailsItemsDeleteButton.Width+8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Delete"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    conPurchaseOrderDetailsItemsFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Visible: =galPurchaseOrderItems.Visible
                        Width: =txtPurchaseOrderDetailsItemsFilter.X+txtPurchaseOrderDetailsItemsFilter.Width+txtPurchaseOrderDetailsItemsFilter.FocusedBorderThickness
                        ZIndex: =3

                        txtPurchaseOrderDetailsItemsFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(
                                        IsEmpty(colPurchaseOrderItems),
                                        varIsProcessing
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.tertiaryGray
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =If(
                                    Self.DisplayMode <> DisplayMode.Disabled,
                                // Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Filter items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                        // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                        // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpPurchaseOrderDetailsItemsFilter.X+shpPurchaseOrderDetailsItemsFilter.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpPurchaseOrderDetailsItemsFilter As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpPurchaseOrderDetailItemsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    Width: =
                    ZIndex: =3

                conPurchaseOrderItemsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conPurchaseOrderItemsTableHeader.Height + shpPurchaseOrderItemsTableDivider.Height + If(
                            galPurchaseOrderItems.Visible,
                            galPurchaseOrderItems.LayoutMinHeight,
                            cmpNoPurchaseOrderItemsDisplay.Height
                        ) + Self.PaddingTop + Self.PaddingBottom
                    LayoutMinWidth: =conPurchaseOrderItemsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =
                    ZIndex: =4

                    conPurchaseOrderItemsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =chbPurchaseOrderDetailsItemsSelectAll.Width + conPurchaseOrderItemsTableHeaderItem.LayoutMinWidth + conPurchaseOrderItemsTableHeaderLocation.LayoutMinWidth + conPurchaseOrderItemsTableHeaderMaterialNumber.LayoutMinWidth + conPurchaseOrderItemsTableHeaderMaterialDescription.LayoutMinWidth + conPurchaseOrderItemsTableHeaderQuantity.LayoutMinWidth + conPurchaseOrderItemsTableHeaderUnit.LayoutMinWidth + conPurchaseOrderItemsTableHeaderUnitPrice.LayoutMinWidth + conPurchaseOrderItemsTableHeaderTotal.LayoutMinWidth + conPurchaseOrderItemsTableHeaderRequisition.LayoutMinWidth + conPurchaseOrderItemsTableHeaderGoodsReceipt.Width + 200
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =2
                        Width: =
                        ZIndex: =1

                        chbPurchaseOrderDetailsItemsSelectAll As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =varThemeColors.text
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: |-
                                =If(
                                    And(
                                        CountRows(
                                            Filter(
                                                colPurchaseOrderItems,
                                                CrudType <> "D"
                                            )
                                        ) > 0,
                                        Or(
                                            varIsNew,
                                            varIsEdit
                                        ),
                                        !varIsProcessing
                                    ),
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            FocusedBorderColor: =varThemeColors.tertiaryGray
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height-Self.FocusedBorderThickness*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            LayoutMinWidth: =75
                            OnCheck: =Set(varResetSelectRows, Self.Value)
                            OnUncheck: =Set(varResetSelectRows, Self.Value)
                            PressedColor: =Self.Color
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Select"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =Len(Self.Text) * 10 + Self.CheckboxSize
                            ZIndex: =1

                        conPurchaseOrderItemsTableHeaderItem As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderItem.X+icoPurchaseOrderItemsTableHeaderItem.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =2

                            icoPurchaseOrderItemsTableHeaderItem As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderItem.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn=btnPurchaseOrderItemsTableHeaderItem.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderItem.Text)*10+8
                                Y: =btnPurchaseOrderItemsTableHeaderItem.Y+btnPurchaseOrderItemsTableHeaderItem.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderItem As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Item"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderLocation As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderLocation.X+icoPurchaseOrderItemsTableHeaderLocation.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =3

                            icoPurchaseOrderItemsTableHeaderLocation As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderLocation.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn=btnPurchaseOrderItemsTableHeaderLocation.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderLocation.Text)*8.5+8
                                Y: =btnPurchaseOrderItemsTableHeaderLocation.Y+btnPurchaseOrderItemsTableHeaderLocation.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderLocation As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Location"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderMaterialNumber As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderMaterialNumber.X+icoPurchaseOrderItemsTableHeaderMaterialNumber.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =4

                            icoPurchaseOrderItemsTableHeaderMaterialNumber As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderMaterialNumber.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderMaterialNumber.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderMaterialNumber.Text)*8+8
                                Y: =btnPurchaseOrderItemsTableHeaderMaterialNumber.Y+btnPurchaseOrderItemsTableHeaderMaterialNumber.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderMaterialNumber As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Material"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderMaterialDescription As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =3
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderMaterialDescription.X+icoPurchaseOrderItemsTableHeaderMaterialDescription.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =5

                            icoPurchaseOrderItemsTableHeaderMaterialDescription As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderMaterialDescription.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderMaterialDescription.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderMaterialDescription.Text)*7.5+8
                                Y: =btnPurchaseOrderItemsTableHeaderMaterialDescription.Y+btnPurchaseOrderItemsTableHeaderMaterialDescription.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderMaterialDescription As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Description"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderQuantity As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderQuantity.X+icoPurchaseOrderItemsTableHeaderQuantity.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =6

                            icoPurchaseOrderItemsTableHeaderQuantity As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderQuantity.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderQuantity.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderQuantity.Text)*8+8
                                Y: =btnPurchaseOrderItemsTableHeaderQuantity.Y+btnPurchaseOrderItemsTableHeaderQuantity.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderQuantity As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Quantity"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderUnit As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderUnit.X+icoPurchaseOrderItemsTableHeaderUnit.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =7

                            icoPurchaseOrderItemsTableHeaderUnit As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderUnit.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderUnit.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderUnit.Text)*9.5+8
                                Y: =btnPurchaseOrderItemsTableHeaderUnit.Y+btnPurchaseOrderItemsTableHeaderUnit.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderUnit As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderUnitPrice As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderUnitPrice.X+icoPurchaseOrderItemsTableHeaderUnitPrice.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =8

                            icoPurchaseOrderItemsTableHeaderUnitPrice As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderUnitPrice.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderUnitPrice.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderUnitPrice.Text)*7+8
                                Y: =btnPurchaseOrderItemsTableHeaderUnitPrice.Y+btnPurchaseOrderItemsTableHeaderUnitPrice.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderUnitPrice As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit price"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )& If(//Add currency code value onto string if items are present
                                        !IsBlank(cmbPurchaseOrderDetailsCurrency.Selected.'Value Code'),
                                        " (" & cmbPurchaseOrderDetailsCurrency.Selected.'Value Code' & ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderTotal As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderTotal.X+icoPurchaseOrderItemsTableHeaderTotal.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =9

                            icoPurchaseOrderItemsTableHeaderTotal As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderTotal.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderTotal.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderTotal.Text)*7+8
                                Y: =btnPurchaseOrderItemsTableHeaderTotal.Y+btnPurchaseOrderItemsTableHeaderTotal.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderTotal As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Total"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )& If(//Add currency code value onto string if items are present
                                        !IsBlank(cmbPurchaseOrderDetailsCurrency.Selected.'Value Code'),
                                        " (" & cmbPurchaseOrderDetailsCurrency.Selected.'Value Code' & ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderRequisition As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderRequisition.X+icoPurchaseOrderItemsTableHeaderRequisition.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =10

                            icoPurchaseOrderItemsTableHeaderRequisition As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderRequisition.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderRequisition.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderRequisition.Text)*7.5+8
                                Y: =btnPurchaseOrderItemsTableHeaderRequisition.Y+btnPurchaseOrderItemsTableHeaderRequisition.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderRequisition As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Requisition"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderItemsTableHeaderGoodsReceipt As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderItemsTableHeaderGoodsReceipt.X+icoPurchaseOrderItemsTableHeaderGoodsReceipt.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =11

                            icoPurchaseOrderItemsTableHeaderGoodsReceipt As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderItemsTableHeaderGoodsReceipt.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderItemsSortByColumn = btnPurchaseOrderItemsTableHeaderGoodsReceipt.Text && galPurchaseOrderItems.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderItemsTableHeaderGoodsReceipt.Text)*7.5+8
                                Y: =btnPurchaseOrderItemsTableHeaderGoodsReceipt.Y+btnPurchaseOrderItemsTableHeaderGoodsReceipt.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderItemsTableHeaderGoodsReceipt As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.tertiaryGray
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderItemsSortOrder = SortOrder.Ascending,varPurchaseOrderItemsSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Goods receipt"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        lblPurchaseOrderItemsTableHeaderDetails As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisplayMode: |-
                                =If(
                                    And(galPurchaseOrderItems.Visible,!varIsProcessing),
                                    DisplayMode.Edit,
                                    DisplayMode.View
                                )
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =43
                            LayoutMinWidth: =75
                            PaddingBottom: =0
                            PaddingLeft: =2
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Details"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Len(Self.Text) * 16
                            Wrap: =false
                            X: =conPurchaseOrderItemsTableHeaderItem.X
                            ZIndex: =12

                    shpPurchaseOrderItemsTableDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =
                        ZIndex: =2

                    galPurchaseOrderItems As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        FocusedBorderThickness: =2
                        Height: |-
                            =CountRows(
                                Filter(
                                    colPurchaseOrderItems,
                                    CrudType <> "D"
                                )
                            ) * Self.TemplateHeight
                        ItemAccessibleLabel: =ThisItem.Description
                        Items: |-
                            =With(
                                {
                                    itemsList: AddColumns(
                                        Filter(
                                            If(
                                                IsBlank(txtPurchaseOrderDetailsItemsFilter.Text),
                                                colPurchaseOrderItems,
                                                Search(
                                                    colPurchaseOrderItems,
                                                    txtPurchaseOrderDetailsItemsFilter.Text,
                                                    "Description",
                                                    "Location",
                                                    "MaterialNumber",
                                                    "UnitOfMeasure",
                                                    "PurchaseRequisitionNumber"
                                                )
                                            ),
                                            CrudType <> "D"
                                        ),
                                        "_ItemSort",
                                        Value(ItemNumber)
                                    )
                                },
                                SortByColumns(
                                    itemsList,
                                    Switch(
                                        varPurchaseOrderItemsSortByColumn,
                                        btnPurchaseOrderItemsTableHeaderItem.Text,
                                        "_ItemSort",
                                        btnPurchaseOrderItemsTableHeaderLocation.Text,
                                        "Location",
                                        btnPurchaseOrderItemsTableHeaderMaterialNumber.Text,
                                        "MaterialNumber",
                                        btnPurchaseOrderItemsTableHeaderMaterialDescription.Text,
                                        "Description",
                                        btnPurchaseOrderItemsTableHeaderUnit.Text,
                                        "UnitOfMeasure",
                                        btnPurchaseOrderItemsTableHeaderUnitPrice.Text,
                                        "UnitPrice",
                                        btnPurchaseOrderItemsTableHeaderQuantity.Text,
                                        "Quantity",
                                        btnPurchaseOrderItemsTableHeaderTotal.Text,
                                        "TotalPrice",
                                        btnPurchaseOrderItemsTableHeaderGoodsReceipt.Text,
                                        "_GoodsReceipt",
                                        btnPurchaseOrderItemsTableHeaderRequisition.Text,
                                        "PurchaseRequisitionNumber"
                                    ),
                                    varPurchaseOrderItemsSortOrder
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: |-
                            =If(
                                chbPurchaseOrderDetailsItemSelectRow.Value,
                                ColorFade(varThemeColors.secondaryGray,50%),
                                RGBA(
                                    255,
                                    255,
                                    255,
                                    1
                                )
                            )
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =CountRows(colPurchaseOrderItems)>0
                        Width: =
                        ZIndex: =4

                        shpPurchaseOrderDetailsItemsRowDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        btnPurchaseOrderDetailsViewEdit As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            Color: =varThemeColors.primary
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.tertiaryGray
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =ClearCollect(
                                    colAppNavigationThreads,
                                    Table(
                                        {
                                            Screen: App.ActiveScreen,
                                            Order: CountRows(colAppNavigationThreads) + 1
                                        }
                                    )
                                );
                                Navigate(
                                    'Purchase Order Item Details Screen',
                                    ScreenTransition.Cover,
                                    {
                                        _item: ThisItem,
                                        _currencyCode: cmbPurchaseOrderDetailsCurrency.Selected.'Value Code',
                                        _reset:true
                                    }
                                )
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: |-
                                =With(
                                    {
                                        Text: If(
                                            Or(
                                                varIsNew,
                                                varIsEdit
                                            ),
                                            "Edit",
                                            "View"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =lblPurchaseOrderItemsTableHeaderDetails.Width-Self.FocusedBorderThickness-15
                            X: =lblPurchaseOrderDetailsItemsGoodReceipt.X+lblPurchaseOrderDetailsItemsGoodReceipt.Width
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =2

                        lblPurchaseOrderDetailsItemsGoodReceipt As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem._GoodsReceipt
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderGoodsReceipt.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsRequisition.X+lblPurchaseOrderDetailsItemsRequisition.Width
                            ZIndex: =3

                        btnPurchaseOrderDetailsItemsRequisition As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            Color: =varThemeColors.primary
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.tertiaryGray
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =Launch(
                                    varRequisitionAccess.'Application URL',
                                    {requisition: Self.Text}
                                )
                            PaddingLeft: =12
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseRequisitionNumber
                            Tooltip: =Self.Text
                            Visible: =!IsBlank(varRequisitionAccess) && !IsBlank(Self.Text)
                            Width: =conPurchaseOrderItemsTableHeaderRequisition.Width
                            X: =lblPurchaseOrderDetailsItemsRequisition.X
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =4

                        lblPurchaseOrderDetailsItemsRequisition As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseRequisitionNumber
                            Tooltip: =Self.Text
                            Visible: =!btnPurchaseOrderDetailsItemsRequisition.Visible
                            Width: =conPurchaseOrderItemsTableHeaderRequisition.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsTotal.X+lblPurchaseOrderDetailsItemsTotal.Width
                            ZIndex: =5

                        lblPurchaseOrderDetailsItemsTotal As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.TotalPrice,
                                    "[$-en-US]#,##0.00"
                                )
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderTotal.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsUnitPrice.X+lblPurchaseOrderDetailsItemsUnitPrice.Width
                            ZIndex: =6

                        lblPurchaseOrderDetailsItemsUnitPrice As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.UnitPrice,
                                    "[$-en-US]#,##0.00"
                                )
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderUnitPrice.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsUnit.X+lblPurchaseOrderDetailsItemsUnit.Width
                            ZIndex: =7

                        lblPurchaseOrderDetailsItemsUnit As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.UnitOfMeasure
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderUnit.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsQuantity.X+lblPurchaseOrderDetailsItemsQuantity.Width
                            ZIndex: =8

                        lblPurchaseOrderDetailsItemsQuantity As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.Quantity,
                                    "[$-en-US]#,##0.000"
                                )
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderQuantity.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsDescription.X+lblPurchaseOrderDetailsItemsDescription.Width
                            ZIndex: =9

                        lblPurchaseOrderDetailsItemsDescription As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Description
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderMaterialDescription.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsMaterial.X+lblPurchaseOrderDetailsItemsMaterial.Width
                            ZIndex: =10

                        lblPurchaseOrderDetailsItemsMaterial As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.MaterialNumber
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderMaterialNumber.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsLocation.X+lblPurchaseOrderDetailsItemsLocation.Width
                            ZIndex: =11

                        lblPurchaseOrderDetailsItemsLocation As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Location
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderLocation.Width
                            Wrap: =false
                            X: =lblPurchaseOrderDetailsItemsItem.X+lblPurchaseOrderDetailsItemsItem.Width
                            ZIndex: =12

                        lblPurchaseOrderDetailsItemsItem As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.ItemNumber
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderItemsTableHeaderItem.Width
                            Wrap: =false
                            X: =conPurchaseOrderItemsTableHeaderItem.X
                            ZIndex: =13

                        chbPurchaseOrderDetailsItemSelectRow As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =RGBA(0, 0, 0, 0)
                            Default: |-
                                =varResetSelectRows
                                //chbPurchaseOrderDetailsItemsSelectAll.Value
                            DisabledColor: =Self.Color
                            DisplayMode: =chbPurchaseOrderDetailsItemsSelectAll.DisplayMode
                            FocusedBorderColor: =varThemeColors.tertiaryGray
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            OnCheck: =
                            OnSelect: =//Select(Parent)
                            OnUncheck: =
                            PressedColor: =Self.Color
                            Reset: =true
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: If(
                                            Self.Value,
                                            "Unselect row",
                                            "Select row"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =chbPurchaseOrderDetailsItemsSelectAll.Width
                            X: =2
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =14

                    cmpNoPurchaseOrderItemsDisplay As NoItemsDisplay:
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galPurchaseOrderItems.Visible
                        Width: =
                        ZIndex: =6

                conPurchaseOrderDetailsFooter As groupContainer.horizontalAutoLayoutContainer:
                    FillPortions: =0
                    Height: =30
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =6

                    lblPurchaseOrderItemsNumberOfFoundRecords As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Lighter
                        Height: =30
                        LayoutMinWidth: =
                        Live: =Live.Polite
                        PaddingLeft: =0
                        Size: =10.5
                        Text: |-
                            =//Show how many rows are returned in the results
                            CountRows(galPurchaseOrderItems.AllItems) & " " &//Count the rows in the gallery
                            // Define a variable named "Text" with the value "{value}"
                             With(
                                {Text: "record(s)"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =galPurchaseOrderItems.Visible
                        Width: =
                        X: =1
                        ZIndex: =1

                    lblPurchaseOrderDetailsFooterMessage As label:
                        Align: =Align.Right
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =34
                        Italic: =true
                        LayoutMinWidth: =0
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: varFooterMessage},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(varIsProcessing, "...")
                        Visible: =!IsBlank(varFooterMessage)
                        Width: =
                        ZIndex: =2

    cmpPurchaseOrderDetailsLeftNavigation As LeftNavigation:
        Height: =App.Height-Self.Y
        Width: =cmpPurchaseOrderDetailsLeftNavigation.MenuWidth
        Y: =cmpPurchaseOrderDetailsHeader.Height
        ZIndex: =2

    cmpPurchaseOrderDetailsHeader As ScreenHeader:
        Width: =App.Width
        ZIndex: =3

    btnPurchaseOrderSearchLogicHidden As button:
        OnSelect: |-
            =If(
                !IsBlank(varSelectedPurchaseOrderID),
            //Sets processing indicator control behavior 
                Set(
                    varIsProcessing,
                    true
                );
                Set(
                    varFooterMessage,
                    "Loading"
                );
                
            //Remove any existing cached purchase order data whether variables or collections
            Set(
                    varPurchaseOrderHeader,
                    Blank()
                );
                Clear(colPurchaseOrderItems);
                
            //Reset any controls that interact with existing purchase order data
            Reset(chbPurchaseOrderDetailsItemsSelectAll);
                Reset(txtPurchaseOrderDetailsItemsFilter);
                
            //Call ReadPurchaseOrder Power Automate to read the purchase order from SAP
            ClearCollect(
                    colReadPurchaseOrderResponseTemp,//collection that temporarily stores the purchase order response data
                    ReadPurchaseOrder.Run(varSelectedPurchaseOrderID)
                );
                
            //Evalute response conditions
            Switch(
                    true,
                    And(//Check to see if read purchase order call was successful and process happy path logic
                        First(colReadPurchaseOrderResponseTemp).Status = "Success",
                        !IsBlank(First(colReadPurchaseOrderResponseTemp).OrderNumber)
                    ),
                    Reset(cmpPurchaseOrderDetailsMainCommandBar);
                    Set(
                        varPurchaseOrderNumber,//Variable that stores the returned main purchase order data
                        First(colReadPurchaseOrderResponseTemp).OrderNumber
                    );
                    Set(
                        varPurchaseOrderHeader,//Variable that stores the returned main purchase order data
                        First(colReadPurchaseOrderResponseTemp).Header
                    );
                    Set(//Set default sort column of items table
                        varPurchaseOrderItemsSortByColumn,
                        btnPurchaseOrderItemsTableHeaderItem.Text
                    );
                    Set(//Set default sort order of items table
                        varPurchaseOrderItemsSortOrder,
                        SortOrder.Ascending
                    );
                 /*Cache associated purchase order child records. Collections are used to pass updated data back in update purchase order transactions
                Default CrudType fields to 'R'. CrudType will be changed if user changes/removes child records and used by update purchase order flow*/
            UpdateIf(
                        ClearCollect(
                            colPurchaseOrderItems,//Collection that caches associated purchase order items
                            AddColumns(
                                First(colReadPurchaseOrderResponseTemp).Items,
                                "_Invoice",
                                LookUp(
                                    First(colReadPurchaseOrderResponseTemp).Invoices As tempCol1,
                                    ItemNumber = tempCol1.ItemNumber
                                ).Document,
                                "_GoodsReceipt",
                                LookUp(
                                    First(colReadPurchaseOrderResponseTemp).GoodsReceipts As tempCol1,
                                    ItemNumber = tempCol1.ItemNumber
                                ).Document,
                                "_Payment",
                                LookUp(
                                    First(colReadPurchaseOrderResponseTemp).Payments As tempCol1,
                                    ItemNumber = tempCol1.ItemNumber
                                ).Payment
                            )
                        ),
                        true,
                        {CrudType: "R"}
                    );
                //Create/update purchase order search history record
            Patch(
                        'SAP Search Histories',
                        Coalesce(
                            LookUp(
                                'SAP Search Histories',
                                And(
                                    'Object ID' = varPurchaseOrderNumber,
                                    'Object Type' = 'Object Type (SAP Search Histories)'.'Purchase Order',
                                    'Created By'.User = varSystemUserID
                                )
                            ),
                            Defaults('SAP Search Histories')
                        ),
                        {
                            'Object ID': varPurchaseOrderNumber,
                            'Object Type': 'Object Type (SAP Search Histories)'.'Purchase Order',
                            Name: Concatenate(
                                varPurchaseOrderNumber,
                                " - ",
                                varPurchaseOrderHeader.VendorName
                            ),
                            'Last Searched On': Now()
                        }
                    );
                //Check if the patch function was successful and notify if there was any errors.
            If(
                        !IsEmpty(Errors('SAP Search Histories')),
                        Notify(
                            First(Errors('SAP Search Histories')).Message,
                            NotificationType.Error,
                            0
                        ),
                        Refresh('SAP Search Histories')
                    );
                //End if ReadPurchaseOrder Power Automate call was success
            ,
                    And(//Check to see if call was successful, but no purchase order was found
                        First(colReadPurchaseOrderResponseTemp).Status = "Information",
                        IsBlank(First(colReadPurchaseOrderResponseTemp).OrderNumber)
                    ),
                    Notify(
                        With(
                        {Text: "Purchase order not found"},
                        If(
                    // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                    // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    ),
                        NotificationType.Information,
                        7000
                    ),//Default response for an unhandled error return
                    Notify(
                        With(
                            {Text: "Unexpected error occurred"},
                            If(
                    // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                    // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ),
                        NotificationType.Error,
                        0
                    )
                );
                
            //End purchase order response switch statement
            //Reset loading to false as the data query is complete
            Set(
                    varSelectedPurchaseOrderID,//done with selected purchase order ID variable, set back to blank
                    Blank()
                );
                Clear(colReadPurchaseOrderResponseTemp);
                
            //done with read purchase order temp collections, clear cache
            Set(
                    varIsProcessing,//done processing read purchase order, set variable back to false stopping any processing control behavior
                    false
                );
                Set(
                    varFooterMessage,
                    Blank()
                );
                
            )
        Text: ="Button"
        Visible: =false
        X: =1206
        Y: =96
        ZIndex: =4

