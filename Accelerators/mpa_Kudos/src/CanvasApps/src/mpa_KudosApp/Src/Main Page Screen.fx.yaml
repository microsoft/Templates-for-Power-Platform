"'Main Page Screen' As screen":
    Fill: =ColorValue(varThemeColors.background)
    OnVisible: |
        =Set(varLoggedUserName,Office365Users.UserProfile(User().Email).GivenName);

    conContent_MainPage As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height - conHeader_MainPage.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutGap: =20
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowY: =LayoutOverflow.Scroll
        PaddingLeft: |-
            =Switch(App.ActiveScreen.Size,
            5, (Parent.Width - 1450)/2,
            4, 75,
            3, 50,
            2, 25,
            1, 10
            )
        PaddingRight: =Self.PaddingLeft
        Width: =Parent.Width
        Y: =conHeader_MainPage.Height + conHeader_MainPage.Y
        ZIndex: =1

        conPrompt_MainPage As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            FillPortions: =0
            Height: =30 + lblPrompt_MainPage.Height + lblPromptTitle_MainPage.Height
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            ZIndex: =1

            lblPromptLinkText_MainPage As label:
                Align: =Align.Right
                AutoHeight: =true
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.primary)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H3.face
                FontWeight: =varThemeFont.H3.weight
                Height: =27
                HoverColor: =ColorValue(varThemeColors.tertiary)
                Italic: =varThemeFont.H3.italic
                OnSelect: =Navigate('View Kudos Screen');
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                PressedColor: =ColorValue(varThemeColors.text)
                Role: =TextRole.Heading3
                Size: =varThemeFont.H3.size
                Text: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "My Kudos"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Underline: =true
                VerticalAlign: =VerticalAlign.Top
                Width: =Len(Self.Text)*(Self.Size*.85)
                X: =lblPrompt_MainPage.X + lblPrompt_MainPage.Width
                Y: =lblPrompt_MainPage.Y
                ZIndex: =1

            lblPrompt_MainPage As label:
                AutoHeight: =true
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.tertiaryGray)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H3.face
                FontWeight: =varThemeFont.H3.weight
                Height: |-
                    =40
                    //For use with text that has to adjust height:
                    //Self.Size * 2* 1.2
                Italic: =varThemeFont.H3.italic
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Role: =TextRole.Heading3
                Size: =varThemeFont.H3.size
                Text: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "Hello"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    ) & ", " & varLoggedUserName & "!"
                VerticalAlign: =VerticalAlign.Top
                Width: =Parent.Width - 40 - lblPromptLinkText_MainPage.Width
                X: =20
                Y: =94
                ZIndex: =2

            lblPromptTitle_MainPage As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.text)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H1.face
                FontWeight: =varThemeFont.H1.weight
                Height: =Self.Size * 2.5    
                Italic: =varThemeFont.H1.italic
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =varThemeFont.H1.size
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Employee Kudos"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width - 40
                X: =20
                Y: =20
                ZIndex: =3

            btnPromptLink_MainPage As button:
                BorderColor: =RGBA(255, 255, 255, 0)
                Color: =RGBA(255, 255, 255, 0)
                DisabledBorderColor: =RGBA(255, 255, 255, 0)
                DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledFill: =RGBA(255, 255, 255, 0)
                Fill: =RGBA(255, 255, 255, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Height: =lblPromptLinkText_MainPage.Height+1
                HoverBorderColor: =RGBA(255, 255, 255, 0)
                HoverColor: =RGBA(255, 255, 255, 0)
                HoverFill: =RGBA(255, 255, 255, 0)
                OnSelect: |-
                    =Set(locGivenReceived, true);
                    Navigate('View Kudos Screen');
                PressedBorderColor: =RGBA(255, 255, 255, 0)
                PressedColor: =ColorValue(varThemeColors.primary)
                PressedFill: =RGBA(255, 255, 255, 0)
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Size: =24
                Text: =""
                Width: =lblPromptLinkText_MainPage.Width+5
                X: =lblPromptLinkText_MainPage.X
                Y: =lblPromptLinkText_MainPage.Y
                ZIndex: =4

        conPeopleSelect_MainPage As groupContainer.verticalAutoLayoutContainer:
            Fill: =ColorValue(varThemeColors.backgroundFill)
            FillPortions: =0
            Height: =400 + If(Or(cmbPeoplePicker_MainPage.Selected.UserPrincipalName in AddColumns('Opt-out Users', "Email", User.'Primary Email').Email,cmbPeoplePicker_MainPage.Selected.UserPrincipalName = User().Email), lblOptOutError_MainPage.Height + 20)
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =15
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            RadiusBottomLeft: =24
            RadiusBottomRight: =24
            RadiusTopLeft: =24
            RadiusTopRight: =24
            ZIndex: =3

            imgPeoplePicker_MainPage As image:
                AccessibleLabel: ="Logo"
                Height: =200
                Image: =BubbleStar
                LayoutMinHeight: =320
                LayoutMinWidth: =320
                PaddingTop: =10
                Width: =200
                ZIndex: =1

            lblPeopleSelectPromptTitle_MainPage As label:
                Align: =Align.Center
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.text)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H2.face
                FontWeight: =varThemeFont.H2.weight
                Height: =30
                Italic: =varThemeFont.H2.italic
                LayoutMinHeight: =70
                LayoutMinWidth: =560
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =varThemeFont.H2.size
                Text: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "Submit a New Kudos"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width - 80
                X: =39
                Y: =6
                ZIndex: =2

            cmbPeoplePicker_MainPage As combobox:
                AccessibleLabel: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "Select a person"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                BorderColor: |-
                    =/*Show Error color of Border if Selected User is in the Active Opt Out User list, or is the logged in User*/ 
                    If(Or(Self.Selected.UserPrincipalName in AddColumns(Filter('Opt-out Users', 'Opt-out Users (Views)'.'Active Opt-out Users'), "Email", User.'Primary Email').Email,cmbPeoplePicker_MainPage.Selected.UserPrincipalName = User().Email), ColorValue(varThemeColors.error),
                    ColorValue(varThemeColors.disabledText))
                BorderThickness: =If(Self.Selected.UserPrincipalName in AddColumns(Filter('Opt-out Users', 'Opt-out Users (Views)'.'Active Opt-out Users'), "Email", User.'Primary Email').Email, 4, 1)
                ChevronBackground: =ColorValue(varThemeColors.backgroundFill)
                ChevronDisabledBackground: =ColorValue(varThemeColors.backgroundFillDisabled)
                ChevronDisabledFill: |
                    =ColorValue(varThemeColors.text)
                ChevronFill: =ColorValue(varThemeColors.text)
                ChevronHoverBackground: =ColorValue(varThemeColors.secondaryGray)
                ChevronHoverFill: |
                    =ColorValue(varThemeColors.text)
                Color: =ColorValue(varThemeColors.text)
                DefaultSelectedItems: =
                DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                DisabledColor: =ColorValue(varThemeColors.text)
                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisplayFields: =["DisplayName", "UserPrincipalName"]
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FocusedBorderColor: |-
                    =//If(Self.Selected.UserPrincipalName in AddColumns('Opt-out Users', "Email", User.'Primary Email').Email, Self.BorderColor, ColorValue(varThemeColors.primary))
                    ColorValue(varThemeColors.info)
                Font: =varThemeFont.H3.face
                FontWeight: =varThemeFont.H3.weight
                HoverBorderColor: =Self.BorderColor
                HoverColor: =ColorValue(varThemeColors.text)
                HoverFill: =ColorValue(varThemeColors.secondaryGray)
                InputTextPlaceholder: |+
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "I'd like to recognize..."},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                    
                Italic: =varThemeFont.H3.italic
                Items: |-
                    =Office365Users.SearchUser({searchTerm: Self.SearchText,top:15})
                LayoutMinHeight: =70
                LayoutMinWidth: =575
                NoSelectionText: =
                OnChange: =
                PaddingLeft: =10
                PaddingRight: =10
                PressedBorderColor: =Self.BorderColor
                PressedColor: =ColorValue(varThemeColors.altText)
                PressedFill: =ColorValue(varThemeColors.backgroundFill)
                SearchFields: =["DisplayName"]
                SearchItems: |-
                    =Search(Office365Users.SearchUser({searchTerm: Self.SearchText,top:15}),cmbPeoplePicker_MainPage.SearchText,"DisplayName")
                SelectionColor: =ColorValue(varThemeColors.altText)
                SelectionFill: =ColorValue(varThemeColors.tertiary)
                SelectionTagColor: =ColorValue(varThemeColors.altText)
                SelectionTagFill: =ColorValue(varThemeColors.tertiary)
                SelectMultiple: =false
                Size: =varThemeFont.button.size
                Template: =ListItemTemplate.Double
                Width: |
                    =Parent.Width - 80
                X: =(Parent.Width/2) - (Self.Width/2)
                ZIndex: =3

            lblOptOutError_MainPage As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.error)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                DisplayMode: =DisplayMode.View
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.paragraph.face
                FontWeight: =FontWeight.Semibold
                Height: =28
                Italic: =varThemeFont.H3.italic
                LayoutMinHeight: =70
                LayoutMinWidth: =560
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Role: =TextRole.Heading3
                Size: |
                    =varThemeFont.paragraph.size
                Text: |+
                    =With(
                        {Text: If(cmbPeoplePicker_MainPage.Selected.UserPrincipalName in AddColumns(Filter('Opt-out Users', 'Opt-out Users (Views)'.'Active Opt-out Users'), "Email", User.'Primary Email').Email, "Note: This user has opted out of the kudos program.","You can’t submit a kudo for yourself.")},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                    
                Visible: |-
                    =Or(cmbPeoplePicker_MainPage.Selected.UserPrincipalName in AddColumns(Filter('Opt-out Users', 'Opt-out Users (Views)'.'Active Opt-out Users'), "Email", User.'Primary Email').Email,cmbPeoplePicker_MainPage.Selected.UserPrincipalName = User().Email)
                    /*Show error if Selected User is in the Active Opt Out User list, or is the logged in User*/
                Width: =cmbPeoplePicker_MainPage.Width
                X: =imgPFPGallery_MainPage.Width + imgPFPGallery_MainPage.X
                Y: =54
                ZIndex: =4

            btnNextPeopleSelect_MainPage As button:
                AutoDisableOnSelect: =false
                BorderColor: =ColorValue(varThemeColors.primary)
                BorderThickness: =1
                Color: =ColorValue(varThemeColors.altText)
                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledColor: =ColorValue(varThemeColors.disabledText)
                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisplayMode: |-
                    =If(Len(cmbPeoplePicker_MainPage.Selected.Id) = 0 || cmbPeoplePicker_MainPage.Selected.UserPrincipalName in AddColumns(Filter('Opt-out Users', 'Opt-out Users (Views)'.'Active Opt-out Users'), "Email", User.'Primary Email').Email || cmbPeoplePicker_MainPage.Selected.UserPrincipalName = User().Email, DisplayMode.Disabled, DisplayMode.Edit)
                    
                    /*Disable the button if Selected User is in the Active Opt Out User list, or is the logged in User*/ 
                Fill: =ColorValue(varThemeColors.primary)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Font: =varThemeFont.button.face
                FontWeight: =varThemeFont.button.weight
                HoverBorderColor: =ColorValue(varThemeColors.primary)
                HoverColor: =ColorValue(varThemeColors.altText)
                HoverFill: =ColorValue(varThemeColors.tertiary)
                Italic: =varThemeFont.button.italic
                LayoutMinHeight: =70
                LayoutMinWidth: =280
                OnSelect: |
                    =//Take the person selected and put them into the variable holding the kudos
                    Clear(colNewSubmission);
                    Collect(
                        colNewSubmission,
                        {
                            Recipient: cmbPeoplePicker_MainPage.Selected,
                            Message: "",
                            Title: "",
                            RecipientEmail: cmbPeoplePicker_MainPage.Selected.UserPrincipalName,
                            SelectedBadge: galBadgeGallery_BadgeSelection.Selected
                        }
                    );
                    
                    Navigate('Badge Selection Screen')
                PressedBorderColor: =ColorValue(varThemeColors.primary)
                PressedColor: =ColorValue(varThemeColors.altText)
                PressedFill: =ColorValue(varThemeColors.primary)
                RadiusBottomLeft: =4
                RadiusBottomRight: =4
                RadiusTopLeft: =4
                RadiusTopRight: =4
                Size: =varThemeFont.button.size
                Text: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "Next"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Width: =150
                X: |
                    =(Parent.Width/2) - (Self.Width/2)
                Y: =10
                ZIndex: =5

        conManagerView_MainPage As groupContainer.manualLayoutContainer:
            Height: =225
            LayoutMinHeight: =112
            LayoutMinWidth: =250
            Visible: |+
                =//The following code checks to see if the user has any direct reports to view, i.e. is a manager of someone else. 
                //Delegation Warning is okay given that the estimated amount of direct reports shouldn't be more than 2000
                CountRows(Filter(Kudos, Recipient.'Primary Email' in 
                Office365Users.DirectReports(User().Email).Mail)) > 0
                
            ZIndex: =4

            lblNoData_MainPage As label:
                Align: =Align.Center
                Color: =ColorValue(varThemeColors.tertiaryGray)
                Font: =varThemeFont.button.face
                FontWeight: =varThemeFont.button.weight
                Italic: =varThemeFont.button.italic
                Size: =varThemeFont.button.size
                Text: |+
                    =With(
                        {Text: "No Data to Display"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                    
                Width: =Parent.Width
                Y: =81
                ZIndex: =1

            "galMyKudos_MainPage As gallery.'BrowseLayout_Vertical_OneTextVariant_ver4.0'":
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Kudos Received by My Direct Reports"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                BorderColor: =RGBA(166, 166, 166, 1)
                Fill: |
                    =ColorValue(varThemeColors.background)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Height: =Parent.Height - lblManagerViewTitle_MainPage.Height - 10
                Items: |-
                    =//The following filters for the Kudos that the Direct Reports Recieved in the Past Year
                    //Delegation Warning is okay given that the estimated amount of Kudos recieved in a year for direct reports shouldn't be more than 2000
                    Filter(Kudos, Recipient.'Primary Email' in 
                    Office365Users.DirectReports(User().Email).Mail
                    , 'Created On' > DateAdd(Today(), -365, "Days"))
                Layout: =Layout.Vertical
                TemplateFill: =ColorValue(varThemeColors.backgroundFill)
                TemplatePadding: =10
                TemplateSize: |
                    =125
                Width: |+
                    =Parent.Width - 20
                    
                X: =10
                Y: |
                    =lblManagerViewTitle_MainPage.Height + 10
                ZIndex: =2

                shpSeparator_MainPage As rectangle:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    Fill: =ColorValue(varThemeColors.secondaryGray)
                    Height: =1
                    OnSelect: =Select(Parent)
                    Width: =Parent.TemplateWidth
                    Y: =Parent.TemplateHeight - 1
                    ZIndex: =1

                btnNext_MainPage As icon.ChevronRight:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Details"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Color: =ColorValue(varThemeColors.tertiaryGray)
                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                    Height: =36
                    Icon: =Icon.ChevronRight
                    OnSelect: =Select(Parent); Set(varSelectedKudos, ThisItem); Set(varDirectReport, true); Navigate('Details Screen')
                    Tooltip: ="Details"
                    Width: =31
                    X: =Parent.TemplateWidth-Self.Width-25
                    Y: =(Parent.TemplateHeight/2)-(Self.Height/2)
                    ZIndex: =2

                lblDateGallery_MainPage As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.primaryGray)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    Fill: |
                        =Color.Transparent
                    FocusedBorderColor: =ColorValue(varThemeColors.primary)
                    FocusedBorderThickness: =4
                    Font: =varThemeFont.paragraph.face
                    FontWeight: =varThemeFont.paragraph.weight
                    Height: =23
                    Italic: =varThemeFont.paragraph.italic
                    PaddingBottom: =0
                    PaddingLeft: =20
                    PaddingTop: =0
                    Role: =TextRole.Heading2
                    Size: =varThemeFont.paragraph.size
                    Text: =DateValue(ThisItem.'Created On')
                    Width: =Parent.Width/2
                    X: =imgBadge_MainPage.Width + imgBadge_MainPage.X
                    Y: =82
                    ZIndex: =3

                lblTitleGallery_MainPage As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.tertiaryGray)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.primary)
                    FocusedBorderThickness: =4
                    Font: =varThemeFont.paragraph.face
                    FontWeight: =FontWeight.Semibold
                    Height: =28
                    Italic: =varThemeFont.H3.italic
                    PaddingBottom: =0
                    PaddingLeft: =20
                    PaddingRight: =0
                    PaddingTop: =0
                    Role: =TextRole.Heading3
                    Size: |
                        =varThemeFont.paragraph.size
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        ThisItem.Title
                    Width: =Parent.Width/1.5
                    X: =imgBadge_MainPage.Width + imgBadge_MainPage.X
                    Y: =54
                    ZIndex: =4

                lblNameGallery_MainPage As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =ColorValue(varThemeColors.text)
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.primary)
                    FocusedBorderThickness: =4
                    Font: =varThemeFont.H1.face
                    FontWeight: =varThemeFont.H1.weight
                    Height: =31
                    Italic: =varThemeFont.H1.italic
                    PaddingBottom: =0
                    PaddingLeft: =20
                    PaddingTop: =0
                    Role: =TextRole.Heading1
                    Size: |
                        =varThemeFont.H1.size - 8
                    Text: =ThisItem.Recipient.'Full Name'
                    VerticalAlign: =VerticalAlign.Bottom
                    Width: =Parent.Width/2
                    X: =imgBadge_MainPage.Width + imgBadge_MainPage.X
                    Y: =20
                    ZIndex: =5

                imgPFPGallery_MainPage As image:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Recipient Photo"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Height: =85
                    Image: |-
                        =If(
                            !IsBlank(ThisItem.Recipient.'Primary Email') && Office365Users.UserPhotoMetadata(ThisItem.Recipient.'Primary Email').HasPhoto,
                            Office365Users.UserPhotoV2(ThisItem.Recipient.'Primary Email'),
                            DefaultPFP
                        )
                    ImagePosition: =ImagePosition.Fill
                    OnSelect: =Select(Parent)
                    RadiusBottomLeft: =100
                    RadiusBottomRight: =100
                    RadiusTopLeft: =100
                    RadiusTopRight: =100
                    Width: =85
                    X: =20
                    Y: =20
                    ZIndex: =6

                imgBadge_MainPage As image:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Badge"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    BorderColor: =Color.White
                    BorderThickness: =3
                    Height: =50
                    Image: =LookUp(colBadges, Badge=ThisItem.Badge.Badge).'Badge Image'
                    ImagePosition: =ImagePosition.Fill
                    RadiusBottomLeft: =100
                    RadiusBottomRight: =100
                    RadiusTopLeft: =100
                    RadiusTopRight: =100
                    Width: =Self.Height
                    X: =imgPFPGallery_MainPage.X+imgPFPGallery_MainPage.Width-25
                    Y: =68
                    ZIndex: =7

                btnKudosGivenView_ViewKudos_1 As button:
                    BorderColor: =RGBA(255, 255, 255, 0)
                    Color: =RGBA(255, 255, 255, 0)
                    DisabledBorderColor: =RGBA(255, 255, 255, 0)
                    DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                    DisabledFill: =RGBA(255, 255, 255, 0)
                    Fill: =RGBA(255, 255, 255, 0)
                    FocusedBorderColor: =ColorValue(varThemeColors.info)
                    Height: =Parent.TemplateHeight
                    HoverBorderColor: =RGBA(255, 255, 255, 0)
                    HoverColor: =RGBA(255, 255, 255, 0)
                    HoverFill: =RGBA(255, 255, 255, 0)
                    OnSelect: =Select(Parent); Set(varSelectedKudos, ThisItem); Set(varDirectReport, true); Navigate('Details Screen')
                    PressedBorderColor: =RGBA(255, 255, 255, 0)
                    PressedColor: =ColorValue(varThemeColors.primary)
                    PressedFill: =RGBA(255, 255, 255, 0)
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =24
                    Text: =""
                    Width: =Parent.TemplateWidth
                    Y: =1
                    ZIndex: =8

            lblManagerViewTitle_MainPage As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =ColorValue(varThemeColors.text)
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =ColorValue(varThemeColors.primary)
                FocusedBorderThickness: =4
                Font: =varThemeFont.H2.face
                FontWeight: =varThemeFont.H2.weight
                Height: =30
                Italic: =varThemeFont.H2.italic
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingRight: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =varThemeFont.H2.size
                Text: |-
                    =// Lookup the appropriately localized text
                    With(
                        {Text: "Kudos Received by My Direct Reports"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width - 80
                X: =20
                ZIndex: =3

    conHeader_MainPage As groupContainer.horizontalAutoLayoutContainer:
        Fill: =ColorValue(varThemeColors.primary)
        Height: =75
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutMode: =LayoutMode.Auto
        PaddingLeft: |-
            =Switch(App.ActiveScreen.Size,
            5, (Parent.Width - 1450)/2,
            4, 75,
            3, 50,
            2, 25,
            1, 10
            )
        PaddingRight: =Self.PaddingLeft
        Width: =Parent.Width
        ZIndex: =2

        conLeftHeaderContent_BadgeSelection_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =Parent.Height
            LayoutMinHeight: =Parent.Height
            LayoutMinWidth: =10
            Width: =100
            ZIndex: =1

            icoHeaderBack_BadgeSelection_5 As icon.BackArrow:
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Back"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                BorderColor: =ColorValue(varThemeColors.primary)
                Color: =ColorValue(varThemeColors.altText)
                DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledFill: =RGBA(0,0,0,0)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                FocusedBorderThickness: =4
                Height: =60
                HoverBorderColor: =ColorValue(varThemeColors.primary)
                HoverColor: =ColorValue(varThemeColors.altText)
                HoverFill: =RGBA(0,0,0,0)
                Icon: =Icon.BackArrow
                OnSelect: =Back()
                PaddingBottom: =6
                PaddingLeft: =6
                PaddingRight: =6
                PaddingTop: =6
                PressedBorderColor: =ColorValue(varThemeColors.primary)
                PressedColor: =ColorValue(varThemeColors.primary)
                PressedFill: =RGBA(0,0,0,0)
                Visible: =false
                Width: =60
                Y: =(Parent.Height/2)-(Self.Height/2)
                ZIndex: =1

        conCenterHeaderContent_BadgeSelection_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =Parent.Height
            LayoutMinHeight: =50
            LayoutMinWidth: =50
            ZIndex: =2

            imgMicrosoftLogo_BadgeSelection_5 As image:
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Company Logo"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                Height: =Parent.Height
                Image: =varThemeColors.iconimg
                OnSelect: =Navigate('Main Page Screen')
                Width: =Self.Height * 2
                X: =(Parent.Width/2)-(Self.Width/2)
                ZIndex: =1

        conRightHeaderContent_BadgeSelection_3 As groupContainer.manualLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =Parent.Height
            LayoutMinHeight: =Parent.Height
            LayoutMinWidth: =50
            Width: =250
            ZIndex: =3

            imgCurrentUser_BadgeSelection_5 As image:
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Logged In User Photo"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Height: =50
                Image: =If(!IsBlank(User().Email)&& Office365Users.UserPhotoMetadata(User().Email).HasPhoto, Office365Users.UserPhotoV2(User().Email), DefaultPFP)
                RadiusBottomLeft: =50
                RadiusBottomRight: =50
                RadiusTopLeft: =50
                RadiusTopRight: =50
                Width: =50
                X: =Parent.Width-Self.Width
                Y: =12
                ZIndex: =4

            "icoSettings_BadgeSelection_5 As icon.'3DPrinting'":
                AccessibleLabel: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Settings"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                BorderColor: =ColorValue(varThemeColors.primary)
                Color: =ColorValue(varThemeColors.altText)
                DisabledBorderColor: =ColorValue(varThemeColors.disabledText)
                DisabledColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledFill: =RGBA(0,0,0,0)
                Fill: =RGBA(0,0,0,0)
                FocusedBorderColor: =ColorValue(varThemeColors.info)
                FocusedBorderThickness: =4
                Height: =60
                HoverBorderColor: =ColorValue(varThemeColors.primary)
                HoverColor: =ColorValue(varThemeColors.altText)
                HoverFill: =RGBA(0,0,0,0)
                Icon: =Icon.Settings
                OnSelect: =Navigate('Settings Screen')
                PaddingBottom: =8
                PaddingLeft: =8
                PaddingRight: =8
                PaddingTop: =8
                PressedBorderColor: =ColorValue(varThemeColors.primary)
                PressedColor: =ColorValue(varThemeColors.primary)
                PressedFill: =RGBA(0,0,0,0)
                TabIndex: =0
                Tooltip: ="Settings"
                Width: =60
                X: =imgCurrentUser_BadgeSelection_5.X-Self.Width-10
                Y: =(Parent.Height/2)-(Self.Height/2)
                ZIndex: =5

