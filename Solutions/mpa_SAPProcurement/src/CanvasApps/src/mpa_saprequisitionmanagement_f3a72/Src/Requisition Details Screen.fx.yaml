"'Requisition Details Screen' As screen":
    Fill: =varThemeColors.background
    OnVisible: |
        =//Logic is only called the first time application loads. Allows for faster app launch time.
        If(
            Or(
                IsBlank(varLoadAppFirstTime),
                varLoadAppFirstTime
            ),
            //Variable drives whether the left navigation menu component is expanded or not across screens
            Set(
                varExpandMenu,
                App.ActiveScreen.Size >= ScreenSize.Large
            );
            Set(
                varISOUserLanguageCode,//Get user's language and map to existing choice values that are supported by the 'SAP Localizations' entity which can be customized to support more languages
                Switch(
                    Left(
                        Language(),
                        2
                    ),
                    "ar",
                    'ISO Language Code'.ar,
                    "de",
                    'ISO Language Code'.de,
                    "en",
                    'ISO Language Code'.en,
                    "es",
                    'ISO Language Code'.es,
                    "fr",
                    'ISO Language Code'.fr,
                    "he",
                    'ISO Language Code'.he,
                    "it",
                    'ISO Language Code'.it,
                    "ja",
                    'ISO Language Code'.ja,
                    "pt",
                    'ISO Language Code'.pt,
                    "zh",
                    'ISO Language Code'.zh,
                    'ISO Language Code'.en
                )
            );
            Concurrent(
                ClearCollect(
                    colUserLocalizedStrings,//Collection used to display localized value according to user's language value
                    Filter(
                        'SAP Localizations',
                        Language = varISOUserLanguageCode,
                        'SAP Localizations (Views)'.'Active SAP Localizations'
                    )
                ),
                Set(
                    varVendorAccess,//Variable used to allow drilling into vendor details app if user has access. Will be blank if user does not have access to the vendor menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.Vendors && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                Set(
                    varPurchaseOrderAccess,//Variable used to allow drilling into purchase order details app if user has access. Will be blank if user does not have access to the purchase order menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.'Purchase Orders' && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                //Get user's principal name from Office graph and store in variable
                Set(
                    varUserPrincipal,
                    Office365Users.MyProfileV2().userPrincipalName
                );
                //Lookup system user record in Dataverse for the user's principal name and store. Variable will be used when patching search histories
        Set(
                    varSystemUserID,
                    LookUp(
                        Users,
                        'User Name' = varUserPrincipal
                    ).User
                )
            );
            Set(
                varRequisitionItemsSortByColumn,//Default requisition items sort column variable
                btnRequisitionItemsTableHeaderItem.Text
            );
            Set(
                varRequisitionItemsSortOrder,//Default requisition items sort order variable
                SortOrder.Ascending
            );
            If(
                !IsBlank(Param("requisition")),//Allows for another app to launch this app with a specific requisition record in focus
                Set(
                    varSelectedRequisitionID,//Global variable used to invoke ReadRequisition power automate call to query specific vendor from SAP
                    Param("requisition")
                );
            );
            // Other apps such as vendors may want to launch the Requisition apps in default new record mode
            If(
                !IsBlank(Param("mode")) && Param("mode") = "new",
                Set(
                    varIsNew,
                    true
                );
                //check to see if a default vendor was supplied on the application launch such as from create new requisition from vendor app
                If( // If vendor is not blank, store it in varSelectedVendorID variable and execute logic to read the vendor details
                    !IsBlank(Param("vendor")),
                    Set(
                        varSelectedVendorID,
                        Param("vendor")
                    );
                    Select(icoRequisitionDetailsVendorSearch)
                );
                
            );
            Set(
                varLoadAppFirstTime,//All app first time loading logic is complete so set variable to false so not to execute again when navigating to screen
                false
            );
            
        );
        //End app first start logic
        //Reset controls, toggle reset select row variables as a work around to not being able to reset controls within galleries
        Set(
            varResetSelectRows,
            true
        );
        Set(
            varResetSelectRows,
            false
        );
        Reset(chbRequisitionsDetailsItemsSelectAll);
        Reset(txtRequisitionDetailsItemsFilter);
        Reset(galRequisitionItems);
        //Reset all search controls in the component
        UpdateContext({_resetCommandBar:false});
        UpdateContext({_resetCommandBar:true});
        //Collection that tracks cross screen navigation thread and allows to back out in reverse sequence, remove from "thread" if navigating back to this screen
        RemoveIf(
            colAppNavigationThreads,
            Screen = App.ActiveScreen
        );
        //Invoke logic contained in a hidden button control to query requisition if varSelectedRequisitionID not blank
        If(
            !IsBlank(varSelectedRequisitionID),
            Select(btnGetRequisitionSearchLogicHidden)
        );

    conRequisitionDetailsMain As groupContainer.verticalAutoLayoutContainer:
        Height: =App.Height-Self.Y
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        Width: =App.Width-Self.X
        X: =cmpRequisitionDetailsLeftNavigation.Width
        Y: =cmpRequisitionDetailsHeader.Height
        ZIndex: =1

        conRequisitionDetailsMainCommandBar As CommandBar:
            LayoutMinHeight: =
            LayoutMinWidth: =conRequisitionDetailsData.LayoutMinWidth
            ResetCommandBar: =_resetCommandBar
            Width: =

        conRequisitionDetailsScreenTabs As ScreenTabs:
            LayoutMinHeight: =
            LayoutMinWidth: =conRequisitionDetailsData.LayoutMinWidth
            Width: =

        shpRequisitionDetailsMainDivider As rectangle:
            AccessibleLabel: |-
                =// Define a variable named "Text" with the value "{value}"
                With(
                    {
                        Text: "Divider"
                    },
                    If(
                        // If the localized text is blank, return the default text
                        IsBlank(
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        ),
                        Text,
                        // If a localized text is found, return that instead of the default text
                        LookUp(
                            colUserLocalizedStrings,
                            'English Value' = Text
                        ).'Localized Value'
                    )
                )
            Fill: =varThemeColors.secondaryGray
            Height: =1
            LayoutMinHeight: =
            LayoutMinWidth: =conRequisitionDetailsData.LayoutMinWidth
            Width: =
            ZIndex: =2

        lblRequisitionDetailsMainName As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =varThemeColors.text
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =varThemeColors.primary
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =37
            LayoutMinHeight: =
            LayoutMinWidth: =conRequisitionDetailsData.LayoutMinWidth
            Live: =Live.Assertive
            PaddingBottom: =15
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =22
            Role: =TextRole.Heading1
            Size: =14.5
            Text: |-
                =// Define a variable named "Text" with the value "{value}"
                If(
                    !varIsNew && !IsBlank(varRequisition),
                    Concatenate(
                        varRequisition,
                        " - ",
                        varVendorHeader.VendorName
                    ),
                    With(
                        {
                            Text: If(
                                varIsNew,
                                "New requisition",
                                "Requisition"
                            )
                        },
                        If(
                        // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                        // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                )
            Width: =
            Wrap: =false
            ZIndex: =3

        conRequisitionDetailsData As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =20
            LayoutMinHeight: =
            LayoutMinWidth: =conRequisitionDetailsItems.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =20
            Width: =
            ZIndex: =5

            conRequisitionDetailsGeneralFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: |-
                    =If(
                        Self.Width <= 1650,
                        128 + Self.LayoutGap,
                        64
                    )
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =
                ZIndex: =2

                conRequisitionDetailsVendor As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            254,
                            Len(lblRequisitionDetailsVendor.Text) * 10
                        )
                    X: =40
                    ZIndex: =1

                    btnRequisitionsDetailsVendorSelect As button:
                        Align: =Align.Left
                        BorderColor: =RGBA(0,0,0,0)
                        BorderThickness: =0
                        Color: =varThemeColors.lookupBlue
                        DisabledBorderColor: =
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =
                        OnSelect: |-
                            =Launch(
                                varVendorAccess.'Application URL',
                                {vendor: Self.Text}
                            )
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedColor: =Self.Color
                        PressedFill: =Color.Transparent
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varVendorHeader.Vendor,
                                varNewVendorHeader.Vendor
                            )
                        Tooltip: =Self.Text
                        Visible: |-
                            =!Or(
                                varIsNew,
                                varIsEdit
                            ) && !IsBlank(varVendorHeader) && !IsBlank(varVendorAccess)
                        Width: =lblRequisitionDetailsVendor.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblRequisitionDetailsVendor.Y+lblRequisitionDetailsVendor.Height
                        ZIndex: =1

                    txtRequisitionDetailsVendor As text:
                        AccessibleLabel: |-
                            =//Check first if the vendor is confirmed/resolved
                            With(
                                {
                                    Text: If(
                                        Self.Italic,// Define a variable named "Text" with the value "{value}"
                                        "Vendor needs to be searched and resolved first",
                                        "Enter vendor number required"
                                    )
                                },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                Self.Color = varThemeColors.requiredRed,
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Color: |-
                            =Switch(
                                true,
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.text
                            )
                        Default: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varVendorHeader.Vendor,
                                varNewVendorHeader.Vendor
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                IsBlank(varVendorHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter vendor number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        Italic: |+
                            =Switch(true,
                                IsBlank(Self.Text),
                                false,
                                IsBlank(varNewVendorHeader.Vendor) && Self.Text = varVendorHeader.Vendor,
                                false,
                                !IsBlank(varNewVendorHeader.Vendor) && Self.Text = varNewVendorHeader.Vendor,
                                false,
                                true
                            )
                            
                        OnChange: |
                            =Set(
                                varSelectedVendorID,
                                Trim(Self.Text)
                            );
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =//Check first if the vendor is confirmed/resolved
                            If(
                                Self.Italic,// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Vendor needs to be searched and resolved first"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                ),//Otherwise populate resolved value entered or hint text
                                Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            )
                        Visible: =!btnRequisitionsDetailsVendorSelect.Visible
                        Width: =lblRequisitionDetailsVendor.Width-icoRequisitionDetailsVendorAdvancedSearch.Width-10-Self.X
                        X: =Self.FocusedBorderThickness
                        Y: =lblRequisitionDetailsVendor.Y+lblRequisitionDetailsVendor.Height
                        ZIndex: =2

                    "icoRequisitionDetailsVendorAdvancedSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.focusBorder
                        Height: =txtRequisitionDetailsVendor.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.FilterFlat
                        OnSelect: |-
                            =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                            Collect(
                                colAppNavigationThreads,
                                Table(
                                    {
                                        Screen: App.ActiveScreen,
                                        Order: CountRows(colAppNavigationThreads) + 1
                                    }
                                )
                            );
                            //sets global variable so the component knows which screen to navigate back to
                            Navigate(
                                'Requisition Vendor Search Screen',
                                ScreenTransition.Cover
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor advanced search"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: |-
                            =Or(
                                varIsNew,
                                varIsEdit
                            )
                        Width: =Self.Height
                        X: =btnRequisitionsDetailsVendorSelect.Width-Self.Width
                        Y: =txtRequisitionDetailsVendor.Y
                        ZIndex: =3

                    "icoRequisitionDetailsVendorSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primaryGray
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.focusBorder
                        Height: =txtRequisitionDetailsVendor.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.ArrowRight
                        OnSelect: |-
                            =If(
                                !IsBlank(varSelectedVendorID),
                            //Sets processing indicator control behavior 
                                Set(
                                    varIsProcessing,
                                    true
                                );
                                
                            //Call ReadVendor Power Automate to read the vendor from SAP
                            ClearCollect(
                                    colReadVendorResponseTemp,//collection that temporarily stores the vendor response data
                                    ReadVendor.Run(varSelectedVendorID)
                                );
                                
                            //Evalute response conditions
                            Switch(
                                    true,
                                    And(//Check to see if vendor call was successful and process happy path logic
                                        First(colReadVendorResponseTemp).Status = "Success",
                                        !IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                    ),
                                    Set(
                                        varNewVendorHeader,//Variable that stores the returned main vendor header data
                                        First(colReadVendorResponseTemp).Header
                                    );
                                    Patch(
                                        'SAP Search Histories',
                                        Coalesce(
                                            LookUp(
                                                'SAP Search Histories',
                                                And(
                                                    'Object Type' = 'Object Type (SAP Search Histories)'.Vendor,
                                                    'Object ID' = varNewVendorHeader.Vendor,
                                                    'Created By'.User = varSystemUserID
                                                )
                                            ),
                                            Defaults('SAP Search Histories')
                                        ),
                                        {
                                            'Object ID': varNewVendorHeader.Vendor,
                                            'Object Type': 'Object Type (SAP Search Histories)'.Vendor,
                                            Name: varNewVendorHeader.FullName,
                                            'Last Searched On': Now()
                                        }
                                    );
                                //Check if the patch function was successful and notify if there was any errors.
                            If(
                                        !IsEmpty(Errors('SAP Search Histories')),
                                        Notify(
                                            First(Errors('SAP Search Histories')).Message,
                                            NotificationType.Error,
                                            0
                                        )
                                    );
                                    ,//End if ReadVendor Power Automate call was success
                                    First(colReadVendorResponseTemp).Status = "Error",//Error response returned
                                    Notify(
                                        Concat(
                                            First(colReadVendorResponseTemp).Messages,
                                            Message,
                                            " "
                                        ),
                                        NotificationType.Error,
                                        0
                                    ),
                                    And(//Check to see if call was successful, but no vendor was found
                                        First(colReadVendorResponseTemp).Status = "Information",
                                        IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                    ),
                                    Notify(
                                        With(
                                            {Text: "Vendor not found"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Information,
                                        7000
                                    ),//Default response for an unhandled error return
                                    Notify(
                                        With(
                                            {Text: "Unexpected error occurred"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                
                            //End vendor response switch statement
                            //done with read vendor temp collections, clear cache
                            Clear(colReadVendorResponseTemp);
                                Reset(cmbRequisitionDetailsPurchasingOrg);
                                Reset(cmbRequisitionDetailsPurchasingGroup);
                                Set(
                                    varSelectedVendorID,
                                    Blank()
                                );
                                Set(
                                    varIsProcessing,//done processing read vendor, set variable back to false stopping any processing control behavior
                                    false
                                );
                                
                            )
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =With(
                                {Text: "Execute vendor search"},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =!IsBlank(txtRequisitionDetailsVendor.Text) && Or(varIsEdit,varIsNew)
                        Width: =Self.Height
                        X: =txtRequisitionDetailsVendor.X+txtRequisitionDetailsVendor.Width-Self.Width
                        Y: =txtRequisitionDetailsVendor.Y
                        ZIndex: =4

                    lblRequisitionDetailsVendor As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conRequisitionDetailsVendorName As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            312,
                            Len(txtRequisitionDetailsVendorName.HintText) * 10
                        )
                    X: =40
                    ZIndex: =2

                    txtRequisitionDetailsVendorName As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                And(
                                    IsBlank(varNewVendorHeader),
                                    !varIsNew
                                ),
                                varVendorHeader.VendorName,
                                varNewVendorHeader.VendorName
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.View,
                                IsBlank(varVendorHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblRequisitionDetailsVendorName.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblRequisitionDetailsVendorName.Y+lblRequisitionDetailsVendorName.Height
                        ZIndex: =2

                    lblRequisitionDetailsVendorName As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor name"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conRequisitionDetailsPurchasingOrg As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =275
                    X: =40
                    ZIndex: =3

                    cmbRequisitionDetailsPurchasingOrg As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing organization required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of requisition
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varVendorHeader.PurchasingOrganization
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varVendorHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Organization',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbRequisitionDetailsPurchasingOrg.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        Width: =lblRequisitionDetailsPurchasingOrg.Width
                        X: =lblRequisitionDetailsPurchasingOrg.X
                        Y: =lblRequisitionDetailsPurchasingOrg.Y+lblRequisitionDetailsPurchasingOrg.Height
                        ZIndex: =1

                    lblRequisitionDetailsPurchasingOrg As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conRequisitionDetailsPurchasingGroup As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =250
                    X: =40
                    ZIndex: =4

                    cmbRequisitionDetailsPurchasingGroup As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing group required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of requisition
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varVendorHeader.PurchasingGroup
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: =cmbRequisitionDetailsPurchasingOrg.DisplayMode
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Purchasing Group',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbRequisitionDetailsPurchasingGroup.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Select purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        Width: =lblRequisitionDetailsPurchasingGroup.Width
                        X: =lblRequisitionDetailsPurchasingGroup.X
                        Y: =lblRequisitionDetailsPurchasingGroup.Y+lblRequisitionDetailsPurchasingGroup.Height
                        ZIndex: =1

                    lblRequisitionDetailsPurchasingGroup As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )&" *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conRequisitionDetailsLocation As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            212,
                            Len(cmbRequisitionDetailsLocation.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =5

                    cmbRequisitionDetailsLocation As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//If there is only 1 location on the items for an existing purchase order, then default to that location
                            With(
                                {
                                    _defaultLocation: If(
                                        CountRows(
                                            Distinct(
                                                colRequisitionItems,
                                                Location
                                            )
                                        ) = 1,
                                        First(
                                            Distinct(
                                                colRequisitionItems,
                                                Location
                                            )
                                        ).Value
                                    )
                                },
                                If(
                                    And(
                                        !varIsNew,
                                        !IsBlank(_defaultLocation)
                                    ),
                                    Filter(
                                        'SAP List of Values',
                                        Status = 'Status (SAP List of Values)'.Active,
                                        Domain = 'Domain (SAP List of Values)'.Location,
                                        Language = varISOUserLanguageCode,
                                        'Value Code' = _defaultLocation
                                    )
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varRequisition)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |
                            =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbRequisitionDetailsLocation.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblRequisitionDetailsLocation.Width
                        X: =lblRequisitionDetailsLocation.X
                        Y: =lblRequisitionDetailsLocation.Y+lblRequisitionDetailsLocation.Height
                        ZIndex: =1

                    lblRequisitionDetailsLocation As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conRequisitionDetailsCurrency As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(cmbRequisitionDetailsCurrency.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =6

                    cmbRequisitionDetailsCurrency As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of requisition
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varVendorHeader.Currency
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: =cmbRequisitionDetailsPurchasingOrg.DisplayMode
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbRequisitionDetailsCurrency.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblRequisitionDetailsCurrency.Width
                        X: =lblRequisitionDetailsCurrency.X
                        Y: =lblRequisitionDetailsCurrency.Y+lblRequisitionDetailsCurrency.Height
                        ZIndex: =1

                    lblRequisitionDetailsCurrency As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conRequisitionDetailsTotal As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtRequisitionDetailsTotal.HintText) * 10
                        )
                    X: =40
                    ZIndex: =7

                    txtRequisitionDetailsTotal As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                Self.DisplayMode <> DisplayMode.Disabled,
                                Text(
                                    If(
                                        !IsEmpty(colRequisitionItems),
                                        Sum(
                                            Filter(
                                                colRequisitionItems,
                                                CrudType <> "D"
                                            ),
                                            _Total
                                        ),
                                        0
                                    ),
                                    "[$-en-US]#,##0.00"
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.View,
                                IsBlank(varRequisition),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblRequisitionDetailsTotal.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblRequisitionDetailsTotal.Y+lblRequisitionDetailsTotal.Height
                        ZIndex: =2

                    lblRequisitionDetailsTotal As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Total"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(//Add currency code value onto string if items are present
                                !IsBlank(cmbRequisitionDetailsCurrency.Selected.'Value Code'),
                                " (" & cmbRequisitionDetailsCurrency.Selected.'Value Code' & ")"
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

            conRequisitionDetailsItems As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =257
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conRequisitionItemsTable.LayoutMinHeight + shpRequisitionDetailItemsDivider.Height + conRequisitionDetailsItemsCommandBar.Height+lblRequisitionItemsNumberOfFoundRecords.Height
                LayoutMinWidth: =conRequisitionItemsTable.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =5

                conRequisitionDetailsItemsCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =39
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    conRequisitionDetailsItemsCommandBarLeft As groupContainer.horizontalAutoLayoutContainer:
                        LayoutMinHeight: =0
                        LayoutMinWidth: =0
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        lblRequisitionDetailsItems As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )&" *"
                            Width: =Len(Self.Text)*7
                            ZIndex: =1

                        conRequisitionDetailsItemsAddButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            Visible: =Or(varIsEdit,varIsNew)
                            Width: =Len(btnRequisitionDetailsItemsAddButton.Text)*10+btnRequisitionDetailsItemsAddButton.PaddingLeft+btnRequisitionDetailsItemsAddButton.PaddingRight
                            X: =lblRequisitionDetailsItems.Width+10
                            ZIndex: =2

                            icoRequisitionDetailsItemsAddButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Add"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionDetailsItemsAddButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Add
                                Width: =16
                                X: =5
                                Y: =btnRequisitionDetailsItemsAddButton.Y+btnRequisitionDetailsItemsAddButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionDetailsItemsAddButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =0
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                                    ClearCollect(
                                        colAppNavigationThreads,
                                        Table(
                                            {
                                                Screen: App.ActiveScreen,
                                                Order: CountRows(colAppNavigationThreads) + 1
                                            }
                                        )
                                    );
                                    //Navigate to the item details screen
                                    Navigate(
                                        'Requisition Item Details Screen',
                                        ScreenTransition.Cover,
                                        {
                                            _item: Blank(),
                                            _reset: true,
                                            _currencyCode: cmbRequisitionDetailsCurrency.Selected.'Value Code',
                                            _defaultLocation: cmbRequisitionDetailsLocation.Selected.'Value Code'
                                        }
                                    )
                                PaddingLeft: =icoRequisitionDetailsItemsAddButton.X + icoRequisitionDetailsItemsAddButton.Width + 8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Add"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionDetailsItemsCopyButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            Visible: |-
                                =//Make the button visible only if the following conditions are true
                                And(
                                    Or(//if a record is being created or updated
                                        varIsEdit,
                                        varIsNew
                                    ),
                                    !IsEmpty(//if one or more rows is selected
                                        Filter(
                                            galRequisitionItems.AllItems,
                                            chbRequisitionDetailsItemSelectRow.Value
                                        )
                                    )
                                )
                            Width: =Len(btnRequisitionDetailsItemsCopyButton.Text)*11+btnRequisitionDetailsItemsCopyButton.PaddingLeft
                            X: =conRequisitionDetailsItemsAddButton.X+conRequisitionDetailsItemsAddButton.Width+10
                            ZIndex: =3

                            icoRequisitionDetailsItemsCopyButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Delete"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionDetailsItemsCopyButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Copy
                                Width: =16
                                X: =5
                                Y: =btnRequisitionDetailsItemsCopyButton.Y+btnRequisitionDetailsItemsCopyButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionDetailsItemsCopyButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =0
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =ForAll(
                                        Filter(
                                            colRequisitionItems,
                                            ItemNumber in Filter(galRequisitionItems.AllItems,
                                            chbRequisitionDetailsItemSelectRow.Value = true).ItemNumber
                                        ),
                                        Collect(
                                            colRequisitionItems,
                                            {
                                                CrudType: "C",
                                                ItemNumber: Text(CountRows(colRequisitionItems) + 1),
                                                Location: Location,
                                                MaterialNumber:MaterialNumber,
                                                Description:Description,
                                                UnitOfMeasure:UnitOfMeasure,
                                                UnitPrice:UnitPrice,
                                                Quantity:Quantity,
                                                _Total:_Total
                                            }
                                        )
                                    );
                                    Reset(chbRequisitionsDetailsItemsSelectAll);
                                    //work around to reset gallery select row checkbox and selected row highlighted
                                    Set(
                                        varResetSelectRows,
                                        true
                                    );
                                    Set(
                                        varResetSelectRows,
                                        false
                                    );
                                PaddingLeft: =icoRequisitionDetailsItemsCopyButton.X+icoRequisitionDetailsItemsCopyButton.Width+8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Copy"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionDetailsItemsDeleteButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            Visible: |-
                                =//Make the button visible only if the following conditions are true
                                And(
                                    Or(//if a record is being created or updated
                                        varIsEdit,
                                        varIsNew
                                    ),
                                    !IsEmpty(//if one or more rows is selected
                                        Filter(
                                            galRequisitionItems.AllItems,
                                            chbRequisitionDetailsItemSelectRow.Value
                                        )
                                    )
                                )
                            Width: =Len(btnRequisitionDetailsItemsDeleteButton.Text)*10+btnRequisitionDetailsItemsDeleteButton.PaddingLeft
                            X: =conRequisitionDetailsItemsCopyButton.X+conRequisitionDetailsItemsCopyButton.Width+10
                            ZIndex: =4

                            icoRequisitionDetailsItemsDeleteButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Delete"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionDetailsItemsDeleteButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Cancel
                                Width: =16
                                X: =5
                                Y: =btnRequisitionDetailsItemsDeleteButton.Y+btnRequisitionDetailsItemsDeleteButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionDetailsItemsDeleteButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =0
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =RemoveIf(
                                        colRequisitionItems,
                                        And(
                                            ItemNumber in Filter(
                                                galRequisitionItems.AllItems,
                                                chbRequisitionDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType = "C"
                                        )
                                    );
                                    UpdateIf(
                                        colRequisitionItems,
                                        And(
                                            ItemNumber in Filter(
                                                galRequisitionItems.AllItems,
                                                chbRequisitionDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType <> "C"
                                        ),
                                        {CrudType: "D"}
                                    );
                                    Reset(chbRequisitionsDetailsItemsSelectAll);
                                    //work around to reset gallery select row checkbox and selected row highlighted
                                    Set(
                                        varResetSelectRows,
                                        true
                                    );
                                    Set(
                                        varResetSelectRows,
                                        false
                                    );
                                PaddingLeft: =icoRequisitionDetailsItemsDeleteButton.X+icoRequisitionDetailsItemsDeleteButton.Width+8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Delete"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    conRequisitionDetailsItemsFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Visible: =galRequisitionItems.Visible
                        Width: =txtRequisitionDetailsItemsFilter.X+txtRequisitionDetailsItemsFilter.Width+txtRequisitionDetailsItemsFilter.FocusedBorderThickness
                        ZIndex: =3

                        txtRequisitionDetailsItemsFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(
                                        IsEmpty(colRequisitionItems),
                                        varIsProcessing
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Filter items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpRequisitionDetailsItemsFilterDivider.X+shpRequisitionDetailsItemsFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpRequisitionDetailsItemsFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpRequisitionDetailItemsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Width: =
                    ZIndex: =3

                conRequisitionItemsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conRequisitionItemsTableHeader.Height + shpRequisitionDetailsItemsDivider.Height + If(
                            galRequisitionItems.Visible,
                            galRequisitionItems.LayoutMinHeight,
                            cmpNoRequisitionItemsDisplay.Height
                        ) + Self.PaddingTop + Self.PaddingBottom
                    LayoutMinWidth: =conRequisitionItemsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =5
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =
                    ZIndex: =4

                    conRequisitionItemsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =
                        LayoutMinWidth: =chbRequisitionsDetailsItemsSelectAll.Width + conRequisitionItemsTableHeaderItem.LayoutMinWidth + conRequisitionItemsTableHeaderLocation.LayoutMinWidth + conRequisitionItemsTableHeaderMaterialNumber.LayoutMinWidth + conRequisitionItemsTableHeaderQuantity.LayoutMinWidth + conRequisitionItemsTableHeaderUnit.LayoutMinWidth + conRequisitionItemsTableHeaderUnitPrice.LayoutMinWidth + conRequisitionItemsTableHeaderTotal.LayoutMinWidth + conRequisitionItemsTableHeaderPurchaseOrder.Width + 200
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =2
                        Width: =
                        ZIndex: =1

                        chbRequisitionsDetailsItemsSelectAll As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =varThemeColors.text
                            DisabledColor: =Self.Color
                            DisplayMode: |-
                                =If(
                                    And(
                                        CountRows(
                                            Filter(
                                                colRequisitionItems,
                                                CrudType <> "D"
                                            )
                                        ) > 0,
                                        Or(
                                            varIsNew,
                                            varIsEdit
                                        ),
                                        !varIsProcessing
                                    ),
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            FocusedBorderColor: =varThemeColors.focusBorder
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height-Self.FocusedBorderThickness*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            LayoutMinWidth: =75
                            OnCheck: =Set(varResetSelectRows,Self.Value)
                            OnUncheck: =Set(varResetSelectRows,Self.Value)
                            PressedColor: =Self.Color
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Select"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =Len(Self.Text) * 10 + Self.CheckboxSize
                            ZIndex: =1

                        conRequisitionItemsTableHeaderItem As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderItem.X+icoRequisitionItemsTableHeaderItem.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =2

                            icoRequisitionItemsTableHeaderItem As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderItem.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn=btnRequisitionItemsTableHeaderItem.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderItem.Text)*10+8
                                Y: =btnRequisitionItemsTableHeaderItem.Y+btnRequisitionItemsTableHeaderItem.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderItem As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Item"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderLocation As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderLocation.X+icoRequisitionItemsTableHeaderLocation.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =3

                            icoRequisitionItemsTableHeaderLocation As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderLocation.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn=btnRequisitionItemsTableHeaderLocation.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderLocation.Text)*8.5+8
                                Y: =btnRequisitionItemsTableHeaderLocation.Y+btnRequisitionItemsTableHeaderLocation.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderLocation As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Location"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderMaterialNumber As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderMaterialNumber.X+icoRequisitionItemsTableHeaderMaterialNumber.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =4

                            icoRequisitionItemsTableHeaderMaterialNumber As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderMaterialNumber.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderMaterialNumber.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderMaterialNumber.Text)*8+8
                                Y: =btnRequisitionItemsTableHeaderMaterialNumber.Y+btnRequisitionItemsTableHeaderMaterialNumber.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderMaterialNumber As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Material"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderDescription As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =3
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderMaterialDescription.X+icoRequisitionItemsTableHeaderMaterialDescription.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =5

                            icoRequisitionItemsTableHeaderMaterialDescription As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderMaterialDescription.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderMaterialDescription.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderMaterialDescription.Text)*7.5+8
                                Y: =btnRequisitionItemsTableHeaderMaterialDescription.Y+btnRequisitionItemsTableHeaderMaterialDescription.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderMaterialDescription As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Description"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderQuantity As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderQuantity.X+icoRequisitionItemsTableHeaderQuantity.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =6

                            icoRequisitionItemsTableHeaderQuantity As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderQuantity.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderQuantity.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderQuantity.Text)*8+8
                                Y: =btnRequisitionItemsTableHeaderQuantity.Y+btnRequisitionItemsTableHeaderQuantity.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderQuantity As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Quantity"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderUnit As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderUnit.X+icoRequisitionItemsTableHeaderUnit.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =7

                            icoRequisitionItemsTableHeaderUnit As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderUnit.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderUnit.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderUnit.Text)*9.5+8
                                Y: =btnRequisitionItemsTableHeaderUnit.Y+btnRequisitionItemsTableHeaderUnit.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderUnit As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderUnitPrice As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderUnitPrice.X+icoRequisitionItemsTableHeaderUnitPrice.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =8

                            icoRequisitionItemsTableHeaderUnitPrice As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderUnitPrice.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderUnitPrice.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderUnitPrice.Text)*7+8
                                Y: =btnRequisitionItemsTableHeaderUnitPrice.Y+btnRequisitionItemsTableHeaderUnitPrice.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderUnitPrice As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit price"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ) & If(//Add currency code value onto string if items are present
                                        !IsBlank(cmbRequisitionDetailsCurrency.Selected.'Value Code'),
                                        " (" & cmbRequisitionDetailsCurrency.Selected.'Value Code' & ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderTotal As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderTotal.X+icoRequisitionItemsTableHeaderTotal.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =9

                            icoRequisitionItemsTableHeaderTotal As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderTotal.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderTotal.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderTotal.Text)*7+8
                                Y: =btnRequisitionItemsTableHeaderTotal.Y+btnRequisitionItemsTableHeaderTotal.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderTotal As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Total"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )& If(//Add currency code value onto string if items are present
                                        !IsBlank(cmbRequisitionDetailsCurrency.Selected.'Value Code'),
                                        " (" & cmbRequisitionDetailsCurrency.Selected.'Value Code' & ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conRequisitionItemsTableHeaderPurchaseOrder As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoRequisitionItemsTableHeaderPurchaseOrder.X+icoRequisitionItemsTableHeaderPurchaseOrder.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =10

                            icoRequisitionItemsTableHeaderPurchaseOrder As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnRequisitionItemsTableHeaderPurchaseOrder.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRequisitionItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRequisitionItemsSortByColumn = btnRequisitionItemsTableHeaderPurchaseOrder.Text && galRequisitionItems.Visible
                                Width: =12
                                X: =Len(btnRequisitionItemsTableHeaderPurchaseOrder.Text)*7.5+8
                                Y: =btnRequisitionItemsTableHeaderPurchaseOrder.Y+btnRequisitionItemsTableHeaderPurchaseOrder.Height/2-Self.Height/2
                                ZIndex: =1

                            btnRequisitionItemsTableHeaderPurchaseOrder As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galRequisitionItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRequisitionItemsSortOrder = SortOrder.Ascending,varRequisitionItemsSortByColumn=Self.Text),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRequisitionItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRequisitionItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRequisitionItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =8
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchase order"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        lblRequisitionDetailsTableHeaderDetails As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisplayMode: |-
                                =If(
                                    And(galRequisitionItems.Visible,!varIsProcessing),
                                    DisplayMode.Edit,
                                    DisplayMode.View
                                )
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =43
                            LayoutMinWidth: =
                            PaddingBottom: =0
                            PaddingLeft: =2
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Details"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Len(Self.Text) * 16
                            Wrap: =false
                            X: =conRequisitionItemsTableHeaderItem.X
                            ZIndex: =11

                    shpRequisitionDetailsItemsDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinWidth: =
                        Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                        ZIndex: =2

                    galRequisitionItems As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: =Self.TemplateHeight*6
                        ItemAccessibleLabel: =ThisItem.Description
                        Items: |-
                            =With(
                                {
                                    itemsList: AddColumns(
                                        Filter(
                                            If(
                                                IsBlank(txtRequisitionDetailsItemsFilter.Text),
                                                colRequisitionItems,
                                                Search(
                                                    colRequisitionItems,
                                                    txtRequisitionDetailsItemsFilter.Text,
                                                    "Description",
                                                    "MaterialNumber",
                                                    "Location",
                                                    "ItemNumber",
                                                    "UnitOfMeasure",
                                                    "PurchaseOrderNumber"
                                                )
                                            ),
                                            CrudType <> "D"
                                        ),
                                        "_ItemSort",
                                        Value(ItemNumber)
                                    )
                                },
                                SortByColumns(
                                    itemsList,
                                    Switch(
                                        varRequisitionItemsSortByColumn,
                                        btnRequisitionItemsTableHeaderItem.Text,
                                        "_ItemSort",
                                        btnRequisitionItemsTableHeaderLocation.Text,
                                        "Location",
                                        btnRequisitionItemsTableHeaderMaterialNumber.Text,
                                        "MaterialNumber",
                                        btnRequisitionItemsTableHeaderMaterialDescription.Text,
                                        "Description",
                                        btnRequisitionItemsTableHeaderQuantity.Text,
                                        "Quantity",
                                        btnRequisitionItemsTableHeaderUnit.Text,
                                        "UnitOfMeasure",
                                        btnRequisitionItemsTableHeaderUnitPrice.Text,
                                        "UnitPrice",
                                        btnRequisitionItemsTableHeaderTotal.Text,
                                        "_Total",
                                        btnRequisitionItemsTableHeaderPurchaseOrder.Text,
                                        "PurchaseOrderNumber"
                                    ),
                                    varRequisitionItemsSortOrder
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: |-
                            =If(
                                chbRequisitionDetailsItemSelectRow.Value,
                                varThemeColors.templateRowSelectFill,
                                RGBA(
                                    255,
                                    255,
                                    255,
                                    1
                                )
                            )
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =CountRows(colRequisitionItems)>0
                        Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                        ZIndex: =4

                        shpRequisitionDetailsItemsRowDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        btnRequisitionDetailsViewEdit As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =ClearCollect(
                                    colAppNavigationThreads,
                                    Table(
                                        {
                                            Screen: App.ActiveScreen,
                                            Order: CountRows(colAppNavigationThreads) + 1
                                        }
                                    )
                                );
                                Navigate(
                                    'Requisition Item Details Screen',
                                    ScreenTransition.Cover,
                                    {
                                        _item: ThisItem,
                                        _currencyCode: cmbRequisitionDetailsCurrency.Selected.'Value Code',
                                        _reset: true
                                    }
                                )
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: |-
                                =With(
                                    {
                                        Text: If(
                                            Or(
                                                varIsNew,
                                                varIsEdit
                                            ),
                                            "Edit",
                                            "View"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =lblRequisitionDetailsTableHeaderDetails.Width-Self.FocusedBorderThickness-15
                            X: =lblRequisitionDetailsItemsPurchaseOrder.X+lblRequisitionDetailsItemsPurchaseOrder.Width
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =2

                        btnRequisitionDetailsItemsPurchaseOrder As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =Launch(
                                    varPurchaseOrderAccess.'Application URL',
                                    {purchaseorder: Self.Text}
                                )
                            PaddingLeft: =12
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            TabIndex: |-
                                =If(
                                    IsBlank(Self.Text),
                                    -1,
                                    0
                                )
                            Text: =ThisItem.PurchaseOrderNumber
                            Tooltip: =Self.Text
                            Visible: =!IsBlank(varPurchaseOrderAccess)
                            Width: =conRequisitionItemsTableHeaderPurchaseOrder.Width
                            X: =lblRequisitionDetailsItemsPurchaseOrder.X
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =3

                        lblRequisitionDetailsItemsPurchaseOrder As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseOrderNumber
                            Tooltip: =Self.Text
                            Visible: =!btnRequisitionDetailsItemsPurchaseOrder.Visible
                            Width: =conRequisitionItemsTableHeaderPurchaseOrder.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsTotal.X+lblRequisitionDetailsItemsTotal.Width
                            ZIndex: =4

                        lblRequisitionDetailsItemsTotal As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem._Total,
                                    "[$-en-US]#,##0.00"
                                )
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderTotal.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsUnitPrice.X+lblRequisitionDetailsItemsUnitPrice.Width
                            ZIndex: =5

                        lblRequisitionDetailsItemsUnitPrice As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.UnitPrice,
                                    "[$-en-US]#,##0.00"
                                )
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderUnitPrice.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsUnit.X+lblRequisitionDetailsItemsUnit.Width
                            ZIndex: =6

                        lblRequisitionDetailsItemsUnit As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.UnitOfMeasure
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderUnit.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsQuantity.X+lblRequisitionDetailsItemsQuantity.Width
                            ZIndex: =7

                        lblRequisitionDetailsItemsQuantity As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.Quantity,
                                    "[$-en-US]#,##0.000"
                                )
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderQuantity.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsDescription.X+lblRequisitionDetailsItemsDescription.Width
                            ZIndex: =8

                        lblRequisitionDetailsItemsDescription As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Description
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderDescription.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsMaterial.X+lblRequisitionDetailsItemsMaterial.Width
                            ZIndex: =9

                        lblRequisitionDetailsItemsMaterial As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.MaterialNumber
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderMaterialNumber.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsLocation.X+lblRequisitionDetailsItemsLocation.Width
                            ZIndex: =10

                        lblRequisitionDetailsItemsLocation As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Location
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderLocation.Width
                            Wrap: =false
                            X: =lblRequisitionDetailsItemsItem.X+lblRequisitionDetailsItemsItem.Width
                            ZIndex: =11

                        lblRequisitionDetailsItemsItem As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.ItemNumber
                            Tooltip: =Self.Text
                            Width: =conRequisitionItemsTableHeaderItem.Width
                            Wrap: =false
                            X: |-
                                =If(
                                    chbRequisitionDetailsItemSelectRow.Visible,
                                    chbRequisitionDetailsItemSelectRow.X * 2 + chbRequisitionDetailsItemSelectRow.Width,
                                    0
                                )
                            ZIndex: =12

                        chbRequisitionDetailsItemSelectRow As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =RGBA(0, 0, 0, 0)
                            Default: =varResetSelectRows
                            DisabledColor: =Self.Color
                            DisplayMode: =chbRequisitionsDetailsItemsSelectAll.DisplayMode
                            FocusedBorderColor: =varThemeColors.focusBorder
                            Font: =Font.'Segoe UI'
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            OnCheck: =
                            OnSelect: =
                            OnUncheck: =
                            PressedColor: =Self.Color
                            Size: =0
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: If(
                                            Self.Value,
                                            "Unselect row",
                                            "Select row"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =chbRequisitionsDetailsItemsSelectAll.Width-Self.X*2
                            X: =Self.FocusedBorderThickness
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =13

                    cmpNoRequisitionItemsDisplay As NoItemsDisplay:
                        Height: =215
                        LayoutMinHeight: =640
                        LayoutMinWidth: =
                        Visible: =!galRequisitionItems.Visible
                        ZIndex: =6

                conRequisitionDetailsFooter As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =30
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =0
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =6

                    lblRequisitionItemsNumberOfFoundRecords As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Lighter
                        Height: =30
                        Live: =Live.Polite
                        PaddingLeft: =0
                        Size: =10.5
                        Text: |-
                            =//Show how many rows are returned in the results
                            CountRows(galRequisitionItems.AllItems) & " " &//Count the rows in the gallery
                            // Define a variable named "Text" with the value "{value}"
                             With(
                                {Text: "record(s)"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =galRequisitionItems.Visible
                        Width: =Parent.Width-Parent.PaddingRight-Parent.PaddingLeft
                        X: =1
                        ZIndex: =1

                    lblRequisitionDetailsFooterMessage As label:
                        Align: =Align.Right
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =34
                        Italic: =true
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: varFooterMessage},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(varIsProcessing, "...")
                        Visible: =!IsBlank(varFooterMessage)
                        Width: =
                        ZIndex: =2

    btnGetRequisitionSearchLogicHidden As button:
        OnSelect: |
            =If(
                !IsBlank(varSelectedRequisitionID),
            //Sets processing indicator control behavior 
                Set(
                    varIsProcessing,
                    true
                );
                Set(
                    varFooterMessage,
                    "Loading"
                );
                
            //Remove any existing cached requisition data whether variables or collections
            Set(
                    varRequisition,
                    Blank()
                );
                
            //Reset any controls that interact with existing requisition data
            Reset(chbRequisitionsDetailsItemsSelectAll);
                Reset(txtRequisitionDetailsItemsFilter);
                
            //Call ReadRequisition Power Automate to read the requisition from SAP
            ClearCollect(
                    colReadRequisitionResponseTemp,//collection that temporarily stores the requisition response data
                    ReadRequisition.Run(
                        Substitute(
                            JSON(
                                {PurchaseRequisitionNumber: varSelectedRequisitionID},
                                JSONFormat.IndentFour
                            ),
                            "null",
                            """"""
                        )
                    )
                );
                
            //Evalute response conditions
            Switch(
                    true,
                    And(//Check to see if requisition call was successful and process happy path logic
                        First(colReadRequisitionResponseTemp).Status = "Success",
                        !IsBlank(First(colReadRequisitionResponseTemp).PurchaseRequisitionNumber)
                    ),
                    Reset(conRequisitionDetailsMainCommandBar);
                    Set(
                        varRequisition,//Variable that stores the returned main requisition data
                        First(colReadRequisitionResponseTemp).PurchaseRequisitionNumber
                    );
                    Set(
                        varVendorHeader,//Variable that stores the returned main vendor header data
                        First(colReadRequisitionResponseTemp).Header
                    );
                    Set(//Set default sort column of items table
                        varRequisitionItemsSortByColumn,
                        btnRequisitionItemsTableHeaderItem.Text
                    );
                    Set(//Set default sort order of items table
                        varRequisitionItemsSortOrder,
                        SortOrder.Ascending
                    );
                 /*Cache associated requisition child records. Collections are used to pass updated data back in update requistion transactions
                Default CrudType fields to 'R'. CrudType will be changed if user changes/removes child records and used by update requisition flow*/
            UpdateIf(
                        ClearCollect(
                            colRequisitionItems,//Collection that caches associated requisition items
                            AddColumns(
                                First(colReadRequisitionResponseTemp).Items,
                                "_Total",
                                Quantity * UnitPrice
                            )
                        ),
                        true,
                        {CrudType: "R"}
                    );
                    //Reset controls with refreshed data
            Reset(cmbRequisitionDetailsPurchasingOrg);
                    Reset(cmbRequisitionDetailsPurchasingGroup);
                    Reset(cmbRequisitionDetailsCurrency);
                //Create/update requisition search history record
            Patch(
                        'SAP Search Histories',
                        Coalesce(
                            LookUp(
                                'SAP Search Histories',
                                And(
                                    'Object ID' = varRequisition,
                                    'Object Type' = 'Object Type (SAP Search Histories)'.Requisition,
                                    'Created By'.User = varSystemUserID
                                )
                            ),
                            Defaults('SAP Search Histories')
                        ),
                        {
                            'Object ID': varRequisition,
                            'Object Type': 'Object Type (SAP Search Histories)'.Requisition,
                            Name: Concatenate(
                                varRequisition,
                                " - ",
                                varVendorHeader.VendorName
                            ),
                            'Last Searched On': Now()
                        }
                    );
                   //Check if the patch function was successful and notify if there was any errors.
            If(
                        !IsEmpty(Errors('SAP Search Histories')),
                        Notify(
                            First(Errors('SAP Search Histories')).Message,
                            NotificationType.Error,
                            0
                        ),
                        Refresh('SAP Search Histories');
                    );
                    //End if ReadRequisition Power Automate call was success
            ,
                    And(//Check to see if call was successful, but no requisition was found
                        First(colReadRequisitionResponseTemp).Status = "Information",
                        IsBlank(First(colReadRequisitionResponseTemp).PurchaseRequisitionNumber)
                    ),
                    Notify(
                        "Requisition not found",
                        NotificationType.Information,
                        7000
                    ),//Default response for an unhandled error return
                    Notify(
                        "Unexpected error occurred",
                        NotificationType.Error,
                        0
                    )
                );
                
            //End requisition response switch statement
            //Clear cache and stop loading indicator
            Set(
                    varSelectedRequisitionID,//done with selected requisition ID variable, set back to blank
                    Blank()
                );
                Clear(colReadRequisitionResponseTemp);
                
            //done with read requisition temp collections, clear cache
            Set(
                    varIsProcessing,//done processing read requisition, set variable back to false stopping any processing control behavior
                    false
                );
                Set(
                    varFooterMessage,
                    Blank()
                );
                
            );
        Text: ="Button"
        Visible: =false
        X: =1206
        Y: =96
        ZIndex: =2

    cmpRequisitionDetailsLeftNavigation As LeftNavigation:
        Height: =App.Height-Self.Y
        Width: =cmpRequisitionDetailsLeftNavigation.MenuWidth
        Y: =cmpRequisitionDetailsHeader.Height
        ZIndex: =3

    cmpRequisitionDetailsHeader As ScreenHeader:
        Width: =App.Width
        ZIndex: =4

