MaterialSearch As CanvasComponent:
    Fill: =varThemeColors.background
    Height: =App.Height
    OnReset: |
        =Set(
            varCurrentMaterialSearchTab,//Variable that drives which tab is selected control behavior, default to search all
            btnMaterialSearchAllTab.Text
        );
        Set(
            varRecentlySearchedSortOrder,//Variable that drives the sort order of recently searched gallery, default to descending
            SortOrder.Descending
        );
        Set(
            varRecentlySearchedSortByColumn,//Variable that drives the sort by column of recently searched gallery, default to last searched datetime field
            btnMaterialRecentlySearchedTableHeaderLastSearched.Text
        );
        Set(
            varMaterialSearchAllSortOrder,//Variable that drives the sort order of search all results gallery, default to ascending
            SortOrder.Ascending
        );
        Set(
            varMaterialSearchAllSortByColumn,//Variable that drives the sort by column of search all results gallery, default to vendor
            btnMaterialSearchResultsTableHeaderMaterial.Text
        );
        //Ensure any cached searched results and recent search history is blank
        Clear(colMaterialSearchResults);
    ResetSearch: =true
    Width: =1240
    X: =0
    Y: =0
    ZIndex: =3

    conMaterialSearchMain As groupContainer.verticalAutoLayoutContainer:
        Height: =MaterialSearch.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =MaterialSearch.Width
        ZIndex: =2

        conMaterialSearchHeader As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =48
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conMaterialSearchAll.Visible,
                    conMaterialSearchAll.LayoutMinWidth,
                    conMaterialRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =
            ZIndex: =1

            "conMaterialSearchBack As icon.'3DPrinting'":
                AccessibleLabel: =Self.Tooltip
                BorderColor: =varThemeColors.primary
                Color: =varThemeColors.primary
                DisabledBorderColor: =varThemeColors.disabledText
                DisabledColor: =varThemeColors.backgroundFillDisabled
                DisabledFill: =RGBA(0,0,0,0)
                DisplayMode: |-
                    =If(
                        varIsProcessing,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Fill: =RGBA(0,0,0,0)
                FocusedBorderColor: =varThemeColors.tertiaryGray
                Height: =30
                HoverBorderColor: =varThemeColors.primary
                HoverColor: =varThemeColors.tertiary
                HoverFill: =RGBA(0,0,0,0)
                Icon: =Icon.ArrowLeft
                OnSelect: |-
                    =Navigate(
                        Last(
                            Sort(
                                colAppNavigationThreads,
                                Order
                            )
                        ).Screen,
                        ScreenTransition.CoverRight
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedBorderColor: =varThemeColors.primary
                PressedColor: =varThemeColors.primary
                PressedFill: =RGBA(0,0,0,0)
                TabIndex: =0
                Tooltip: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Back"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =30
                Y: =Parent.Height/2-Self.Height/2
                ZIndex: =1

            lblMaterialSearchHeader As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Parent.Height
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =14.5
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Material search"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width-Self.X
                Wrap: =false
                ZIndex: =2

        conMaterialSearchTabs As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =43
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conMaterialSearchAll.Visible,
                    conMaterialSearchAll.LayoutMinWidth,
                    conMaterialRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =
            ZIndex: =2

            conMaterialSearchAllTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnMaterialSearchAllTab.Text)*8
                Y: =36
                ZIndex: =1

                shpMaterialSearchAllTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentMaterialSearchTab=btnMaterialSearchAllTab.Text
                    Width: =btnMaterialSearchAllTab.Width
                    X: =1
                    Y: =btnMaterialSearchAllTab.Y+btnMaterialSearchAllTab.Height
                    ZIndex: =1

                btnMaterialSearchAllTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: =If(varCurrentMaterialSearchTab=Self.Text,FontWeight.Semibold,FontWeight.Normal)
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: =Set(varCurrentMaterialSearchTab, Self.Text)
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search all"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

            conMaterialSearchRecentTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnMaterialSearchRecentTab.Text)*8
                Y: =36
                ZIndex: =2

                shpMaterialSearchRecentTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentMaterialSearchTab=btnMaterialSearchRecentTab.Text
                    Width: =btnMaterialSearchRecentTab.Width
                    X: =1
                    Y: =btnMaterialSearchRecentTab.Y+btnMaterialSearchRecentTab.Height
                    ZIndex: =1

                btnMaterialSearchRecentTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: =If(varCurrentMaterialSearchTab=Self.Text,FontWeight.Semibold,FontWeight.Normal)
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: |-
                        =Reset(txtMaterialRecentlySearchedCommandBarFilter);
                        Set(
                            varCurrentMaterialSearchTab,//Variable that drives which tab is selected control behavior
                            Self.Text
                        );
                        Refresh('SAP Search Histories')
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Recently searched"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

        conMaterialSearchAll As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Height: =700
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conMaterialSearchAllFooter.Height + conMaterialSearchAllResults.LayoutMinHeight + conMaterialSearchAllFields.Height + conMaterialSearchAllButtons.Height + Self.PaddingTop + Self.PaddingBottom + Self.LayoutGap * 2 + 10
            LayoutMinWidth: =conMaterialSearchAllResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: =LayoutOverflow.Scroll
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =25
            Visible: =shpMaterialSearchAllTab.Visible
            Width: =
            ZIndex: =3

            conMaterialSearchAllFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: |-
                    =If(
                        Self.Width <= 1050,
                        128 + Self.LayoutGap,
                        64
                    )
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =
                ZIndex: =1

                conMaterialSearchAllMaterial As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            244,
                            Len(txtMaterialSearchAllMaterial.HintText) * 10
                        )
                    X: =40
                    ZIndex: =1

                    txtMaterialSearchAllMaterial As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: =If(MaterialSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter material"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        MaxLength: =70
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblMaterialSearchAllMaterial.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblMaterialSearchAllMaterial.Y+lblMaterialSearchAllMaterial.Height
                        ZIndex: =2

                    lblMaterialSearchAllMaterial As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Material"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conMaterialSearchAllDescription As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            244,
                            Len(txtMaterialSearchAllDescription.HintText) * 10
                        )
                    X: =40
                    ZIndex: =2

                    txtMaterialSearchAllDescription As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: =If(MaterialSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter description"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        MaxLength: =70
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblMaterialSearchAllDescription.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblMaterialSearchAllDescription.Y+lblMaterialSearchAllDescription.Height
                        ZIndex: =2

                    lblMaterialSearchAllDescription As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Description"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conMaterialSearchAllType As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            264,
                        // Define a variable named "Text" with the value "{value}"
                            Len(
                               cmbMaterialSearchAllType.AccessibleLabel
                            ) * 9
                        )
                    X: =40
                    ZIndex: =3

                    cmbMaterialSearchAllType As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =If(
                                MaterialSearch.ResetSearch,
                                Defaults('SAP List of Values')
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Material Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        Reset: =true
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Material Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbMaterialSearchAllType.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblMaterialSearchAllType.Width
                        X: =lblMaterialSearchAllType.X
                        Y: =lblMaterialSearchAllType.Y+lblMaterialSearchAllType.Height
                        ZIndex: =1

                    lblMaterialSearchAllType As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conMaterialSearchAllLocation As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            264,
                        // Define a variable named "Text" with the value "{value}"
                            Len(
                               cmbMaterialSearchAllLocation.AccessibleLabel
                            ) * 9
                        )
                    X: =40
                    ZIndex: =4

                    cmbMaterialSearchAllLocation As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =If(
                                MaterialSearch.ResetSearch,
                                Defaults('SAP List of Values')
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =Self.AccessibleLabel
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =Self.AccessibleLabel
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =Self.BorderColor
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        Reset: =true
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Location,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbMaterialSearchAllLocation.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblMaterialSearchAllLocation.Width
                        X: =lblMaterialSearchAllLocation.X
                        Y: =lblMaterialSearchAllLocation.Y+lblMaterialSearchAllLocation.Height
                        ZIndex: =1

                    lblMaterialSearchAllLocation As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Location"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

            conMaterialSearchAllButtons As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: =42
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =20
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =2
                Width: =
                ZIndex: =2

                btnMaterialSearchAllCommandBarSearch As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.altText
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |
                        =//Start processing resetting any controls and cached data
                        Reset(txtMaterialSearchResultsFilter);
                        Clear(colMaterialSearchResults);
                        Set(
                            varMaterialSearchAllSortOrder,//Variable that drives the sort order of search all results gallery, default to ascending
                            SortOrder.Ascending
                        );
                        Set(
                            varMaterialSearchAllSortByColumn,//Variable that drives the sort by column of search all results gallery, default to vendor
                            btnMaterialSearchResultsTableHeaderMaterial.Text
                        );
                        Set(
                            varIsProcessing,
                            true
                        );
                        Set(
                            varFooterMessage,
                            "Searching"
                        );
                        //Invoke the ReadMaterialList flow and store results in collection
                        ClearCollect(
                            colMaterialSearchResultsResponse,
                            ReadMaterialList.Run(
                                Substitute(
                                    JSON(
                                        {
                                            Description: Trim(txtMaterialSearchAllDescription.Text),
                                            Material: Trim(txtMaterialSearchAllMaterial.Text),
                                            Type: cmbMaterialSearchAllType.Selected.'Value Code',
                                            Location: cmbMaterialSearchAllLocation.Selected.'Value Code'
                                        },
                                        JSONFormat.IndentFour
                                    ),
                                    "null",
                                    """"""
                                )
                            )
                        );
                        ClearCollect(
                            colMaterialSearchResults,
                            AddColumns(
                                First(colMaterialSearchResultsResponse).List As tempCol1,
                                "_UoM",
                                LookUp(
                                    First(colMaterialSearchResultsResponse).Material_UoM As tempCol2,
                                    tempCol2.MaterialNumber = tempCol1.MaterialNumber
                                ).Unit
                            )
                        );
                        //Evaluate return statuses to determine what type of notification
                        With(
                            {
                                Text: Switch(
                                    First(colMaterialSearchResultsResponse).Status,
                                    "Information",
                                    "No materials found based upon your search criteria",
                                    "Warning",
                                    "The maximum number of search results were found based upon your criteria and some records may be missing. Please try changing your search criteria.",
                                    "Error",
                                    Concat(
                                        First(colMaterialSearchResultsResponse).Messages,
                                        Message,
                                        " "
                                    ),
                                    "materials found based upon your search criteria"
                                ),
                                Status: First(colMaterialSearchResultsResponse).Status
                            },
                            Notify(
                                //Append record count to message if success
                                Concatenate(
                                    If(
                                        Status = "Success",
                                        CountRows(colMaterialSearchResults)
                                    ) & " ",
                                    If(
                                // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                ),
                                    //Set the notification type
                                Switch(
                                    Status,
                                    "Information",
                                    NotificationType.Information,
                                    "Warning",
                                    NotificationType.Warning,
                                    "Error",
                                    NotificationType.Error,
                                    NotificationType.Success
                                ),
                                If(
                                    Status = "Error",
                                    0,
                                    7000
                                )
                            )
                        );
                        Reset(galMaterialSearchResults);
                        Clear(colMaterialSearchResultsResponse);
                        //Search complete
                        Set(
                            varIsProcessing,
                            false
                        );
                        Set(
                            varFooterMessage,
                            Blank()
                        );
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =1
                    Y: =1
                    ZIndex: =1

                btnMaterialSearchAllCommandBarDone As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |-
                        =//Reset all the search text input fields to blank
                        Reset(txtMaterialSearchAllDescription);
                        Reset(txtMaterialSearchAllMaterial);
                        Reset(cmbMaterialSearchAllType);
                        Reset(cmbMaterialSearchAllLocation);
                        Reset(txtMaterialSearchResultsFilter);
                        //Ensure any cached searched results and recent search history is blank
                        Clear(colMaterialSearchResults);
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Clear"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =btnMaterialSearchAllCommandBarSearch.X+btnMaterialSearchAllCommandBarSearch.Width+20
                    Y: =1
                    ZIndex: =2

            conMaterialSearchAllResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                Fill: =RGBA(255, 255, 255, 1)
                Height: =257
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conMaterialSearchResultsTable.LayoutMinHeight + conMaterialSearchAllCommandBar.Height + shpMaterialSearchAllDivider.Height
                LayoutMinWidth: =conMaterialSearchResultsTable.LayoutMinWidth  + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =3

                conMaterialSearchAllCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblMaterialSearchAllCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Search results"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*9
                        ZIndex: =1

                    conMaterialSearchAllCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtMaterialSearchResultsFilter.X+txtMaterialSearchResultsFilter.Width+txtMaterialSearchResultsFilter.FocusedBorderThickness
                        ZIndex: =4

                        txtMaterialSearchResultsFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(IsEmpty(colMaterialSearchResults),varIsProcessing),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Filter materials"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            HoverBorderColor: =Self.BorderColor
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =Self.BorderColor
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpMaterialSearchAllCommandBarFilterDivider.X+shpMaterialSearchAllCommandBarFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpMaterialSearchAllCommandBarFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpMaterialSearchAllDivider As rectangle:
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Width: =
                    ZIndex: =2

                conMaterialSearchResultsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Height: =257
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conMaterialSearchResultsTableHeader.Height + shpMaterialSearchResultsTableHeaderDivider.Height + If(galMaterialSearchResults.Visible,
                            galMaterialSearchResults.LayoutMinHeight,
                            conMaterialSearchResultsTableNoResults.LayoutMinHeight
                        ) + Self.PaddingBottom + Self.PaddingTop
                    LayoutMinWidth: =conMaterialSearchResultsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =6
                    PaddingTop: =2
                    Width: =
                    ZIndex: =3

                    conMaterialSearchResultsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =conMaterialSearchResultsTableHeaderMaterial.LayoutMinWidth + conMaterialSearchResultsTableHeaderDescription.LayoutMinWidth + conMaterialSearchResultsTableHeaderUnit.LayoutMinWidth + conMaterialSearchResultsTableHeaderType.LayoutMinWidth + conMaterialSearchResultsTableHeaderLocation.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conMaterialSearchResultsTableHeaderMaterial As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialSearchResultsTableHeaderMaterial.X+icoMaterialSearchResultsTableHeaderMaterial.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =1

                            icoMaterialSearchResultsTableHeaderMaterial As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialSearchResultsTableHeaderMaterial.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varMaterialSearchAllSortByColumn=btnMaterialSearchResultsTableHeaderMaterial.Text && galMaterialSearchResults.Visible
                                Width: =12
                                X: =Len(btnMaterialSearchResultsTableHeaderMaterial.Text)*8.5+8
                                Y: =btnMaterialSearchResultsTableHeaderMaterial.Y+btnMaterialSearchResultsTableHeaderMaterial.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialSearchResultsTableHeaderMaterial As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galMaterialSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varMaterialSearchAllSortOrder = SortOrder.Ascending,varMaterialSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varMaterialSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galMaterialSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Material"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialSearchResultsTableHeaderDescription As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialSearchResultsTableHeaderDescription.X+icoMaterialSearchResultsTableHeaderDescription.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =2

                            icoMaterialSearchResultsTableHeaderDescription As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialSearchResultsTableHeaderDescription.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varMaterialSearchAllSortByColumn=btnMaterialSearchResultsTableHeaderDescription.Text && galMaterialSearchResults.Visible
                                Width: =12
                                X: =Len(btnMaterialSearchResultsTableHeaderDescription.Text)*8+8
                                Y: =btnMaterialSearchResultsTableHeaderDescription.Y+btnMaterialSearchResultsTableHeaderDescription.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialSearchResultsTableHeaderDescription As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galMaterialSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varMaterialSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                            varMaterialSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galMaterialSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Description"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialSearchResultsTableHeaderUnit As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialSearchResultsTableHeaderUnit.X+icoMaterialSearchResultsTableHeaderUnit.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =3

                            icoMaterialSearchResultsTableHeaderUnit As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialSearchResultsTableHeaderUnit.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varMaterialSearchAllSortByColumn=btnMaterialSearchResultsTableHeaderUnit.Text && galMaterialSearchResults.Visible
                                Width: =12
                                X: =Len(btnMaterialSearchResultsTableHeaderUnit.Text)*9+8
                                Y: =btnMaterialSearchResultsTableHeaderUnit.Y+btnMaterialSearchResultsTableHeaderUnit.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialSearchResultsTableHeaderUnit As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galMaterialSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varMaterialSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                            varMaterialSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galMaterialSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialSearchResultsTableHeaderType As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialSearchResultsTableHeaderType.X+icoMaterialSearchResultsTableHeaderType.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =4

                            icoMaterialSearchResultsTableHeaderType As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialSearchResultsTableHeaderType.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varMaterialSearchAllSortByColumn=btnMaterialSearchResultsTableHeaderType.Text && galMaterialSearchResults.Visible
                                Width: =12
                                X: =Len(btnMaterialSearchResultsTableHeaderType.Text)*11+8
                                Y: =btnMaterialSearchResultsTableHeaderType.Y+btnMaterialSearchResultsTableHeaderType.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialSearchResultsTableHeaderType As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galMaterialSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varMaterialSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                            varMaterialSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galMaterialSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =9
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Type"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialSearchResultsTableHeaderLocation As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialSearchResultsTableHeaderLocation.X+icoMaterialSearchResultsTableHeaderLocation.Width+10
                            Width: =
                            ZIndex: =5

                            icoMaterialSearchResultsTableHeaderLocation As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialSearchResultsTableHeaderLocation.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varMaterialSearchAllSortByColumn=btnMaterialSearchResultsTableHeaderLocation.Text && galMaterialSearchResults.Visible
                                Width: =12
                                X: =Len(btnMaterialSearchResultsTableHeaderLocation.Text)*8.5+8
                                Y: =btnMaterialSearchResultsTableHeaderLocation.Y+btnMaterialSearchResultsTableHeaderLocation.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialSearchResultsTableHeaderLocation As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galMaterialSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varMaterialSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varMaterialSearchAllSortOrder = SortOrder.Ascending,
                                            varMaterialSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varMaterialSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galMaterialSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =9
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Location"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpMaterialSearchResultsTableHeaderDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =
                        ZIndex: =2

                    galMaterialSearchResults As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: |-
                            =Min(
                                640,
                                CountRows(colMaterialSearchResults) * Self.TemplateHeight
                            )
                        ItemAccessibleLabel: =ThisItem.Description
                        Items: |-
                            =With(
                                {
                                    searchResults: If(
                                        IsBlank(txtMaterialSearchResultsFilter.Text),
                                        colMaterialSearchResults,
                                        Search(
                                            colMaterialSearchResults,
                                            txtMaterialSearchResultsFilter.Text,
                                            "Description",
                                            "MaterialNumber",
                                            "_UoM",
                                            "Type",
                                            "Location"
                                        )
                                    )
                                },
                                SortByColumns(
                                    searchResults,
                                    Switch(
                                        varMaterialSearchAllSortByColumn,
                                        btnMaterialSearchResultsTableHeaderMaterial.Text,
                                        "MaterialNumber",
                                        btnMaterialSearchResultsTableHeaderDescription.Text,
                                        "Description",
                                        btnMaterialSearchResultsTableHeaderUnit.Text,
                                        "_UoM",
                                        btnMaterialSearchResultsTableHeaderType.Text,
                                        "Type",
                                        btnMaterialSearchResultsTableHeaderLocation.Text,
                                        "Location"
                                    ),
                                    varMaterialSearchAllSortOrder
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight*6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =!IsEmpty(colMaterialSearchResults)
                        Width: =
                        ZIndex: =4

                        shpMaterialSearchResultsRowDivide As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblMaterialSearchResultsType_1 As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Location
                            Tooltip: =Self.Text
                            Width: =conMaterialSearchResultsTableHeaderLocation.Width
                            Wrap: =false
                            X: =lblMaterialSearchResultsType.X+lblMaterialSearchResultsType.Width
                            ZIndex: =2

                        lblMaterialSearchResultsType As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Type
                            Tooltip: =Self.Text
                            Width: =conMaterialSearchResultsTableHeaderType.Width
                            Wrap: =false
                            X: =lblMaterialSearchResultsUnit.X + lblMaterialSearchResultsUnit.Width
                            ZIndex: =3

                        lblMaterialSearchResultsUnit As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem._UoM
                            Tooltip: =Self.Text
                            Width: =conMaterialSearchResultsTableHeaderUnit.Width
                            Wrap: =false
                            X: =lblMaterialSearchResultsDescription.X+lblMaterialSearchResultsDescription.Width
                            ZIndex: =4

                        lblMaterialSearchResultsDescription As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Description
                            Tooltip: =Self.Text
                            Width: =conMaterialSearchResultsTableHeaderDescription.Width
                            Wrap: =false
                            X: =btnMaterialSearchResultsMaterialSelect.X*2+btnMaterialSearchResultsMaterialSelect.Width
                            ZIndex: =5

                        btnMaterialSearchResultsMaterialSelect As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =
                            OnSelect: |-
                                =//Set the selected material variable
                                Set(
                                    varSelectedMaterialHeader,
                                    ThisItem
                                );
                                //Navigate back to previous screen
                                Select(conMaterialSearchBack);
                                //Create or update materials search history record
                                Patch(
                                    'SAP Search Histories',
                                    Coalesce(
                                        LookUp(
                                            'SAP Search Histories',
                                            And(
                                                'Object ID' = varSelectedMaterialHeader.MaterialNumber,
                                                'Object Type' = 'Object Type (SAP Search Histories)'.Material,
                                                'Attribute 1' = varSelectedMaterialHeader._UoM,
                                                'Created By'.User = varSystemUserID
                                            )
                                        ),
                                        Defaults('SAP Search Histories')
                                    ),
                                    {
                                        'Object ID': varSelectedMaterialHeader.MaterialNumber,
                                        'Object Type': 'Object Type (SAP Search Histories)'.Material,
                                        Name: varSelectedMaterialHeader.Description,
                                        'Attribute 1': varSelectedMaterialHeader._UoM,
                                        'Last Searched On': Now()
                                    }
                                );
                                //Assess patch for errors and notify appropriately
                                If(
                                    !IsEmpty(Errors('SAP Search Histories')),
                                    Notify(
                                        First(Errors('SAP Search Histories')).Message,
                                        NotificationType.Error,
                                        0
                                    ),
                                    Refresh('SAP Search Histories')
                                );
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.MaterialNumber
                            Tooltip: =Self.Text
                            Width: =conMaterialSearchResultsTableHeaderMaterial.Width - Self.X*2
                            X: =Self.FocusedBorderThickness
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =6

                    conMaterialSearchResultsTableNoResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galMaterialSearchResults.Visible
                        Width: =
                        ZIndex: =5

                        icoMaterialSearchResultsTableNoResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No results"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            Visible: =!varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblMaterialSearchResultsTableNoResults.Y-lblMaterialSearchResultsTableNoResults.Height-30
                            ZIndex: =1

                        lblMaterialSearchResultsTableNoResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Visible: =!varIsProcessing
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

                        imgLoadingSubGrid_1 As image:
                            Height: =46
                            Image: ='loading-grey'
                            Visible: =varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblMaterialSearchResultsTableNoResults.Y-lblMaterialSearchResultsTableNoResults.Height-33
                            ZIndex: =3

            conMaterialSearchAllFooter As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =30
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =6

                lblMaterialSearchAllNumberRecordsFound As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Lighter
                    Height: =30
                    Live: =Live.Polite
                    PaddingLeft: =btnMaterialSearchResultsTableHeaderMaterial.PaddingLeft
                    Size: =10.5
                    Text: |-
                        =//Show how many rows are returned in the results
                        CountRows(galMaterialSearchResults.AllItems) & " " &//Count the rows in the gallery
                        // Define a variable named "Text" with the value "{value}"
                         With(
                            {Text: "record(s)"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Visible: =galMaterialSearchResults.Visible
                    Width: =
                    X: =1
                    ZIndex: =1

                lblMaterialSearchAllFooterMessage As label:
                    Align: =Align.Right
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =34
                    Italic: =true
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =32
                    PaddingRight: =32
                    PaddingTop: =0
                    Role: =TextRole.Heading2
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: varFooterMessage},
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ) & If(varIsProcessing, "...")
                    Visible: =!IsBlank(varFooterMessage)
                    Width: =
                    ZIndex: =2

        conMaterialRecentlySearched As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =600
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conMaterialRecentlySearchedResults.LayoutMinHeight + lblNumberOfRecentlySearchedMaterialRecords.Height + Self.PaddingBottom + Self.PaddingTop + 10
            LayoutMinWidth: =conMaterialRecentlySearchedResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight + 125
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowX: =LayoutOverflow.Scroll
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =24
            Visible: =shpMaterialSearchRecentTab.Visible
            Width: =
            X: =40
            Y: =40
            ZIndex: =4

            conMaterialRecentlySearchedResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Fill: =RGBA(255, 255, 255, 1)
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conMaterialRecentlySearchTable.LayoutMinHeight + shpMaterialRecentlySearchedDivider_1.Height + conMaterialRecentlySearchedCommandBar.Height
                LayoutMinWidth: =conMaterialRecentlySearchTable.LayoutMinWidth + Parent.PaddingLeft + Parent.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =6

                conMaterialRecentlySearchedCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblMaterialRecentlySearchedCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Recent records"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*9
                        ZIndex: =1

                    conMaterialRecentlySearchedCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtMaterialRecentlySearchedCommandBarFilter.X+txtMaterialRecentlySearchedCommandBarFilter.Width+txtMaterialRecentlySearchedCommandBarFilter.FocusedBorderThickness
                        ZIndex: =2

                        txtMaterialRecentlySearchedCommandBarFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    galRecentlySearchedMaterials.Visible,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =If(
                                    Self.DisplayMode <> DisplayMode.Disabled,
                                // Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Filter materials"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                        // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                        // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                )
                            HoverBorderColor: =Self.BorderColor
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =Self.BorderColor
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpMaterialRecentlySearchedCommandBarFilterDivider.X+shpMaterialRecentlySearchedCommandBarFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpMaterialRecentlySearchedCommandBarFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpMaterialRecentlySearchedDivider_1 As rectangle:
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Width: =
                    ZIndex: =2

                conMaterialRecentlySearchTable As groupContainer.horizontalAutoLayoutContainer:
                    Height: =300
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conMaterialRecentlySearchedTableHeader.Height + shpMaterialRecentlySearchedResultsDivider.Height + If(galRecentlySearchedMaterials.Visible,
                            galRecentlySearchedMaterials.LayoutMinHeight,
                            conMaterialNoRecentlySearchedResults.LayoutMinHeight
                        ) + Self.PaddingTop + Self.PaddingBottom
                    LayoutMinWidth: =conMaterialRecentlySearchedTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    PaddingTop: =2
                    Width: =
                    ZIndex: =4

                    conMaterialRecentlySearchedTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =conMaterialRecentlySearchedTableHeaderMaterial.LayoutMinWidth + conMaterialRecentlySearchedTableHeaderDescription.LayoutMinWidth + conMaterialRecentlySearchedTableHeaderUnit.LayoutMinWidth + conMaterialRecentlySearchedTableHeaderLastSearched.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conMaterialRecentlySearchedTableHeaderMaterial As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialRecentlySearchedTableHeaderMaterial.X+icoMaterialRecentlySearchedTableHeaderMaterial.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =1

                            icoMaterialRecentlySearchedTableHeaderMaterial As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialRecentlySearchedTableHeaderMaterial.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnMaterialRecentlySearchedTableHeaderMaterial.Text && galRecentlySearchedMaterials.Visible
                                Width: =12
                                X: =Len(btnMaterialRecentlySearchedTableHeaderMaterial.Text)*8.5+8
                                Y: =btnMaterialRecentlySearchedTableHeaderMaterial.Y+btnMaterialRecentlySearchedTableHeaderMaterial.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialRecentlySearchedTableHeaderMaterial As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedMaterials.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRecentlySearchedSortOrder = SortOrder.Ascending,varRecentlySearchedSortByColumn=Self.Text),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRecentlySearchedMaterials)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Material"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialRecentlySearchedTableHeaderDescription As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialRecentlySearchedTableHeaderDescription.X+icoMaterialRecentlySearchedTableHeaderDescription.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =2

                            icoMaterialRecentlySearchedTableHeaderDescription As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialRecentlySearchedTableHeaderDescription.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnMaterialRecentlySearchedTableHeaderDescription.Text && galRecentlySearchedMaterials.Visible
                                Width: =12
                                X: =Len(btnMaterialRecentlySearchedTableHeaderDescription.Text)*8+10
                                Y: =btnMaterialRecentlySearchedTableHeaderDescription.Y+btnMaterialRecentlySearchedTableHeaderDescription.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialRecentlySearchedTableHeaderDescription As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedMaterials.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRecentlySearchedSortOrder = SortOrder.Ascending,varRecentlySearchedSortByColumn=Self.Text),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRecentlySearchedMaterials)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Description"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialRecentlySearchedTableHeaderUnit As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialRecentlySearchedTableHeaderUnit.X+icoMaterialRecentlySearchedTableHeaderUnit.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =3

                            icoMaterialRecentlySearchedTableHeaderUnit As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialRecentlySearchedTableHeaderUnit.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnMaterialRecentlySearchedTableHeaderUnit.Text && galRecentlySearchedMaterials.Visible
                                Width: =12
                                X: =Len(btnMaterialRecentlySearchedTableHeaderUnit.Text)*9.5+8
                                Y: =btnMaterialRecentlySearchedTableHeaderUnit.Y+btnMaterialRecentlySearchedTableHeaderUnit.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialRecentlySearchedTableHeaderUnit As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedMaterials.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRecentlySearchedSortOrder = SortOrder.Ascending,varRecentlySearchedSortByColumn=Self.Text),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRecentlySearchedMaterials)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conMaterialRecentlySearchedTableHeaderLastSearched As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoMaterialRecentlySearchedTableHeaderLastSearched.X+icoMaterialRecentlySearchedTableHeaderLastSearched.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =4

                            icoMaterialRecentlySearchedTableHeaderLastSearched As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnMaterialRecentlySearchedTableHeaderLastSearched.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnMaterialRecentlySearchedTableHeaderLastSearched.Text && galRecentlySearchedMaterials.Visible
                                Width: =12
                                X: =Len(btnMaterialRecentlySearchedTableHeaderLastSearched.Text)*7.5+8
                                Y: =btnMaterialRecentlySearchedTableHeaderLastSearched.Y+btnMaterialRecentlySearchedTableHeaderLastSearched.Height/2-Self.Height/2
                                ZIndex: =1

                            btnMaterialRecentlySearchedTableHeaderLastSearched As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedMaterials.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varRecentlySearchedSortOrder = SortOrder.Ascending,
                                            varRecentlySearchedSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galRecentlySearchedMaterials)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Last searched"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpMaterialRecentlySearchedResultsDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =
                        ZIndex: =2

                    galRecentlySearchedMaterials As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Materials recently searched"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: |-
                            =Min(
                                640,
                                CountRows(galRecentlySearchedMaterials.AllItems) * Self.TemplateHeight
                            )
                        Items: |-
                            =//Display recent search result items sorting according to table header buttons selected and searched on further based upon filter text input
                            With(
                                {
                                    recentItems: If(
                                        IsBlank(txtMaterialRecentlySearchedCommandBarFilter.Text),//Filter text not entered
                                        Filter(
                                        'SAP Search Histories',
                                        'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                        'Object Type' = 'Object Type (SAP Search Histories)'.Material//Filter on object type material
                                    ),
                                        Search(//Search on text entered in filtered field
                                            Filter(
                                        'SAP Search Histories',
                                        'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                        'Object Type' = 'Object Type (SAP Search Histories)'.Material//Filter on object type material
                                    ),
                                            txtMaterialRecentlySearchedCommandBarFilter.Text,
                                            "mpa_name",
                                            "mpa_objectid",
                                            "mpa_attribute1"
                                        )
                                    )
                                },
                                SortByColumns(
                                    recentItems,
                                    Switch(
                                        varRecentlySearchedSortByColumn,//determine which field to sort by based upon the tabel header column value selected and stored in variable
                                        btnMaterialRecentlySearchedTableHeaderMaterial.Text,
                                        "mpa_objectid",
                                        btnMaterialRecentlySearchedTableHeaderDescription.Text,
                                        "mpa_name",
                                        btnMaterialRecentlySearchedTableHeaderUnit.Text,
                                        "mpa_attribute1",
                                        btnMaterialRecentlySearchedTableHeaderLastSearched.Text,
                                        "mpa_lastsearchedon"
                                    ),
                                    varRecentlySearchedSortOrder//sort ascending or descending based upon value stored in variable
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight*6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: |-
                            =!IsEmpty(
                                Filter(
                                    'SAP Search Histories',
                                    'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                    'Object Type' = 'Object Type (SAP Search Histories)'.Material//Filter on object type material
                                )
                            )
                        Width: =
                        ZIndex: =3

                        shpMaterialRecentlySearchedDivider As rectangle:
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblMaterialRecentlySearchedLastSearched As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.'Last Searched On',
                                    DateTimeFormat.ShortDateTime
                                )
                            Tooltip: =Self.Text
                            Width: =btnMaterialRecentlySearchedTableHeaderLastSearched.Width
                            Wrap: =false
                            X: =lblMaterialRecentlySearchedUnit.X+lblMaterialRecentlySearchedUnit.Width
                            ZIndex: =2

                        lblMaterialRecentlySearchedUnit As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.'Attribute 1'
                            Tooltip: =Self.Text
                            Width: =conMaterialRecentlySearchedTableHeaderUnit.Width
                            Wrap: =false
                            X: =lblMaterialRecentlySearchedDescription.X+lblMaterialRecentlySearchedDescription.Width
                            ZIndex: =3

                        lblMaterialRecentlySearchedDescription As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Name
                            Tooltip: =Self.Text
                            Width: =conMaterialRecentlySearchedTableHeaderDescription.Width
                            Wrap: =false
                            X: =btnMaterialRecentlySearchedMaterial.X*2+btnMaterialRecentlySearchedMaterial.Width
                            ZIndex: =4

                        btnMaterialRecentlySearchedMaterial As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =43
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =Color.Transparent
                            OnSelect: |
                                =//Set the selected material variable
                                Set(
                                    varSelectedMaterialHeader,
                                    {
                                        MaterialNumber: ThisItem.'Object ID',
                                        Description: ThisItem.Name,
                                        _UoM:ThisItem.'Attribute 1'
                                    }
                                );
                                //Navigate back to previous screen
                                Select(conMaterialSearchBack);
                                //Create or update materials search history record
                                Patch(
                                    'SAP Search Histories',
                                    Coalesce(
                                        LookUp(
                                            'SAP Search Histories',
                                            'SAP Search History' = ThisItem.'SAP Search History'
                                        ),
                                        Defaults('SAP Search Histories')
                                    ),
                                    {
                                        'Object ID': ThisItem.'Object ID',
                                        'Object Type': 'Object Type (SAP Search Histories)'.Material,
                                        Name: ThisItem.Name,
                                        'Attribute 1': ThisItem.'Attribute 1',
                                        'Last Searched On': Now()
                                    }
                                );
                                //Assess patch for errors and notify appropriately
                                If(
                                    !IsEmpty(Errors('SAP Search Histories')),
                                    Notify(
                                        First(Errors('SAP Search Histories')).Message,
                                        NotificationType.Error,
                                        0
                                    ),
                                    Refresh('SAP Search Histories')
                                );
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.'Object ID'
                            Tooltip: =Self.Text
                            Width: =conMaterialRecentlySearchedTableHeaderMaterial.Width-Self.X*2
                            X: =Self.FocusedBorderThickness
                            ZIndex: =5

                    conMaterialNoRecentlySearchedResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galRecentlySearchedMaterials.Visible
                        Width: =
                        ZIndex: =4

                        icoMaterialNoRecentlySearchedResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            OnSelect: =
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblMaterialNoRecentlySearchedResults.Y-lblMaterialNoRecentlySearchedResults.Height-30
                            ZIndex: =1

                        lblMaterialNoRecentlySearchedResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

            lblNumberOfRecentlySearchedMaterialRecords As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varThemeColors.primary
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Lighter
                Height: =30
                Live: =Live.Polite
                PaddingBottom: =0
                PaddingLeft: =btnMaterialSearchResultsTableHeaderMaterial.PaddingLeft
                Size: =10.5
                Text: |-
                    =//Show how many rows are returned in the results
                    
                    CountRows(galRecentlySearchedMaterials.AllItems) & " "& //Count the rows in the gallery
                    // Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "record(s)"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Visible: =galRecentlySearchedMaterials.Visible
                X: =1
                ZIndex: =7

