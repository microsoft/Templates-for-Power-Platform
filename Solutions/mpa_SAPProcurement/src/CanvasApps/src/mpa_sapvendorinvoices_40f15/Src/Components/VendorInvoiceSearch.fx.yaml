VendorInvoiceSearch As CanvasComponent:
    Fill: =varThemeColors.background
    Height: =App.Height
    OnReset: |
        =Set(
            varCurrentVendorInvoiceSearchTab,//Variable that drives which tab is selected control behavior, default to search all
            btnVendorInvoiceSearchAllTab.Text
        );
        Set(
            varRecentlySearchedSortOrder,//Variable that drives the sort order of recently searched gallery, default to descending
            SortOrder.Descending
        );
        Set(
            varRecentlySearchedSortByColumn,//Variable that drives the sort by column of recently searched gallery, default to last searched datetime field
            btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Text
        );
        Set(
            varVendorInvoiceSearchAllSortOrder,//Variable that drives the sort order of search all results gallery, default to ascending
            SortOrder.Ascending
        );
        Set(
            varVendorInvoiceSearchAllSortByColumn,//Variable that drives the sort by column of search all results gallery, default to vendor
            btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text
        );
        //Ensure any cached searched results and recent search history is blank
        Clear(colVendorInvoiceSearchResults);
    ResetSearch: =true
    Width: =1240
    X: =0
    Y: =0
    ZIndex: =2

    conVendorInvoiceSearchMain As groupContainer.verticalAutoLayoutContainer:
        Height: =VendorInvoiceSearch.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =VendorInvoiceSearch.Width
        ZIndex: =2

        conVendorInvoiceSearchHeader As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =48
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conVendorInvoiceSearchAll.Visible,
                    conVendorInvoiceSearchAll.LayoutMinWidth,
                    conVendorInvoiceRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =Parent.Width
            ZIndex: =1

            "icoVendorInvoiceSearchHeader As icon.'3DPrinting'":
                AccessibleLabel: =Self.Tooltip
                BorderColor: =varThemeColors.primary
                Color: =varThemeColors.primary
                DisabledBorderColor: =varThemeColors.disabledText
                DisabledColor: =varThemeColors.backgroundFillDisabled
                DisabledFill: =RGBA(0,0,0,0)
                DisplayMode: |-
                    =If(
                        varIsProcessing,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Fill: =RGBA(0,0,0,0)
                FocusedBorderColor: =varThemeColors.focusBorder
                Height: =30
                HoverBorderColor: =varThemeColors.primary
                HoverColor: =varThemeColors.tertiary
                HoverFill: =RGBA(0,0,0,0)
                Icon: =Icon.ArrowLeft
                OnSelect: |
                    =Set(
                        varNewVendorHeader,
                        Blank()
                    );
                    Navigate(
                        Last(
                            Sort(
                                colAppNavigationThreads,
                                Order
                            )
                        ).Screen,
                        ScreenTransition.CoverRight
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedBorderColor: =varThemeColors.primary
                PressedColor: =varThemeColors.primary
                PressedFill: =RGBA(0,0,0,0)
                TabIndex: =0
                Tooltip: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Back"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =30
                Y: =Parent.Height/2-Self.Height/2
                ZIndex: =1

            lblVendorInvoiceSearchHeader As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Parent.Height
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =14.5
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Vendor invoice search"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width-Self.X
                Wrap: =false
                ZIndex: =2

        conVendorInvoiceSearchTabs As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =43
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conVendorInvoiceSearchAll.Visible,
                    conVendorInvoiceSearchAll.LayoutMinWidth,
                    conVendorInvoiceRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =Parent.Width
            ZIndex: =2

            conVendorInvoiceSearchAllTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnVendorInvoiceSearchAllTab.Text)*8
                Y: =36
                ZIndex: =1

                shpVendorInvoiceSearchAllTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentVendorInvoiceSearchTab=btnVendorInvoiceSearchAllTab.Text
                    Width: =btnVendorInvoiceSearchAllTab.Width
                    X: =1
                    Y: =btnVendorInvoiceSearchAllTab.Y+btnVendorInvoiceSearchAllTab.Height
                    ZIndex: =1

                btnVendorInvoiceSearchAllTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: |-
                        =If(
                            varCurrentVendorInvoiceSearchTab = Self.Text,
                            FontWeight.Semibold,
                            FontWeight.Normal
                        )
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: |
                        =Set(
                            varCurrentVendorInvoiceSearchTab, //Variable that drives which tab is selected and drives which search results to show
                            Self.Text
                        );
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search all"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

            conVendorInvoiceSearchRecentTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnVendorInvoiceSearchRecentTab.Text)*8
                Y: =36
                ZIndex: =2

                shpVendorInvoiceSearchRecentTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentVendorInvoiceSearchTab=btnVendorInvoiceSearchRecentTab.Text
                    Width: =btnVendorInvoiceSearchRecentTab.Width
                    X: =1
                    Y: =btnVendorInvoiceSearchRecentTab.Y+btnVendorInvoiceSearchRecentTab.Height
                    ZIndex: =1

                btnVendorInvoiceSearchRecentTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: |-
                        =If(
                            varCurrentVendorInvoiceSearchTab = Self.Text,
                            FontWeight.Semibold,
                            FontWeight.Normal
                        )
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: |-
                        =Reset(txtVendorInvoiceRecentlySearchedCommandBarFilter);
                        Set(
                            varCurrentVendorInvoiceSearchTab,//Variable that drives which tab is selected and drives which search results to show
                            Self.Text
                        );
                        Refresh('SAP Search Histories')
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Recently searched"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

        conVendorInvoiceSearchAll As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Height: =700
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conVendorInvoiceSearchAllFooter.Height +  conVendorInvoiceSearchAllResults.LayoutMinHeight + conVendorInvoiceSearchAllFields.Height + conVendorInvoiceSearchButtons.Height + Self.PaddingTop + Self.PaddingBottom + Self.LayoutGap * 2 + 10
            LayoutMinWidth: =conVendorInvoiceSearchAllResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =25
            Visible: =varCurrentVendorInvoiceSearchTab = btnVendorInvoiceSearchAllTab.Text
            Width: =Parent.Width
            ZIndex: =3

            conVendorInvoiceSearchAllFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: =64
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                ZIndex: =1

                conVendorInvoiceSearchAllVendor As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(lblVendorInvoiceSearchAllVendor.Text) * 10
                        )
                    X: =40
                    ZIndex: =1

                    txtVendorInvoiceSearchAllVendor As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                Self.Color = varThemeColors.requiredRed,
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Color: |-
                            =If(
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.text
                            )
                        Default: |-
                            =If(
                                VendorInvoiceSearch.ResetSearch,
                                "",
                                varNewVendorHeader.Vendor
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter vendor number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        Italic: |+
                            =Switch(true,
                                IsBlank(Self.Text),
                                false,
                                !IsBlank(varNewVendorHeader.Vendor) && Self.Text = varNewVendorHeader.Vendor,
                                false,
                                true
                            )
                            
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblVendorInvoiceSearchAllVendor.Width-conVendorInvoiceSearchAllVendorAdvanced.Width-10-Self.X
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceSearchAllVendor.Y+lblVendorInvoiceSearchAllVendor.Height
                        ZIndex: =2

                    "conVendorInvoiceSearchAllVendorAdvanced As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.focusBorder
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.FilterFlat
                        OnSelect: |-
                            =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                            Collect(
                                colAppNavigationThreads,
                                Table(
                                    {
                                        Screen: App.ActiveScreen,
                                        Order: CountRows(colAppNavigationThreads) + 1
                                    }
                                )
                            );
                            //sets global variable so the component knows which screen to navigate back to
                            Navigate(
                                'Vendor Search Screen',
                                ScreenTransition.Cover
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor advanced search"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =32
                        X: =conVendorInvoiceSearchAllVendor.Width-Self.Width-Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceSearchAllVendor.Y+lblVendorInvoiceSearchAllVendor.Height
                        ZIndex: =3

                    "icoVendorInvoiceSearchAllVendor As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primaryGray
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        Height: =32  
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.ArrowRight
                        OnSelect: |
                            =//Sets processing indicator control behavior 
                            Set(
                                varIsProcessing,
                                true
                            );
                            //Call ReadVendor Power Automate to read the vendor from SAP
                            ClearCollect(
                                colReadVendorResponseTemp,//collection that temporarily stores the vendor response data
                                ReadVendor.Run(Trim(txtVendorInvoiceSearchAllVendor.Text))
                            );
                            //Evalute response conditions
                            Switch(
                                true,
                                And(//Check to see if vendor call was successful and process happy path logic
                                    First(colReadVendorResponseTemp).Status = "Success",
                                    !IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                ),
                                Set(
                                    varNewVendorHeader,//Variable that stores the returned main vendor header data
                                    First(colReadVendorResponseTemp).Header
                                );
                                Patch(
                                    'SAP Search Histories',
                                    Coalesce(
                                        LookUp(
                                            'SAP Search Histories',
                                            And(
                                                'Object Type' = 'Object Type (SAP Search Histories)'.Vendor,
                                                'Object ID' = varNewVendorHeader.Vendor,
                                                'Created By'.User = varSystemUserID
                                            )
                                        ),
                                        Defaults('SAP Search Histories')
                                    ),
                                    {
                                        'Object ID': varNewVendorHeader.Vendor,
                                        'Object Type': 'Object Type (SAP Search Histories)'.Vendor,
                                        Name: varNewVendorHeader.VendorName,
                                        'Attribute 1': Concatenate(
                                            varNewVendorHeader.Vendor,
                                            "-",
                                            varNewVendorHeader.VendorName
                                        ),
                                        'Last Searched On': Now()
                                    }
                                );
                                //Check if the patch function was successful and notify if there was any errors.
                            If(
                                    !IsEmpty(Errors('SAP Search Histories')),
                                    Notify(
                                        First(Errors('SAP Search Histories')).Message,
                                        NotificationType.Error,
                                        0
                                    ),
                                    Refresh('SAP Search Histories')
                                );
                                ,//End if ReadVendor Power Automate call was success
                                And(//Check to see if call was successful, but no vendor was found
                                    First(colReadVendorResponseTemp).Status = "Information",
                                    IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                ),
                                Notify(
                                    With(
                                        {Text: "Vendor not found"},
                                        If(
                                    // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                    // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    NotificationType.Information,
                                    7000
                                ),//Error response returned
                                First(colReadVendorResponseTemp).Status = "Error",
                                Notify(
                                    Concat(
                                        First(colReadVendorResponseTemp).Messages,
                                        Message,
                                        " "
                                    ),
                                    NotificationType.Error,
                                    0
                                ),//Default response for an unhandled error return
                                Notify(
                                    With(
                                        {Text: "Unexpected error occurred"},
                                        If(
                                    // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                    // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    NotificationType.Error,
                                    0
                                )
                            );
                            //End vendor response switch statement
                            //Reset loading to false as the data query is complete
                            //done with read vendor temp collections, clear cache
                            Clear(colReadVendorResponseTemp);
                            Set(
                                varIsProcessing,//done processing read vendor, set variable back to false stopping any processing control behavior
                                false
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =With(
                                {Text: "Execute vendor search"},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =!IsBlank(txtVendorInvoiceSearchAllVendor.Text)
                        Width: =30
                        X: =txtVendorInvoiceSearchAllVendor.X+txtVendorInvoiceSearchAllVendor.Width-Self.Width
                        Y: =txtVendorInvoiceSearchAllVendor.Y
                        ZIndex: =4

                    lblVendorInvoiceSearchAllVendor As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conVendorInvoiceSearchAllDocumentType As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =275
                    X: =40
                    ZIndex: =2

                    cmbVendorInvoiceSearchAllDocumentType As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =If(
                                VendorInvoiceSearch.ResetSearch,
                                Defaults('SAP List of Values')
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Document Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Document Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceSearchAllDocumentType.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        Width: =lblVendorInvoiceSearchAllDocumentType.Width
                        X: =lblVendorInvoiceSearchAllDocumentType.X
                        Y: =lblVendorInvoiceSearchAllDocumentType.Y+lblVendorInvoiceSearchAllDocumentType.Height
                        ZIndex: =1

                    lblVendorInvoiceSearchAllDocumentType As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceSearchAllCompanyCode As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =275
                    X: =40
                    ZIndex: =3

                    cmbVendorInvoiceSearchAllCompanyCode As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =If(
                                VendorInvoiceSearch.ResetSearch,
                                Defaults('SAP List of Values')
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Company Code',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Company Code',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceSearchAllCompanyCode.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Select purchasing organization"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        Width: =lblVendorInvoiceSearchAllCompanyCode.Width
                        X: =lblVendorInvoiceSearchAllCompanyCode.X
                        Y: =lblVendorInvoiceSearchAllCompanyCode.Y+lblVendorInvoiceSearchAllCompanyCode.Height
                        ZIndex: =1

                    lblVendorInvoiceSearchAllCompanyCode As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceSearchAllDateFrom As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            160,
                            Len(dteVendorInvoiceSearchAllDateFrom.InputTextPlaceholder) * 10
                        )
                    ZIndex: =4

                    dteVendorInvoiceSearchAllDateFrom As datepicker:
                        AccessibleLabel: |-
                            =If(
                                Or(
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                With(
                                    {Text: "Select created from date required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        BorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: =If(VendorInvoiceSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select from date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceSearchAllDateFrom.Height+lblVendorInvoiceSearchAllDateFrom.Y
                        ZIndex: =1

                    lblVendorInvoiceSearchAllDateFrom As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Created from"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(
                                Or(
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                " *"
                            )
                        Width: =Parent.Width
                        X: =dteVendorInvoiceSearchAllDateFrom.X
                        ZIndex: =2

                conVendorInvoiceSearchAllDateTo As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            160,
                            Len(dteVendorInvoiceSearchAllDateTo.InputTextPlaceholder) * 10
                        )
                    ZIndex: =5

                    dteVendorInvoiceSearchAllDateTo As datepicker:
                        AccessibleLabel: |-
                            =If(
                                Or(
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                With(
                                    {Text: "Select created to date required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        BorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: =If(VendorInvoiceSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select to date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =4
                        Y: =lblVendorInvoiceSearchAllDateTo.Height+lblVendorInvoiceSearchAllDateTo.Y
                        ZIndex: =1

                    lblVendorInvoiceSearchAllDateTo As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Created to"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(
                                Or(
                                    !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                                ),
                                " *"
                            )
                        Width: =Parent.Width
                        X: =dteVendorInvoiceSearchAllDateTo.X
                        ZIndex: =2

            conVendorInvoiceSearchButtons As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: =42
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =20
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =2
                PaddingRight: =2
                Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                ZIndex: =2

                btnVendorInvoiceSearchButtonsSearc As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.altText
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |
                        =//Check if required search fields and store missing fields in a collection
                        Clear(colRequiredFieldsTemp);
                        If(
                            And(
                                IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                !IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                            ),
                            Collect(
                                colRequiredFieldsTemp,
                                lblVendorInvoiceSearchAllDateFrom.Text
                            )
                        );
                        If(
                            And(
                                !IsBlank(dteVendorInvoiceSearchAllDateFrom.SelectedDate),
                                IsBlank(dteVendorInvoiceSearchAllDateTo.SelectedDate)
                            ),
                            Collect(
                                colRequiredFieldsTemp,
                                lblVendorInvoiceSearchAllDateTo.Text
                            )
                        );
                        //Check to see if required fields collection, notify which fields are missing if so
                        If(
                            !IsEmpty(colRequiredFieldsTemp),
                            Notify(
                                Substitute(
                                    With(
                                        {Text: "The following information is required before searching"},
                                        If(
                                // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ) & ": " & Concat(
                                        colRequiredFieldsTemp,
                                        Value,
                                        ", "
                                    ),
                                    " *",
                                    ""
                                ),
                                NotificationType.Error,
                                0
                            );
                            ,
                            //Reset filter controls, cached data and table sort orders
                            Set(
                                varVendorInvoiceSearchAllSortOrder,
                                SortOrder.Ascending
                            );
                            Set(
                                varVendorInvoiceSearchAllSortByColumn,
                                btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text
                            );
                            Set(
                                varIsProcessing,
                                true
                            );
                            Set(
                                varFooterMessage,
                                "Searching"
                            );
                            
                        //Invoke the ReadVendorInvoiceList power automate and store results in a collection
                        ClearCollect(
                                colVendorInvoiceSearchResultsTemp,
                                ReadVendorInvoiceList.Run(
                                    Substitute(
                                        JSON(
                                            {
                                                Vendor: Trim(txtVendorInvoiceSearchAllVendor.Text),
                                                DateFrom: Text(
                                                    dteVendorInvoiceSearchAllDateFrom.SelectedDate,
                                                    "yyyymmdd",
                                                    "en-US"
                                                ),
                                                DateTo: Text(
                                                    dteVendorInvoiceSearchAllDateTo.SelectedDate,
                                                    "yyyymmdd",
                                                    "en-US"
                                                ),
                                                Type: cmbVendorInvoiceSearchAllDocumentType.Selected.'Value Code',
                                                CompanyCode: cmbVendorInvoiceSearchAllCompanyCode.Selected.'Value Code'
                                            },
                                            JSONFormat.IndentFour
                                        ),
                                        "null",
                                        """"""
                                    )
                                )
                            );
                            //Add vendor name column to support rendering in gallery list
                        ClearCollect(
                                colVendorInvoiceSearchResults,
                                AddColumns(
                                    First(colVendorInvoiceSearchResultsTemp).List,
                                    "_VendorName",
                                    LookUp(
                                        First(colVendorInvoiceSearchResultsTemp).Names As tempCol1,
                                        Vendor = tempCol1.Vendor,
                                        tempCol1.Name
                                    )
                                )
                            );
                            //Evaluate return statuses to determine what type of notification
                        With(
                                {
                                    Text: Switch(
                                        First(colVendorInvoiceSearchResultsTemp).Status,
                                        "Information",
                                        "No vendor invoices were found based on your search criteria",
                                        "Warning",
                                        "The maximum number of search results were found based upon your criteria and some records may be missing. Please try changing your search criteria.",
                                        "Error",
                                        Concat(
                                            First(colVendorInvoiceSearchResultsTemp).Messages,
                                            Message,
                                            " "
                                        ),
                                        "vendor invoices found based upon your search criteria"
                                    ),
                                    Status: First(colVendorInvoiceSearchResultsTemp).Status
                                },
                                Notify(
                                //Append record count to message if success
                                    Concatenate(
                                        If(
                                            Status = "Success",
                                            CountRows(colVendorInvoiceSearchResults)
                                        ) & " ",
                                        If(
                                // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    //Set the notification type
                                    Switch(
                                        Status,
                                        "Information",
                                        NotificationType.Information,
                                        "Warning",
                                        NotificationType.Warning,
                                        "Error",
                                        NotificationType.Error,
                                        NotificationType.Success
                                    )
                                );
                            );
                            
                        );
                        Clear(colRequiredFieldsTemp);
                        Clear(colVendorInvoiceSearchResultsTemp);
                        Reset(galVendorInvoiceSearchResults);
                        //Done processing
                        Set(
                            varIsProcessing,
                            false
                        );
                        Set(
                            varFooterMessage,
                            Blank()
                        );
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =1
                    Y: =1
                    ZIndex: =1

                conVendorInvoiceSearchButtonsClear As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |-
                        =Set(
                            varNewVendorHeader,
                            Blank()
                        );
                        Clear(colVendorInvoiceSearchResults);
                        //Reset all the controls and clear the cache
                        Reset(cmbVendorInvoiceSearchAllDocumentType);
                        Reset(dteVendorInvoiceSearchAllDateFrom);
                        Reset(dteVendorInvoiceSearchAllDateTo);
                        Reset(txtVendorInvoiceSearchAllVendor);
                        Reset(txtVendorInvoiceSearchAllResultsCommandBarFilter);
                        Reset(cmbVendorInvoiceSearchAllCompanyCode)
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Clear"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =btnVendorInvoiceSearchButtonsSearc.X+btnVendorInvoiceSearchButtonsSearc.Width+20
                    Y: =1
                    ZIndex: =2

            conVendorInvoiceSearchAllResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conVendorInvoiceSearchAllResultsTable.LayoutMinHeight + conVendorInvoiceSearchAllResultsCommandBar.Height + shpVendorInvoiceSearchAllResultsDivider.Height
                LayoutMinWidth: =conVendorInvoiceSearchAllResultsTable.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =3

                conVendorInvoiceSearchAllResultsCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblVendorInvoiceSearchAllResultsCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Search results"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*9
                        ZIndex: =1

                    conVendorInvoiceSearchAllResultsCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtVendorInvoiceSearchAllResultsCommandBarFilter.X+txtVendorInvoiceSearchAllResultsCommandBarFilter.Width+txtVendorInvoiceSearchAllResultsCommandBarFilter.FocusedBorderThickness
                        ZIndex: =4

                        txtVendorInvoiceSearchAllResultsCommandBarFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(
                                        IsEmpty(colVendorInvoiceSearchResults),
                                        varIsProcessing
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |
                                =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Filter vendor invoices"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                        // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                        // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpVendorInvoiceSearchAllResultsCommandBarFilterDivider.X+shpVendorInvoiceSearchAllResultsCommandBarFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpVendorInvoiceSearchAllResultsCommandBarFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpVendorInvoiceSearchAllResultsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Width: =
                    ZIndex: =2

                conVendorInvoiceSearchAllResultsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conVendorInvoiceSearchAllResultsTableHeader.Height + shpVendorInvoiceSearchResultsDivider.Height + If(galVendorInvoiceSearchResults.Visible,
                            galVendorInvoiceSearchResults.LayoutMinHeight,
                            conVendorInvoiceSearchNoResults.LayoutMinHeight
                        ) + Self.PaddingBottom + Self.PaddingTop
                    LayoutMinWidth: =conVendorInvoiceSearchAllResultsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                    ZIndex: =3

                    conVendorInvoiceSearchAllResultsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =conVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.LayoutMinWidth + conVendorInvoiceSearchAllResultsTableHeaderVendor.LayoutMinWidth + conVendorInvoiceSearchAllResultsTableHeaderVendorName.LayoutMinWidth + conVendorInvoiceSearchAllResultsTableHeaderCreatedOn.LayoutMinWidth + conVendorInvoiceSearchAllResultsTableHeaderCompanyCode.LayoutMinWidth +  conVendorInvoiceSearchAllResultsTableHeaderAmount.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.X+icoVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =1

                            icoVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text)*8+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Y+btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(
                                            varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                            varVendorInvoiceSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Invoice number"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderVendor As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderVendor.X+icoVendorInvoiceSearchAllResultsTableHeaderVendor.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderVendor.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =2

                            icoVendorInvoiceSearchAllResultsTableHeaderVendor As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderVendor.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderVendor.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderVendor.Text)*10+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderVendor.Y+btnVendorInvoiceSearchAllResultsTableHeaderVendor.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderVendor As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,varVendorInvoiceSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Vendor"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderVendorName As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderVendorName.X+icoVendorInvoiceSearchAllResultsTableHeaderVendorName.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =3

                            icoVendorInvoiceSearchAllResultsTableHeaderVendorName As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderVendorName.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Text)*9+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Y+btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderVendorName As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,varVendorInvoiceSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Vendor name"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderCreatedOn As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderCreatedOn.X+icoVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Text) * btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Size,
                                    244
                                )
                            Y: =37
                            ZIndex: =4

                            icoVendorInvoiceSearchAllResultsTableHeaderCreatedOn As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Text)*8.5+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Y+btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(
                                            varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                            varVendorInvoiceSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Created on"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderDocType As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderDocType.X+icoVendorInvoiceSearchAllResultsTableHeaderDocType.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderDocType.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =5

                            icoVendorInvoiceSearchAllResultsTableHeaderDocType As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderDocType.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderDocType.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderDocType.Text)*10+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderDocType.Y+btnVendorInvoiceSearchAllResultsTableHeaderDocType.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderDocType As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,varVendorInvoiceSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Document type"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderCompanyCode As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderCompanyCode.X+icoVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =6

                            icoVendorInvoiceSearchAllResultsTableHeaderCompanyCode As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Text)*9+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Y+btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,varVendorInvoiceSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Company code"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceSearchAllResultsTableHeaderAmount As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceSearchAllResultsTableHeaderAmount.X+icoVendorInvoiceSearchAllResultsTableHeaderAmount.Width+10
                            Width: |-
                                =Max(
                                    Len(btnVendorInvoiceSearchAllResultsTableHeaderAmount.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =7

                            icoVendorInvoiceSearchAllResultsTableHeaderAmount As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceSearchAllResultsTableHeaderAmount.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceSearchAllSortByColumn=btnVendorInvoiceSearchAllResultsTableHeaderAmount.Text && galVendorInvoiceSearchResults.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceSearchAllResultsTableHeaderAmount.Text)*10.5+8
                                Y: =btnVendorInvoiceSearchAllResultsTableHeaderAmount.Y+btnVendorInvoiceSearchAllResultsTableHeaderAmount.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceSearchAllResultsTableHeaderAmount As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galVendorInvoiceSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceSearchAllSortOrder = SortOrder.Ascending,varVendorInvoiceSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Amount"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpVendorInvoiceSearchResultsDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                        ZIndex: =2

                    galVendorInvoiceSearchResults As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: =
                        ItemAccessibleLabel: =ThisItem.InvoiceNumber
                        Items: |-
                            =//Display vendor invoice search result items based upon whether filters results further and/or by sort column selected
                            With(
                                {
                                    searchResults: If(
                                        IsBlank(txtVendorInvoiceSearchAllResultsCommandBarFilter.Text),//If additional filter text not entered, then just display results
                                        colVendorInvoiceSearchResults,
                                        Search(//Otherwise, search on cached results based upon entered text
                                            colVendorInvoiceSearchResults,
                                            txtVendorInvoiceSearchAllResultsCommandBarFilter.Text,
                                            "Vendor",
                                            "_VendorName",
                                            "InvoiceNumber",
                                            "Type",
                                            "CompanyCode"
                                        )
                                    )
                                },
                                SortByColumns(
                                    searchResults,
                                    Switch(
                                        varVendorInvoiceSearchAllSortByColumn,//determine which field to sort by based upon the tabel header column value selected and stored in variable
                                        btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Text,
                                        "InvoiceNumber",
                                        btnVendorInvoiceSearchAllResultsTableHeaderVendor.Text,
                                        "Vendor",
                                        btnVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Text,
                                        "CreatedOn",
                                        btnVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Text,
                                        "CompanyCode",
                                        btnVendorInvoiceSearchAllResultsTableHeaderAmount.Text,
                                        "Amount",
                                        btnVendorInvoiceSearchAllResultsTableHeaderVendorName.Text,
                                        "_VendorName"
                                    ),
                                    varVendorInvoiceSearchAllSortOrder//sort ascending or descending based upon value stored in variable
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =!IsEmpty(colVendorInvoiceSearchResults)
                        Width: =
                        ZIndex: =4

                        shpVendorInvoiceSearchResultsRowDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblVendorInvoiceSearchResultsAmount As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |
                                =Text(
                                    ThisItem.Amount,
                                    "[$-en-US]#,##0.00"
                                ) & Concatenate(
                                    " (",
                                    ThisItem.Currency,
                                    ")"
                                )
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderAmount.Width-15//scrollbar padding
                            Wrap: =false
                            X: =lblVendorInvoiceSearchResultsCompanyCode.X+lblVendorInvoiceSearchResultsCompanyCode.Width
                            ZIndex: =2

                        lblVendorInvoiceSearchResultsCompanyCode As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.CompanyCode
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderCompanyCode.Width
                            Wrap: =false
                            X: =lblVendorInvoiceSearchResultsDocumentType.X+lblVendorInvoiceSearchResultsDocumentType.Width
                            ZIndex: =3

                        lblVendorInvoiceSearchResultsDocumentType As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Type
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderVendor.Width
                            Wrap: =false
                            X: =lblVendorInvoiceSearchResultsCreatedOn.X + lblVendorInvoiceSearchResultsCreatedOn.Width
                            ZIndex: =4

                        lblVendorInvoiceSearchResultsCreatedOn As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    DateValue(ThisItem.CreatedOn),
                                    DateTimeFormat.ShortDate
                                )
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderCreatedOn.Width
                            Wrap: =false
                            X: =lblVendorInvoiceSearchResultsVendorName.X+lblVendorInvoiceSearchResultsVendorName.Width
                            ZIndex: =5

                        lblVendorInvoiceSearchResultsVendorName As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem._VendorName
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderVendorName.Width
                            Wrap: =false
                            X: =lblVendorInvoiceSearchResultsVendor.X + lblVendorInvoiceSearchResultsVendor.Width
                            ZIndex: =6

                        lblVendorInvoiceSearchResultsVendor As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Vendor
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceSearchAllResultsTableHeaderVendor.Width
                            Wrap: =false
                            X: =btnVendorInvoiceSearchResultsSelect.X * 2 + btnVendorInvoiceSearchResultsSelect.Width
                            ZIndex: =7

                        btnVendorInvoiceSearchResultsSelect As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =
                            OnSelect: |
                                =Set(
                                    varSelectedVendorInvoiceID,
                                    ThisItem.InvoiceNumber
                                );
                                Select(icoVendorInvoiceSearchHeader);
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.InvoiceNumber
                            Tooltip: =Self.Text
                            Width: =btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.Width-Self.X*2
                            X: =Self.FocusedBorderThickness
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =8

                    conVendorInvoiceSearchNoResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galVendorInvoiceSearchResults.Visible
                        Width: =
                        ZIndex: =5

                        icoVendorInvoiceSearchNoResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No results"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            Visible: =!varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblVendorInvoiceSearchNoResults.Y-lblVendorInvoiceSearchNoResults.Height-30
                            ZIndex: =1

                        lblVendorInvoiceSearchNoResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Visible: =!varIsProcessing
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

                        imgVendorInvoiceLoadingSubGrid As image:
                            Height: =46
                            Image: ='loading-grey'
                            Visible: =varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblVendorInvoiceSearchNoResults.Y-lblVendorInvoiceSearchNoResults.Height-33
                            ZIndex: =3

            conVendorInvoiceSearchAllFooter As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =30
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =5

                lblVendorInvoiceSearchNumberOfFoundRecords As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Lighter
                    Height: =30
                    LayoutMinWidth: =
                    PaddingLeft: =btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.PaddingLeft
                    Size: =10.5
                    Text: |-
                        =//Show how many rows are returned in the results
                        CountRows(galVendorInvoiceSearchResults.AllItems) & " " &//Count the rows in the gallery
                        // Define a variable named "Text" with the value "{value}"
                         With(
                            {Text: "record(s)"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Visible: =galVendorInvoiceSearchResults.Visible
                    Width: =
                    X: =1
                    ZIndex: =1

                lblVendorInvoiceSearchAllFooterMessage As label:
                    Align: =Align.Right
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =34
                    Italic: =true
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =32
                    PaddingRight: =32
                    PaddingTop: =0
                    Role: =TextRole.Heading2
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: varFooterMessage},
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ) & If(varIsProcessing, "...")
                    Visible: =!IsBlank(varFooterMessage)
                    Width: =
                    ZIndex: =2

        conVendorInvoiceRecentlySearched As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =600
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conVendorInvoiceRecentlySearchedResults.LayoutMinHeight + lblNumberOfRecentlySearchedVendorInvoiceRecords.Height + Self.PaddingBottom + Self.PaddingTop + 10
            LayoutMinWidth: =conVendorInvoiceRecentlySearchedResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight + 125
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =24
            Visible: =varCurrentVendorInvoiceSearchTab = btnVendorInvoiceSearchRecentTab.Text
            Width: =Parent.Width
            X: =40
            Y: =40
            ZIndex: =4

            conVendorInvoiceRecentlySearchedResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conVendorInvoiceRecentlySearchTable.LayoutMinHeight + shpVendorInvoiceRecentlySearchedResultsDivider.Height + conVendorInvoiceRecentlySearchedCommandBar.Height
                LayoutMinWidth: =conVendorInvoiceRecentlySearchTable.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =Parent.Width
                ZIndex: =6

                conVendorInvoiceRecentlySearchedCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblVendorInvoiceRecentlySearchedCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Recent records"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*7.5
                        ZIndex: =1

                    conVendorInvoiceRecentlySearchedCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtVendorInvoiceRecentlySearchedCommandBarFilter.X+txtVendorInvoiceRecentlySearchedCommandBarFilter.Width+txtVendorInvoiceRecentlySearchedCommandBarFilter.FocusedBorderThickness
                        ZIndex: =3

                        txtVendorInvoiceRecentlySearchedCommandBarFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    galRecentlySearchedVendorInvoices.Visible,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Filter vendor invoices"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpVendorInvoiceRecentlySearchedCommandBarFilterDivider.X+shpVendorInvoiceRecentlySearchedCommandBarFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpVendorInvoiceRecentlySearchedCommandBarFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpVendorInvoiceRecentlySearchedResultsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =Parent.LayoutMinWidth
                    Width: =
                    ZIndex: =2

                conVendorInvoiceRecentlySearchTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conVendorInvoiceRecentlySearchedTableHeader.Height + shpVendorInvoiceRecentlySearchedDivider.Height + If(galRecentlySearchedVendorInvoices.Visible,
                            galRecentlySearchedVendorInvoices.LayoutMinHeight,
                            conVendorInvoiceNoRecentlySearchedResults.Height
                        )+Self.PaddingTop+Self.PaddingBottom
                    LayoutMinWidth: =conVendorInvoiceRecentlySearchedTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =
                    ZIndex: =7

                    conVendorInvoiceRecentlySearchedTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =
                        LayoutMinWidth: =conVendorInvoiceRecentlySearchedTableHeaderInvoice.LayoutMinWidth + conVendorInvoiceRecentlySearchedTableHeaderLastSearched.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conVendorInvoiceRecentlySearchedTableHeaderInvoice As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceRecentlySearchedTableHeaderInvoice.X+icoVendorInvoiceRecentlySearchedTableHeaderInvoice.Width+10
                            Y: =37
                            ZIndex: =1

                            icoVendorInvoiceRecentlySearchedTableHeaderInvoice As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceRecentlySearchedTableHeaderInvoice.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Text && galRecentlySearchedVendorInvoices.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Text)*8+8
                                Y: =btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Y+btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceRecentlySearchedTableHeaderInvoice As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedVendorInvoices.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRecentlySearchedSortOrder = SortOrder.Ascending,varRecentlySearchedSortByColumn=Self.Text),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRecentlySearchedVendorInvoices)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Invoice"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceRecentlySearchedTableHeaderLastSearched As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceRecentlySearchedTableHeaderLastSearched.X+icoVendorInvoiceRecentlySearchedTableHeaderLastSearched.Width+10
                            Width: =162
                            Y: =37
                            ZIndex: =3

                            icoVendorInvoiceRecentlySearchedTableHeaderLastSearched As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Text && galRecentlySearchedVendorInvoices.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Text)*7.5+8
                                Y: =btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Y+btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceRecentlySearchedTableHeaderLastSearched As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedVendorInvoices.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varRecentlySearchedSortOrder = SortOrder.Ascending,
                                            varRecentlySearchedSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galRecentlySearchedVendorInvoices)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Last searched"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpVendorInvoiceRecentlySearchedDivider As rectangle:
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        Width: =
                        ZIndex: =2

                    galRecentlySearchedVendorInvoices As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor invoices recently searched"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: =
                        Items: |-
                            =//Display recent search result items sorting according to table header buttons selected and searched on further based upon filter text input
                            With(
                                {
                                    recentItems: If(
                                        IsBlank(txtVendorInvoiceRecentlySearchedCommandBarFilter.Text),//Items are not being filtered further
                                        Filter(
                                            'SAP Search Histories',
                                            'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                            'Object Type' = 'Object Type (SAP Search Histories)'.'Vendor Invoice'
                                        ),
                                        Search(//Search further on history records
                                            Filter(
                                                'SAP Search Histories',
                                                'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                                'Object Type' = 'Object Type (SAP Search Histories)'.'Vendor Invoice'
                                            ),
                                            txtVendorInvoiceRecentlySearchedCommandBarFilter.Text,//Search on text entered in filter control
                                            "mpa_objectid",
                                            "mpa_name"
                                        )
                                    )
                                },
                                SortByColumns(
                                    recentItems,
                                    Switch(
                                        varRecentlySearchedSortByColumn,//determine which field to sort by based upon the tabel header column value selected and stored in variable
                                        btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Text,
                                        "mpa_name",
                                        btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Text,
                                        "mpa_lastsearchedon"
                                    ),
                                    varRecentlySearchedSortOrder//sort ascending or descending based upon value stored in variable
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =320
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: |-
                            =!IsEmpty(
                                Filter(
                                    'SAP Search Histories',
                                    'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                    'Object Type' = 'Object Type (SAP Search Histories)'.'Vendor Invoice'//Filter on object type vendor invoice
                                )
                            )
                        Width: =
                        ZIndex: =3

                        shpVendorInvoiceRecentlySearchedDivider_1 As rectangle:
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblVendorInvoiceRecentlySearchedLastSearched As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.'Last Searched On',
                                    DateTimeFormat.ShortDateTime
                                )
                            Tooltip: =Self.Text
                            Width: =btnVendorInvoiceRecentlySearchedTableHeaderLastSearched.Width
                            Wrap: =false
                            X: =btnVendorInvoiceRecentlySearchedInvoice.X*2+btnVendorInvoiceRecentlySearchedInvoice.Width
                            ZIndex: =2

                        btnVendorInvoiceRecentlySearchedInvoice As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =Color.Transparent
                            OnSelect: |
                                =Set(
                                    varSelectedVendorInvoiceID,
                                    ThisItem.'Object ID'
                                );
                                Select(icoVendorInvoiceSearchHeader);
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.Name
                            Tooltip: =Self.Text
                            Width: =btnVendorInvoiceRecentlySearchedTableHeaderInvoice.Width-Self.X*2
                            X: =Self.FocusedBorderThickness
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =5

                    conVendorInvoiceNoRecentlySearchedResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =250
                        Visible: |
                            =CountRows(galRecentlySearchedVendorInvoices.AllItems)=0
                        Width: =
                        ZIndex: =4

                        icoVendorInvoiceNoRecentlySearchedResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            OnSelect: =
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblVendorInvoiceNoRecentlySearchedResults.Y-lblVendorInvoiceNoRecentlySearchedResults.Height-30
                            ZIndex: =1

                        lblVendorInvoiceNoRecentlySearchedResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

            lblNumberOfRecentlySearchedVendorInvoiceRecords As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varThemeColors.primary
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Lighter
                Height: =30
                PaddingBottom: =0
                PaddingLeft: =btnVendorInvoiceSearchAllResultsTableHeaderInvoiceNumber.PaddingLeft
                Size: =10.5
                Text: |-
                    =//Show how many rows are returned in the results
                    
                    CountRows(galRecentlySearchedVendorInvoices.AllItems) & " "& //Count the rows in the gallery
                    // Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "record(s)"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Visible: =galRecentlySearchedVendorInvoices.Visible
                X: =1
                ZIndex: =7

