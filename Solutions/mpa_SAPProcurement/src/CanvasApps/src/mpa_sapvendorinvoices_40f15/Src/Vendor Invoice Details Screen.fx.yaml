"'Vendor Invoice Details Screen' As screen":
    Fill: =varThemeColors.background
    OnVisible: |-
        =//Logic is only called the first time application loads. Allows for faster app launch time.
        If(
            Or(
                IsBlank(varLoadAppFirstTime),
                varLoadAppFirstTime
            ),
            //Variable drives whether the left navigation menu component is expanded or not across screens
            Set(
                varExpandMenu,
                App.ActiveScreen.Size >= ScreenSize.Large
            );
            Set(
                varISOUserLanguageCode,//Get user's language and map to existing choice values that are supported by the 'SAP Localizations' entity which can be customized to support more languages
                Switch(
                    Left(
                        Language(),
                        2
                    ),
                    "ar",
                    'ISO Language Code'.ar,
                    "de",
                    'ISO Language Code'.de,
                    "en",
                    'ISO Language Code'.en,
                    "es",
                    'ISO Language Code'.es,
                    "fr",
                    'ISO Language Code'.fr,
                    "he",
                    'ISO Language Code'.he,
                    "it",
                    'ISO Language Code'.it,
                    "ja",
                    'ISO Language Code'.ja,
                    "ko",
                    'ISO Language Code'.ko,
                    "pt",
                    'ISO Language Code'.pt,
                    "zh",
                    'ISO Language Code'.zh,
                    'ISO Language Code'.en
                )
            );
            Concurrent(
                ClearCollect(
                    colUserLocalizedStrings,//Collection used to display localized value according to user's language value
                    Filter(
                        'SAP Localizations',
                        Language = varISOUserLanguageCode,
                        'SAP Localizations (Views)'.'Active SAP Localizations'
                    )
                ),
                Set(
                    varVendorAccess,//Variable used to allow drilling into vendor details app if user has access. Will be blank if user does not have access to the vendor menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.Vendors && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                Set(
                    varPurchaseOrderAccess,//Variable used to allow drilling into purchaseorder details app if user has access. Will be blank if user does not have access to the purchase order menu record
                    LookUp(
                        'SAP Menu Items',
                        Capability = 'Capability (SAP Menu Items)'.'Purchase Orders' && Status = 'Status (SAP Menu Items)'.Active
                    )
                ),
                //Get user's principal name from Office graph and store in variable
                Set(
                    varUserPrincipal,
                    Office365Users.MyProfileV2().userPrincipalName
                );
                //Lookup system user record in Dataverse for the user's principal name and store. Variable will be used when patching search histories
        Set(
                    varSystemUserID,
                    LookUp(
                        Users,
                        'User Name' = varUserPrincipal
                    ).User
                )
            );
            Set(
                varVendorInvoiceItemsSortByColumn,//Default vendor invoice items sort column variable
                btnVendorInvoiceItemsTableHeaderItem.Text
            );
            Set(
                varVendorInvoiceItemsSortOrder,//Default vendor invoice items sort order variable
                SortOrder.Ascending
            );
            If(
                !IsBlank(Param("invoice")),//Allows for another app to launch this app with a specific vendor invoice record in focus
                Set(
                    varSelectedVendorInvoiceID,//Global variable used to invoke ReadVendorInvoice power automate call to query specific vendor from SAP
                    Param("invoice")
                );
            );
            // Other apps such as vendors may want to launch the this app in default new record mode
        If(
                !IsBlank(Param("mode")) && Param("mode") = "new",
                Set(
                    varIsNew,
                    true
                );
                //check to see if a default purchase order was supplied on the application launch such as from create new vendor invoice from purchase order app
        If(//If purchase order is not blank, store it in varSelectedPurchaseOrderID variable
                    !IsBlank(Param("purchaseorder")),
                    Set(
                        varSelectedPurchaseOrderID,
                        Param("purchaseorder")
                    );
                );
            );
            Set(
                varLoadAppFirstTime,//All app first time loading logic is complete so set variable to false so not to execute again when navigating to screen
                false
            );
            
        );
        //End app first start logic
        //Reset controls
        Set(
            varResetSelectRows,
            true
        );
        //work around to reset gallery select row checkbox and selected row highlighted
        Set(
            varResetSelectRows,
            false
        );
        Reset(chbVendorInvoiceDetailsItemsSelectAll);
        Reset(txtVendorInvoiceDetailsItemsFilter);
        //Reset all search controls in the component
        UpdateContext({_resetCommandBar: false});
        UpdateContext({_resetCommandBar: true});
        //Collection that tracks cross screen navigation thread and allows to back out in reverse sequence, remove from "thread" if navigating back to this screen
        RemoveIf(
            colAppNavigationThreads,
            Screen = App.ActiveScreen
        );
        //Invoke logic contained in a hidden button control to query vendor invoice if varSelectedVendorInvoiceID not blank
        If(
            !IsBlank(varSelectedVendorInvoiceID),
            Select(btnVendorInvoiceSearchLogicHidden)
        );
        //Invoke logic to search purchase order if varSelectedPurchaseOrderID not blank
        If(
            !IsBlank(varSelectedPurchaseOrderID),
            Select(icoVendorInvoiceDetailsPurchaseOrderSearch)
        )

    conVendorInvoiceDetailsMain As groupContainer.verticalAutoLayoutContainer:
        Height: =Parent.Height-Self.Y
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        PaddingBottom: =20
        Width: =Parent.Width-Self.X
        X: =cmpVendorInvoiceDetailsLeftNavigation.Width
        Y: =cmpVendorInvoiceDetailsHeader.Height
        ZIndex: =1

        cmpVendorInvoiceDetailsMainCommandBar As CommandBar:
            LayoutMinHeight: =
            LayoutMinWidth: =conVendorInvoiceDetailsData.LayoutMinWidth
            ResetCommandBar: =_resetCommandBar
            Width: =

        conVendorInvoiceDetailsScreenTabs As ScreenTabs:
            LayoutMinHeight: =
            LayoutMinWidth: =conVendorInvoiceDetailsData.LayoutMinWidth
            Width: =

        shpVendorInvoiceDetailsMainDivider As rectangle:
            AccessibleLabel: |-
                =// Define a variable named "Text" with the value "{value}"
                With(
                    {
                        Text: "Divider"
                    },
                    If(
                        // If the localized text is blank, return the default text
                        IsBlank(
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        ),
                        Text,
                        // If a localized text is found, return that instead of the default text
                        LookUp(
                            colUserLocalizedStrings,
                            'English Value' = Text
                        ).'Localized Value'
                    )
                )
            Fill: =varThemeColors.secondaryGray
            Height: =1
            LayoutMinHeight: =
            LayoutMinWidth: =conVendorInvoiceDetailsData.LayoutMinWidth
            Width: =
            ZIndex: =2

        lblVendorInvoiceDetailsMainName As label:
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            BorderThickness: =2
            Color: =varThemeColors.text
            DisabledBorderColor: =RGBA(0, 0, 0, 0)
            Fill: =RGBA(255, 255, 255, 1)
            FocusedBorderColor: =varThemeColors.primary
            FocusedBorderThickness: =4
            Font: =Font.'Segoe UI'
            FontWeight: =FontWeight.Semibold
            Height: =37
            LayoutMinHeight: =
            LayoutMinWidth: =conVendorInvoiceDetailsData.LayoutMinWidth
            Live: =Live.Assertive
            PaddingBottom: =15
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =22
            Role: =TextRole.Heading1
            Size: =14.5
            Text: |-
                =// Define a variable named "Text" with the value "{value}"
                If(
                    !varIsNew && !IsBlank(varVendorInvoiceHeader),
                    Concatenate(
                        varVendorInvoiceNumber,
                        " - ",
                        varVendorInvoiceHeader.VendorName
                    ),
                    With(
                        {
                            Text: If(
                                varIsNew,
                                "New vendor invoice",
                                "Vendor invoice"
                            )
                        },
                        If(
                        // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                        // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                )
            Width: =
            Wrap: =false
            ZIndex: =3

        conVendorInvoiceDetailsData As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =20
            LayoutMinHeight: =
            LayoutMinWidth: =conVendorInvoiceDetailsItems.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            LayoutOverflowY: =LayoutOverflow.Scroll
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =20
            Width: =
            ZIndex: =5

            conVendorInvoiceDetailsFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: |-
                    =With(
                        {_defaultHeight: 64},
                        If(
                            Self.Width >= 1620,
                            2 * _defaultHeight + Self.LayoutGap,
                            3 * _defaultHeight + 2 * Self.LayoutGap
                        )
                    )
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =
                ZIndex: =1

                conVendorInvoiceDetailsPurchaseOrder As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            254,
                            Len(lblVendorInvoiceDetailsPurchaseOrder.Text) * 10
                        )
                    X: =40
                    ZIndex: =1

                    btnVendorInvoiceDetailsPurchaseOrder As button:
                        Align: =Align.Left
                        BorderColor: =RGBA(0,0,0,0)
                        BorderThickness: =0
                        Color: =varThemeColors.lookupBlue
                        DisabledBorderColor: =
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =
                        OnSelect: |-
                            =Launch(
                                varPurchaseOrderAccess.'Application URL',
                                {purchaseorder: Self.Text}
                            )
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedColor: =Self.Color
                        PressedFill: =Color.Transparent
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: =txtVendorInvoiceDetailsPurchaseOrder.Text
                        Tooltip: =Self.Text
                        Visible: |-
                            =And(
                                !varIsNew,
                                !varIsEdit,
                                !IsBlank(Self.Text),
                                !IsBlank(varPurchaseOrderAccess)
                            )
                        Width: =lblVendorInvoiceDetailsPurchaseOrder.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsPurchaseOrder.Y+lblVendorInvoiceDetailsPurchaseOrder.Height
                        ZIndex: =1

                    txtVendorInvoiceDetailsPurchaseOrder As text:
                        AccessibleLabel: |-
                            =//Check first if the vendor is confirmed/resolved
                            With(
                                {
                                    Text: If(
                                        Self.Italic,// Define a variable named "Text" with the value "{value}"
                                        "Purchase order needs to be searched and resolved first",
                                        "Enter purchase order required"
                                    )
                                },
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Color: |-
                            =Switch(
                                true,
                                IsBlank(Self.Text),
                                varThemeColors.requiredRed,
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.text
                            )
                        Default: |-
                            =Switch(
                                true,
                                And(
                                    varIsNew,
                                    IsBlank(varNewPurchaseOrderNumber)
                                ),
                                "",
                                And(
                                    !IsBlank(varNewPurchaseOrderNumber),
                                    varIsNew
                                ),
                                varNewPurchaseOrderNumber,
                                varPurchaseOrderNumber
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                varIsNew,
                                DisplayMode.Edit,
                                IsBlank(varVendorInvoiceHeader),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HintText: |-
                            =If(
                                Self.DisplayMode <> DisplayMode.Disabled,
                            // Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Enter purchase order number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        HoverBorderColor: =Self.FocusedBorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        Italic: |+
                            =Switch(true,
                                IsBlank(Self.Text),
                                false,
                                IsBlank(varNewPurchaseOrderNumber) && Self.Text = varPurchaseOrderNumber,
                                false,
                                !IsBlank(varNewPurchaseOrderNumber) && Self.Text = varNewPurchaseOrderNumber,
                                false,
                                true
                            )
                            
                        OnChange: |
                            =Set(
                                varSelectedPurchaseOrderID,
                                Trim(Self.Text)
                            );
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =//Check first if the vendor is confirmed/resolved
                            If(
                                Self.Italic,// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Vendor needs to be searched and resolved first"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                ),//Otherwise populate resolved value entered or hint text
                                Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            )
                        Visible: =!btnVendorInvoiceDetailsPurchaseOrder.Visible
                        Width: =lblVendorInvoiceDetailsPurchaseOrder.Width-icoVendorInvoiceDetailsPurchaseOrderAdvancedSearch.Width-10-Self.X
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsPurchaseOrder.Y+lblVendorInvoiceDetailsPurchaseOrder.Height
                        ZIndex: =2

                    "icoVendorInvoiceDetailsPurchaseOrderSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primaryGray
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.focusBorder
                        Height: =txtVendorInvoiceDetailsPurchaseOrder.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.ArrowRight
                        OnSelect: |-
                            =If(
                                !IsBlank(varSelectedPurchaseOrderID),
                            //Sets processing indicator control behavior 
                                Set(
                                    varIsProcessing,
                                    true
                                );
                                Set(
                                    varFooterMessage,
                                    "Loading"
                                );
                                //Remove any existing cached purchase data whether variables or collections
                            Set(
                                    varNewPurchaseOrderHeader,
                                    Blank()
                                );
                                Set(
                                    varNewPurchaseOrderNumber,//Variable that stores the returned purchase order number
                                    Blank()
                                );
                                Clear(colVendorInvoiceItems);
                                
                            //Call ReadPurchaseOrder Power Automate to read the purchase order from SAP
                            ClearCollect(
                                    colReadPurchaseOrderResponseTemp,//collection that temporarily stores the purchase order response data
                                    ReadPurchaseOrder.Run(varSelectedPurchaseOrderID)
                                );
                                
                            //Evalute response conditions
                            Switch(
                                    true,
                                    And(//Check to see if read purchase order call was successful and process happy path logic
                                        First(colReadPurchaseOrderResponseTemp).Status = "Success",
                                        !IsBlank(First(colReadPurchaseOrderResponseTemp).OrderNumber)
                                    ),
                                    Set(
                                        varNewPurchaseOrderHeader,//Variable that stores the returned main purchase order data
                                        First(colReadPurchaseOrderResponseTemp).Header
                                    );
                                    Set(
                                        varNewPurchaseOrderNumber,//Variable that stores the returned purchase order number
                                        First(colReadPurchaseOrderResponseTemp).OrderNumber
                                    );
                                    UpdateIf(
                                        ClearCollect(
                                            colVendorInvoiceItems,//Collection that caches associated vendor invoice items defaulted from the purchase order items
                                            First(colReadPurchaseOrderResponseTemp).Items
                                        ),
                                        true,
                                        {
                                            //Default all to create vendor invoice items with header purchase order and mapped purchase order item number
                                            CrudType: "C",
                                            PurchaseOrderNumber: varNewPurchaseOrderNumber,
                                            PurchaseOrderItemNumber: ItemNumber
                                        }
                                    );
                                    DropColumns(
                                        colVendorInvoiceItems,
                                        "UnitPrice",
                                        "PurchaseRequisitionNumber"
                                    );
                                    //Warn if there are already invoices on this purchase order and delete the quantities and amounts in the collection
                            If(
                                        Or(
                                            !IsEmpty(First(colReadPurchaseOrderResponseTemp).Invoices),
                                            !IsEmpty(First(colReadPurchaseOrderResponseTemp).ParkedInvoices)
                                        ),
                                        Notify(
                                            With(
                                                {Text: "Purchase order has one or more invoices associated already"},
                                                If(
                                    // If the localized text is blank, return the default text
                                                    IsBlank(
                                                        LookUp(
                                                            colUserLocalizedStrings,
                                                            'English Value' = Text
                                                        ).'Localized Value'
                                                    ),
                                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                )
                                            ),
                                            NotificationType.Warning,
                                            7000
                                        );
                                        UpdateIf(
                                            colVendorInvoiceItems,
                                            true,
                                            {
                                                Quantity: Blank(),
                                                TotalPrice: Blank()
                                            }
                                        )
                                    );
                                    Patch(
                                        'SAP Search Histories',
                                        Coalesce(
                                            LookUp(
                                                'SAP Search Histories',
                                                And(
                                                    'Object ID' = varNewPurchaseOrderNumber,
                                                    'Object Type' = 'Object Type (SAP Search Histories)'.'Purchase Order',
                                                    'Created By'.User = varSystemUserID
                                                )
                                            ),
                                            Defaults('SAP Search Histories')
                                        ),
                                        {
                                            'Object ID': varNewPurchaseOrderNumber,
                                            'Object Type': 'Object Type (SAP Search Histories)'.'Purchase Order',
                                            Name: Concatenate(
                                                varNewPurchaseOrderNumber,
                                                " - ",
                                                varNewPurchaseOrderHeader.VendorName
                                            ),
                                            'Last Searched On': Now()
                                        }
                                    );
                                    //Check if the patch function was successful and notify if there was any errors.
                            If(
                                        !IsEmpty(Errors('SAP Search Histories')),
                                        Notify(
                                            First(Errors('SAP Search Histories')).Message,
                                            NotificationType.Error,
                                            0
                                        ),
                                        Refresh('SAP Search Histories')
                                    );
                                    ,//End if ReadVendor Power Automate call was success
                                    First(colReadPurchaseOrderResponseTemp).Status = "Error",//Error response returned
                                    Notify(
                                        Concat(
                                            First(colReadPurchaseOrderResponseTemp).Messages,
                                            Message,
                                            " "
                                        ),
                                        NotificationType.Error,
                                        0
                                    ),
                                    And(//Check to see if call was successful, but no purchase order was found
                                        First(colReadPurchaseOrderResponseTemp).Status = "Information",
                                        IsBlank(First(colReadPurchaseOrderResponseTemp).OrderNumber)
                                    ),
                                    Notify(
                                        With(
                                            {Text: "Purchase order not found"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Information,
                                        7000
                                    ),//Default response for an unhandled error return
                                    Notify(
                                        With(
                                            {Text: "Unexpected error occurred"},
                                            If(
                                    // If the localized text is blank, return the default text
                                                IsBlank(
                                                    LookUp(
                                                        colUserLocalizedStrings,
                                                        'English Value' = Text
                                                    ).'Localized Value'
                                                ),
                                                Text,
                                    // If a localized text is found, return that instead of the default text
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            )
                                        ),
                                        NotificationType.Error,
                                        0
                                    )
                                );
                                
                            //End purchase order response switch statement
                            //done with read purchase order temp collections, clear cache
                            Clear(colReadPurchaseOrderResponseTemp);
                                Set(
                                    varSelectedPurchaseOrderID,
                                    Blank()
                                );
                                Set(
                                    varIsProcessing,//done processing read vendor, set variable back to false stopping any processing control behavior
                                    false
                                );
                                Set(
                                    varFooterMessage,
                                    ""
                                );
                                
                            )
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =With(
                                {Text: "Execute vendor search"},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =!IsBlank(txtVendorInvoiceDetailsPurchaseOrder.Text) && varIsNew
                        Width: =Self.Height
                        X: =txtVendorInvoiceDetailsPurchaseOrder.X+txtVendorInvoiceDetailsPurchaseOrder.Width-Self.Width
                        Y: =txtVendorInvoiceDetailsPurchaseOrder.Y
                        ZIndex: =3

                    "icoVendorInvoiceDetailsPurchaseOrderAdvancedSearch As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.focusBorder
                        Height: =txtVendorInvoiceDetailsPurchaseOrder.Height
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.FilterFlat
                        OnSelect: |-
                            =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                            Collect(
                                colAppNavigationThreads,
                                Table(
                                    {
                                        Screen: App.ActiveScreen,
                                        Order: CountRows(colAppNavigationThreads) + 1
                                    }
                                )
                            );
                            //Navigate to the requisition search screen resetting all the seach controls (workaround)
                            Set(
                                varResetPurchaseOrdersSearch,
                                true
                            );
                            //sets global variable so the component knows which screen to navigate back to
                            Navigate(
                                'Purchase Order Search Screen',
                                ScreenTransition.Cover
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor advanced search"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =varIsNew
                        Width: =Self.Height
                        X: =btnVendorInvoiceDetailsPurchaseOrder.Width-Self.Width
                        Y: =txtVendorInvoiceDetailsPurchaseOrder.Y
                        ZIndex: =4

                    lblVendorInvoiceDetailsPurchaseOrder As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchase order"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )& " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conVendorInvoiceDetailsDocumentType As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =225 
                    X: =40
                    ZIndex: =2

                    cmbVendorInvoiceDetailsDocumentType As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of vendor invoice
                            Filter(
                                'SAP List of Values',
                                Domain = 'Domain (SAP List of Values)'.'Document Type',
                                Language = varISOUserLanguageCode,
                                'Value Code' = If(
                                    varIsNew,
                                    "RE",//Default to invoice if new
                                    varVendorInvoiceHeader.Type
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varVendorInvoiceHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                Self.BorderColor = varThemeColors.requiredRed,
                                Self.BorderColor,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =Self.FocusedBorderColor
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Document Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Document Type',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsDocumentType.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                // Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select purchasing group"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                            )
                        Width: =lblVendorInvoiceDetailsDocumentType.Width
                        X: =lblVendorInvoiceDetailsDocumentType.X
                        Y: =lblVendorInvoiceDetailsDocumentType.Y+lblVendorInvoiceDetailsDocumentType.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsDocumentType As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Document type"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsPostingDate As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            160,
                            Len(dteVendorInvoiceDetailsPostingDate.InputTextPlaceholder) * 10
                        )
                    ZIndex: =3

                    dteVendorInvoiceDetailsPostingDate As datepicker:
                        AccessibleLabel: |
                            =    With(
                                    {Text: "Select due date required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: |-
                            =Switch(
                                true,
                                varIsNew,
                                Today(),
                                varVendorInvoiceHeader.PostingDate
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varVendorInvoiceHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: |-
                            =If(
                                Self.DisplayMode <> DisplayMode.Disabled,
                                With(
                                    {Text: "Select posting date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        OnChange: |-
                            =Set(
                                varVendorInvoicePostingDate, // Work around to make value accessible within components
                                Self.SelectedDate
                            )
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsPostingDate.Height+lblVendorInvoiceDetailsPostingDate.Y
                        ZIndex: =1

                    lblVendorInvoiceDetailsPostingDate As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Posting date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & " *"
                        Width: =Parent.Width
                        X: =dteVendorInvoiceDetailsPostingDate.X
                        ZIndex: =2

                conVendorInvoiceDetailsPaymentMethod As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(cmbVendorInvoiceDetailsPaymentMethod.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =4

                    cmbVendorInvoiceDetailsPaymentMethod As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select payment method required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.Selected.'Display Value'),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of vendor invoice
                            If(
                                varIsNew,
                                Blank(),
                                Filter(
                                    'SAP List of Values',
                                    Domain = 'Domain (SAP List of Values)'.'Payment Methods',
                                    Language = varISOUserLanguageCode,
                                    'Value Code' = varVendorInvoiceHeader.PaymentMethod
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                varIsProcessing,
                                DisplayMode.Disabled,
                                And(
                                    !varIsNew,
                                    !varIsEdit,
                                    !IsBlank(varVendorInvoiceHeader)
                                ),
                                DisplayMode.View,
                                Or(
                                    varIsNew,
                                    varIsEdit
                                ),
                                DisplayMode.Edit,
                                DisplayMode.Disabled
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select payment method"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Payment Methods',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Select payment method"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Payment Methods',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsPaymentMethod.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblVendorInvoiceDetailsPaymentMethod.Width
                        X: =lblVendorInvoiceDetailsPaymentMethod.X
                        Y: =lblVendorInvoiceDetailsPaymentMethod.Y+lblVendorInvoiceDetailsPaymentMethod.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsPaymentMethod As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Payment method"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )& " *"
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsVendor As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            180,
                            Len(lblVendorInvoiceDetailsVendor.Text) * 10
                        )
                    X: =40
                    ZIndex: =5

                    btnVendorInvoiceDetailsVendor As button:
                        Align: =Align.Left
                        BorderColor: =RGBA(0,0,0,0)
                        BorderThickness: =0
                        Color: =varThemeColors.lookupBlue
                        DisabledBorderColor: =
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Normal
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =
                        OnSelect: |-
                            =Launch(
                                varVendorAccess.'Application URL',
                                {vendor: Self.Text}
                            )
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedColor: =Self.Color
                        PressedFill: =Color.Transparent
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Size: =10.5
                        Text: |-
                            =If(
                                Or(
                                    IsBlank(varVendorInvoiceHeader),
                                    varIsNew
                                ),
                                "",
                                varVendorInvoiceHeader.Vendor
                            )
                        Tooltip: =Self.Text
                        Visible: |-
                            =And(
                                !varIsNew,
                                !varIsEdit,
                                !IsBlank(Self.Text),
                                !IsBlank(varVendorAccess)
                            )
                        Width: =lblVendorInvoiceDetailsVendor.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsVendor.Y+lblVendorInvoiceDetailsVendor.Height
                        ZIndex: =1

                    txtVendorInvoiceDetailsVendor As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =Self.Color
                        BorderThickness: =1
                        Color: =varThemeColors.text
                        Default: |-
                            =Switch(
                                true,
                                    And(
                                        IsBlank(varNewPurchaseOrderHeader),
                                        varIsNew
                                    )
                                ,
                                "",
                                And(
                                    !IsBlank(varNewPurchaseOrderHeader),
                                    varIsNew
                                ),
                                varNewPurchaseOrderHeader.Vendor,
                                varVendorInvoiceHeader.Vendor
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =//Check first if the vendor is confirmed/resolved
                            If(
                                Self.Italic,// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Vendor needs to be searched and resolved first"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                ),//Otherwise populate resolved value entered or hint text
                                Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            )
                        Visible: =!btnVendorInvoiceDetailsVendor.Visible
                        Width: =lblVendorInvoiceDetailsVendor.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsVendor.Y+lblVendorInvoiceDetailsVendor.Height
                        ZIndex: =2

                    lblVendorInvoiceDetailsVendor As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conVendorInvoiceDetailsVendorName As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            312,
                            Len(txtVendorInvoiceDetailsVendorName.HintText) * 10
                        )
                    X: =40
                    ZIndex: =6

                    txtVendorInvoiceDetailsVendorName As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor name"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =Switch(
                                true,
                                And(
                                    IsBlank(varNewPurchaseOrderHeader),
                                    varIsNew
                                ),
                                "",
                                And(
                                    !IsBlank(varNewPurchaseOrderHeader),
                                    varIsNew
                                ),
                                varNewPurchaseOrderHeader.VendorName,
                                varVendorInvoiceHeader.VendorName
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblVendorInvoiceDetailsVendorName.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsVendorName.Y+lblVendorInvoiceDetailsVendorName.Height
                        ZIndex: =2

                    lblVendorInvoiceDetailsVendorName As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor name"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conVendorInvoiceDetailsTotal As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            144,
                            Len(txtVendorInvoiceDetailsTotal.HintText) * 10
                        )
                    X: =40
                    ZIndex: =7

                    txtVendorInvoiceDetailsTotal As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Total"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =Text(
                                If(
                                    !IsEmpty(colVendorInvoiceItems),
                                    Sum(
                                        Filter(
                                            colVendorInvoiceItems,
                                            CrudType <> "D"
                                        ),
                                        TotalPrice
                                    ),
                                    0
                                ),
                                "[$-en-US]#,##0.00"
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblVendorInvoiceDetailsTotal.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsTotal.Y+lblVendorInvoiceDetailsTotal.Height
                        ZIndex: =2

                    lblVendorInvoiceDetailsTotal As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Total"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(//Add currency code value onto string if items are present
                                !IsBlank(cmbVendorInvoiceDetailsCurrency.Selected.'Value Code'),
                                " (" & cmbVendorInvoiceDetailsCurrency.Selected.'Value Code' & ")"
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conVendorInvoiceDetailsCurrency As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: =175
                    X: =40
                    ZIndex: =8

                    cmbVendorInvoiceDetailsCurrency As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =//Defualt value blank if new vendor, otherwise, value of vendor invoice
                            Filter(
                                'SAP List of Values',
                                Domain = 'Domain (SAP List of Values)'.Currency,
                                Language = varISOUserLanguageCode,
                                'Value Code' = If(
                                    varIsNew,
                                    varNewPurchaseOrderHeader.Currency,
                                    varVendorInvoiceHeader.Currency
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =Switch(
                                true,
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                varIsEdit,
                                DisplayMode.View,
                                varIsNew,
                                DisplayMode.Edit,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.Currency,
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsCurrency.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblVendorInvoiceDetailsCurrency.Width
                        X: =lblVendorInvoiceDetailsCurrency.X
                        Y: =lblVendorInvoiceDetailsCurrency.Y+lblVendorInvoiceDetailsCurrency.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsCurrency As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Currency"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsDueDate As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =!varIsNew
                    Width: |-
                        =Max(
                            160,
                            Len(dteVendorInvoiceDetailsDueDate.InputTextPlaceholder) * 10
                        )
                    ZIndex: =9

                    dteVendorInvoiceDetailsDueDate As datepicker:
                        AccessibleLabel: |
                            =    With(
                                    {Text: "Due date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                        BorderColor: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: =If(varIsNew,"",varVendorInvoiceHeader.DueDate)
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: =
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsDueDate.Height+lblVendorInvoiceDetailsDueDate.Y
                        ZIndex: =1

                    lblVendorInvoiceDetailsDueDate As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Due date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width
                        X: =dteVendorInvoiceDetailsDueDate.X
                        ZIndex: =2

                conVendorInvoiceDetailsCompanyCode As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(cmbVendorInvoiceDetailsCompanyCode.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =10

                    cmbVendorInvoiceDetailsCompanyCode As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =Filter(
                                'SAP List of Values',
                                Domain = 'Domain (SAP List of Values)'.'Company Code',
                                Language = varISOUserLanguageCode,
                                'Value Code' = If(
                                    varIsNew,
                                    varNewPurchaseOrderHeader.CompanyCode,
                                    varVendorInvoiceHeader.CompanyCode
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Company Code',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Company Code',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsCompanyCode.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblVendorInvoiceDetailsCompanyCode.Width
                        X: =lblVendorInvoiceDetailsCompanyCode.X
                        Y: =lblVendorInvoiceDetailsCompanyCode.Y+lblVendorInvoiceDetailsCompanyCode.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsCompanyCode As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Company code"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsPaymentTerms As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: |-
                        =And(
                            !IsBlank(varVendorInvoiceNumber),
                            !varIsEdit,
                            !varIsNew,
                            IsBlank(varVendorInvoiceHeader.ReversalDocument),//Populated if the document has already been reversed
                            varVendorInvoiceHeader.InvoiceDocumentStatus in Table(//Various Parked status's
                                {Status: "A"},
                                {Status: "B"},
                                {Status: "C"},
                                {Status: "D"}
                            ).Status
                        )
                    Width: |-
                        =Max(
                            224,
                            Len(cmbVendorInvoiceDetailsPaymentTerms.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =11

                    cmbVendorInvoiceDetailsPaymentTerms As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Payment terms"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =Filter(
                                'SAP List of Values',
                                Domain = 'Domain (SAP List of Values)'.'Payment Terms',
                                Language = varISOUserLanguageCode,
                                'Value Code' = If(
                                    varIsNew,
                                    varNewPurchaseOrderHeader.PaymentTerms,
                                    varVendorInvoiceHeader.PaymentTerms
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Payment Terms',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Payment Terms',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsPaymentTerms.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblVendorInvoiceDetailsPaymentTerms.Width
                        X: =lblVendorInvoiceDetailsPaymentTerms.X
                        Y: =lblVendorInvoiceDetailsPaymentTerms.Y+lblVendorInvoiceDetailsPaymentTerms.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsPaymentTerms As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Payment terms"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsFiscalYear As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =!varIsNew
                    Width: |-
                        =Max(
                            144,
                            Len(txtVendorInvoiceDetailsFiscalYear.HintText) * 10
                        )
                    X: =40
                    ZIndex: =12

                    txtVendorInvoiceDetailsFiscalYear As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Fiscal year"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                varVendorInvoiceHeader.FiscalYear
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lbVendorInvoiceDetailsFiscalYear.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lbVendorInvoiceDetailsFiscalYear.Y+lbVendorInvoiceDetailsFiscalYear.Height
                        ZIndex: =2

                    lbVendorInvoiceDetailsFiscalYear As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Fiscal year"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conVendorInvoiceDetailsCreatedOn As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =!varIsNew
                    Width: |-
                        =Max(
                            144,
                            Len(txtVendorInvoiceDetailsCreatedOn.HintText) * 10
                        )
                    X: =40
                    ZIndex: =13

                    txtVendorInvoiceDetailsCreatedOn As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Created on"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                Text(
                                    DateValue(
                                        varVendorInvoiceHeader.CreatedOn,
                                        "en-US"
                                    ),
                                    DateTimeFormat.ShortDate
                                )
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblVendorInvoiceDetailsCreatedOn.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsCreatedOn.Y+lblVendorInvoiceDetailsCreatedOn.Height
                        ZIndex: =2

                    lblVendorInvoiceDetailsCreatedOn As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Created on"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conVendorInvoiceDetailsInvoiceStatus As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =!varIsNew
                    Width: |-
                        =Max(
                            200,
                            Len(cmbVendorInvoiceDetailsInvoiceStatus.AccessibleLabel) * 9
                        )
                    X: =40
                    ZIndex: =14

                    cmbVendorInvoiceDetailsInvoiceStatus As combobox:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Document status"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        ChevronBackground: =varThemeColors.backgroundFill
                        ChevronDisabledBackground: =varThemeColors.backgroundFillDisabled
                        ChevronDisabledFill: |
                            =varThemeColors.text
                        ChevronFill: =varThemeColors.text
                        ChevronHoverBackground: =varThemeColors.secondaryGray
                        ChevronHoverFill: |
                            =varThemeColors.text
                        Color: =varThemeColors.text
                        DefaultSelectedItems: |-
                            =Filter(
                                'SAP List of Values',
                                Domain = 'Domain (SAP List of Values)'.'Invoice Document Status',
                                Language = varISOUserLanguageCode,
                                'Value Code' = varVendorInvoiceHeader.InvoiceDocumentStatus
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayFields: =["mpa_value","mpa_valuecode"]
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.secondaryGray
                        InputTextPlaceholder: =
                        Items: |-
                            =//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Invoice Document Status',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            )
                        NoSelectionText: =
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.altText
                        PressedFill: =varThemeColors.backgroundFill
                        SearchFields: =["mpa_value","mpa_valuecode"]
                        SearchItems: |-
                            =Search(//Filter possible list of values according to mapped domain and language field
                            Sort(
                                Filter(
                                    'SAP List of Values',
                                    Status = 'Status (SAP List of Values)'.Active,
                                    Domain = 'Domain (SAP List of Values)'.'Invoice Document Status',
                                    Language = varISOUserLanguageCode
                                ),
                                'Display Value'
                            ),cmbVendorInvoiceDetailsInvoiceStatus.SearchText,"mpa_value","mpa_valuecode")
                        SelectionColor: =varThemeColors.altText
                        SelectionFill: =varThemeColors.primaryGray
                        SelectionTagColor: =varThemeColors.text
                        SelectionTagFill: =varThemeColors.backgroundFill
                        SelectMultiple: =false
                        Size: =10.5
                        Template: =ListItemTemplate.Double
                        Tooltip: |-
                            =Coalesce(
                                Self.Selected.'Display Value',
                                Self.AccessibleLabel
                            )
                        Width: =lblVendorInvoiceDetailsInvoiceStatus.Width
                        X: =lblVendorInvoiceDetailsInvoiceStatus.X
                        Y: =lblVendorInvoiceDetailsInvoiceStatus.Y+lblVendorInvoiceDetailsInvoiceStatus.Height
                        ZIndex: =1

                    lblVendorInvoiceDetailsInvoiceStatus As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Document status"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =2

                conVendorInvoiceDetailsReversalDocument As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Visible: =And(!varIsNew,!IsBlank(varVendorInvoiceHeader.ReversalDocument))
                    Width: |-
                        =Max(
                            144,
                            Len(txtVendorInvoiceDetailsReversalDocument.HintText) * 10
                        )
                    X: =40
                    ZIndex: =16

                    txtVendorInvoiceDetailsReversalDocument As text:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Reversal document"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: |-
                            =If(
                                varIsNew,
                                "",
                                varVendorInvoiceHeader.ReversalDocument
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                Or(
                                    varIsProcessing,
                                    And(
                                        IsBlank(varVendorInvoiceHeader),
                                        !varIsNew
                                    )
                                ),
                                DisplayMode.Disabled,
                                DisplayMode.View
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblVendorInvoiceDetailsReversalDocument.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblVendorInvoiceDetailsReversalDocument.Y+lblVendorInvoiceDetailsReversalDocument.Height
                        ZIndex: =2

                    lblVendorInvoiceDetailsReversalDocument As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Reversal document"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

            conVendorInvoiceDetailsItems As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conVendorInvoiceItemsTable.LayoutMinHeight + shpVendorInvoiceDetailItemsDivider.Height + conVendorInvoiceDetailsItemsCommandBar.Height + lblVendorInvoiceItemsNumberOfFoundRecords.Height
                LayoutMinWidth: =conVendorInvoiceItemsTable.LayoutMinWidth+Self.PaddingLeft+Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =3

                conVendorInvoiceDetailsItemsCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =39
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =10
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    conVendorInvoiceDetailsItemsCommandBarLeft As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Height: =Parent.Height
                        LayoutMinHeight: =0
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        ZIndex: =1

                        lblVendorInvoiceDetailsItems As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingRight: =0
                            PaddingTop: =0
                            Role: =TextRole.Heading2
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )&" *"
                            Width: =Len(Self.Text)*7
                            ZIndex: =1

                        conVendorInvoiceDetailsItemsDeleteButton As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            FillPortions: =0
                            Height: =Parent.Height
                            LayoutMinHeight: =
                            LayoutMinWidth: =250
                            Visible: |-
                                =//Make the button visible only if the following conditions are true
                                And(
                                    Or(//if a record is being created or updated
                                        varIsEdit,
                                        varIsNew
                                    ),
                                    !IsEmpty(//if one or more rows is selected
                                        Filter(
                                            galVendorInvoiceItems.AllItems,
                                            chbVendorInvoiceDetailsItemSelectRow.Value
                                        )
                                    )
                                )
                            Width: =Len(btnVendorInvoiceDetailsItemsDeleteButton.Text)*10+btnVendorInvoiceDetailsItemsDeleteButton.PaddingLeft
                            ZIndex: =4

                            icoVendorInvoiceDetailsItemsDeleteButton As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Delete"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.primary
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceDetailsItemsDeleteButton.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =16
                                Icon: =Icon.Cancel
                                Width: =16
                                X: =5
                                Y: =btnVendorInvoiceDetailsItemsDeleteButton.Y+btnVendorInvoiceDetailsItemsDeleteButton.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceDetailsItemsDeleteButton As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =0
                                Color: =varThemeColors.text
                                DisabledBorderColor: =
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =
                                DisplayMode: |-
                                    =If(
                                        varIsProcessing,
                                        DisplayMode.Disabled,
                                        DisplayMode.Edit
                                    )
                                Fill: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                FontWeight: =FontWeight.Normal
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =Color.Transparent
                                OnSelect: |-
                                    =RemoveIf(
                                        colVendorInvoiceItems,
                                        And(
                                            ItemNumber in Filter(
                                                galVendorInvoiceItems.AllItems,
                                                chbVendorInvoiceDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType = "C"
                                        )
                                    );
                                    UpdateIf(
                                        colVendorInvoiceItems,
                                        And(
                                            ItemNumber in Filter(
                                                galVendorInvoiceItems.AllItems,
                                                chbVendorInvoiceDetailsItemSelectRow.Value = true
                                            ).ItemNumber,
                                            CrudType <> "C"
                                        ),
                                        {CrudType: "D"}
                                    );
                                    Reset(chbVendorInvoiceDetailsItemsSelectAll);
                                    //work around to reset gallery select row checkbox and selected row highlighted
                                    Set(
                                        varResetSelectRows,
                                        true
                                    );
                                    Set(
                                        varResetSelectRows,
                                        false
                                    );
                                PaddingLeft: =icoVendorInvoiceDetailsItemsDeleteButton.X+icoVendorInvoiceDetailsItemsDeleteButton.Width+8
                                PressedColor: =Color.Black
                                PressedFill: =Color.Transparent
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =With(
                                        {Text: "Delete"},
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    conVendorInvoiceDetailsItemsFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Visible: =galVendorInvoiceItems.Visible
                        Width: =txtVendorInvoiceDetailsItemsFilter.X+txtVendorInvoiceDetailsItemsFilter.Width+txtVendorInvoiceDetailsItemsFilter.FocusedBorderThickness
                        ZIndex: =3

                        txtVendorInvoiceDetailsItemsFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(
                                        IsEmpty(colVendorInvoiceItems),
                                        varIsProcessing
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =If(
                                    Self.DisplayMode <> DisplayMode.Disabled,
                                // Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Filter items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                        // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                        // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpVendorInvoiceDetailsItemsFilterDivider.X+shpVendorInvoiceDetailsItemsFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpVendorInvoiceDetailsItemsFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpVendorInvoiceDetailItemsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    Width: =
                    ZIndex: =3

                conVendorInvoiceItemsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =100
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conVendorInvoiceItemsTableHeader.Height + shpVendorInvoiceItemsTableDivider.Height + If(
                            galVendorInvoiceItems.Visible,
                            galVendorInvoiceItems.LayoutMinHeight,
                            cmpVendorInvoiceOrderItemsDisplay.Height
                        ) + Self.PaddingTop + Self.PaddingBottom
                    LayoutMinWidth: =conVendorInvoiceItemsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =
                    ZIndex: =4

                    conVendorInvoiceItemsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =chbVendorInvoiceDetailsItemsSelectAll.Width + conVendorInvoiceItemsTableHeaderItem.LayoutMinWidth + conVendorInvoiceItemsTableHeaderLocation.LayoutMinWidth + conVendorInvoiceItemsTableHeaderMaterialNumber.LayoutMinWidth + conVendorInvoiceItemsTableHeaderMaterialDescription.LayoutMinWidth + conVendorInvoiceItemsTableHeaderMaterialQuantity.LayoutMinWidth + conVendorInvoiceItemsTableHeaderUnit.LayoutMinWidth + conVendorInvoiceItemsTableHeaderTotal.LayoutMinWidth + conVendorInvoiceItemsTableHeaderPurchaseOrder.LayoutMinWidth + conVendorInvoiceItemsTableHeaderPurchaseOrderItem.Width + 200
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =2
                        Width: =
                        ZIndex: =1

                        chbVendorInvoiceDetailsItemsSelectAll As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =varThemeColors.text
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: |-
                                =If(
                                    And(
                                        CountRows(
                                            Filter(
                                                colVendorInvoiceItems,
                                                CrudType <> "D"
                                            )
                                        ) > 0,
                                        Or(
                                            varIsNew,
                                            varIsEdit
                                        ),
                                        !varIsProcessing
                                    ),
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            FocusedBorderColor: =varThemeColors.focusBorder
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =Parent.Height-Self.FocusedBorderThickness*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            LayoutMinWidth: =75
                            OnCheck: =Set(varResetSelectRows, Self.Value)
                            OnUncheck: =Set(varResetSelectRows, Self.Value)
                            PressedColor: =Self.Color
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Select"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =Len(Self.Text) * 10 + Self.CheckboxSize
                            ZIndex: =1

                        conVendorInvoiceItemsTableHeaderItem As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderItem.X+icoVendorInvoiceItemsTableHeaderItem.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =2

                            icoVendorInvoiceItemsTableHeaderItem As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderItem.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn=btnVendorInvoiceItemsTableHeaderItem.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderItem.Text)*10+8
                                Y: =btnVendorInvoiceItemsTableHeaderItem.Y+btnVendorInvoiceItemsTableHeaderItem.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderItem As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Item"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderLocation As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderLocation.X+icoVendorInvoiceItemsTableHeaderLocation.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =3

                            icoVendorInvoiceItemsTableHeaderLocation As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderLocation.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn=btnVendorInvoiceItemsTableHeaderLocation.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderLocation.Text)*8.5+8
                                Y: =btnVendorInvoiceItemsTableHeaderLocation.Y+btnVendorInvoiceItemsTableHeaderLocation.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderLocation As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Location"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderMaterialNumber As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderMaterialNumber.X+icoVendorInvoiceItemsTableHeaderMaterialNumber.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =4

                            icoVendorInvoiceItemsTableHeaderMaterialNumber As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderMaterialNumber.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderMaterialNumber.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderMaterialNumber.Text)*8+8
                                Y: =btnVendorInvoiceItemsTableHeaderMaterialNumber.Y+btnVendorInvoiceItemsTableHeaderMaterialNumber.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderMaterialNumber As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Material"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderMaterialDescription As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =3
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderMaterialDescription.X+icoVendorInvoiceItemsTableHeaderMaterialDescription.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =5

                            icoVendorInvoiceItemsTableHeaderMaterialDescription As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderMaterialDescription.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderMaterialDescription.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderMaterialDescription.Text)*7.5+8
                                Y: =btnVendorInvoiceItemsTableHeaderMaterialDescription.Y+btnVendorInvoiceItemsTableHeaderMaterialDescription.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderMaterialDescription As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Description"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderMaterialQuantity As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderMaterialQuantity.X+icoVendorInvoiceItemsTableHeaderMaterialQuantity.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =6

                            icoVendorInvoiceItemsTableHeaderMaterialQuantity As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderQuantity.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderQuantity.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderQuantity.Text)*8+8
                                Y: =btnVendorInvoiceItemsTableHeaderQuantity.Y+btnVendorInvoiceItemsTableHeaderQuantity.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderQuantity As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Quantity"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderUnit As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderUnit.X+icoVendorInvoiceItemsTableHeaderUnit.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =7

                            icoVendorInvoiceItemsTableHeaderUnit As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderUnit.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderUnit.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderUnit.Text)*9.5+8
                                Y: =btnVendorInvoiceItemsTableHeaderUnit.Y+btnVendorInvoiceItemsTableHeaderUnit.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderUnit As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Unit"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderTotal As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderTotal.X+icoVendorInvoiceItemsTableHeaderTotal.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =9

                            icoVendorInvoiceItemsTableHeaderTotal As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderTotal.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderTotal.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderTotal.Text)*7+8
                                Y: =btnVendorInvoiceItemsTableHeaderTotal.Y+btnVendorInvoiceItemsTableHeaderTotal.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderTotal As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Total"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )& If(//Add currency code value onto string if items are present
                                        !IsBlank(cmbVendorInvoiceDetailsCurrency.Selected.'Value Code'),
                                        " (" & cmbVendorInvoiceDetailsCurrency.Selected.'Value Code' & ")"
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderPurchaseOrder As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderPurchaseOrder.X+icoVendorInvoiceItemsTableHeaderPurchaseOrder.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =10

                            icoVendorInvoiceItemsTableHeaderPurchaseOrder As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderPurchaseOrder.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderPurchaseOrder.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderPurchaseOrder.Text)*7.5+8
                                Y: =btnVendorInvoiceItemsTableHeaderPurchaseOrder.Y+btnVendorInvoiceItemsTableHeaderPurchaseOrder.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderPurchaseOrder As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchase order"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conVendorInvoiceItemsTableHeaderPurchaseOrderItem As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoVendorInvoiceItemsTableHeaderPurchaseOrderItem.X+icoVendorInvoiceItemsTableHeaderPurchaseOrderItem.Width+10
                            Width: =
                            Y: =37
                            ZIndex: =11

                            icoVendorInvoiceItemsTableHeaderPurchaseOrderItem As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varVendorInvoiceItemsSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varVendorInvoiceItemsSortByColumn = btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.Text && galVendorInvoiceItems.Visible
                                Width: =12
                                X: =Len(btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.Text)*7.5+8
                                Y: =btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.Y+btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.Height/2-Self.Height/2
                                ZIndex: =1

                            btnVendorInvoiceItemsTableHeaderPurchaseOrderItem As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varVendorInvoiceItemsSortOrder = SortOrder.Ascending,varVendorInvoiceItemsSortByColumn=Self.Text),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varVendorInvoiceItemsSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varVendorInvoiceItemsSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galVendorInvoiceItems)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =10
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchase order item"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        lblVendorInvoiceItemsTableHeaderDetails As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            DisplayMode: |-
                                =If(
                                    And(galVendorInvoiceItems.Visible,!varIsProcessing),
                                    DisplayMode.Edit,
                                    DisplayMode.View
                                )
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =43
                            LayoutMinWidth: =75
                            PaddingBottom: =0
                            PaddingLeft: =2
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Details"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =Len(Self.Text) * 16
                            Wrap: =false
                            X: =conVendorInvoiceItemsTableHeaderItem.X
                            ZIndex: =12

                    shpVendorInvoiceItemsTableDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =
                        ZIndex: =2

                    galVendorInvoiceItems As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: |-
                            =CountRows(
                                Filter(
                                    colVendorInvoiceItems,
                                    CrudType <> "D"
                                )
                            ) * Self.TemplateHeight
                        ItemAccessibleLabel: =ThisItem.Description
                        Items: |-
                            =With(
                                {
                                    itemsList: AddColumns(
                                        Filter(
                                            If(
                                                IsBlank(txtVendorInvoiceDetailsItemsFilter.Text),
                                                colVendorInvoiceItems,
                                                Search(
                                                    colVendorInvoiceItems,
                                                    txtVendorInvoiceDetailsItemsFilter.Text,
                                                    "Description",
                                                    "Location",
                                                    "MaterialNumber",
                                                    "UnitOfMeasure",
                                                    "PurchaseOrderItemNumber",
                                                    "PurchaseOrderNumber"
                                                )
                                            ),
                                            CrudType <> "D"
                                        ),
                                        "_ItemSort",
                                        Value(ItemNumber)
                                    )
                                },
                                SortByColumns(
                                    itemsList,
                                    Switch(
                                        varVendorInvoiceItemsSortByColumn,
                                        btnVendorInvoiceItemsTableHeaderItem.Text,
                                        "_ItemSort",
                                        btnVendorInvoiceItemsTableHeaderLocation.Text,
                                        "Location",
                                        btnVendorInvoiceItemsTableHeaderMaterialNumber.Text,
                                        "MaterialNumber",
                                        btnVendorInvoiceItemsTableHeaderMaterialDescription.Text,
                                        "Description",
                                        btnVendorInvoiceItemsTableHeaderUnit.Text,
                                        "UnitOfMeasure",
                                        btnVendorInvoiceItemsTableHeaderQuantity.Text,
                                        "Quantity",
                                        btnVendorInvoiceItemsTableHeaderTotal.Text,
                                        "TotalPrice",
                                        btnVendorInvoiceItemsTableHeaderPurchaseOrderItem.Text,
                                        "PurchaseOrderItemNumber",
                                        btnVendorInvoiceItemsTableHeaderPurchaseOrder.Text,
                                        "PurchaseOrderNumber"
                                    ),
                                    varVendorInvoiceItemsSortOrder
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: |-
                            =If(
                                chbVendorInvoiceDetailsItemSelectRow.Value,
                                varThemeColors.templateRowSelectFill,
                                RGBA(
                                    255,
                                    255,
                                    255,
                                    1
                                )
                            )
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =CountRows(colVendorInvoiceItems)>0
                        Width: =
                        ZIndex: =4

                        shpVendorInvoiceDetailsItemsRowDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        btnVendorInvoiceDetailsViewEdit As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =ClearCollect(
                                    colAppNavigationThreads,
                                    Table(
                                        {
                                            Screen: App.ActiveScreen,
                                            Order: CountRows(colAppNavigationThreads) + 1
                                        }
                                    )
                                );
                                Navigate(
                                    'Vendor Invoice Item Details Screen',
                                    ScreenTransition.Cover,
                                    {
                                        _item: ThisItem,
                                        _currencyCode: cmbVendorInvoiceDetailsCurrency.Selected.'Value Code',
                                        _reset:true
                                    }
                                )
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: |-
                                =With(
                                    {
                                        Text: If(
                                            Or(
                                                varIsNew,
                                                varIsEdit
                                            ),
                                            "Edit",
                                            "View"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Width: =lblVendorInvoiceItemsTableHeaderDetails.Width-Self.FocusedBorderThickness-15
                            X: =btnVendorInvoiceDetailsItemsPurchaseOrderItem.X+btnVendorInvoiceDetailsItemsPurchaseOrderItem.Width
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =2

                        btnVendorInvoiceDetailsItemsPurchaseOrderItem As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseOrderItemNumber
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderPurchaseOrderItem.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsPurchaseOrder.X+lblVendorInvoiceDetailsItemsPurchaseOrder.Width
                            ZIndex: =3

                        btnVendorInvoiceDetailsItemsPurchaseOrder As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: |-
                                =If(
                                    varIsProcessing,
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =Color.Transparent
                            OnSelect: |-
                                =Launch(
                                    varPurchaseOrderAccess.'Application URL',
                                    {purchaseorder: Self.Text}
                                )
                            PaddingLeft: =12
                            PressedColor: =Color.Black
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseOrderNumber
                            Tooltip: =Self.Text
                            Visible: =!IsBlank(varPurchaseOrderAccess) && !IsBlank(Self.Text)
                            Width: =conVendorInvoiceItemsTableHeaderPurchaseOrder.Width
                            X: =lblVendorInvoiceDetailsItemsPurchaseOrder.X
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =4

                        lblVendorInvoiceDetailsItemsPurchaseOrder As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchaseOrderNumber
                            Tooltip: =Self.Text
                            Visible: =!btnVendorInvoiceDetailsItemsPurchaseOrder.Visible
                            Width: =conVendorInvoiceItemsTableHeaderPurchaseOrder.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsTotal.X+lblVendorInvoiceDetailsItemsTotal.Width
                            ZIndex: =5

                        lblVendorInvoiceDetailsItemsTotal As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.TotalPrice,
                                    "[$-en-US]#,##0.00"
                                )
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderTotal.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsUnit.X+lblVendorInvoiceDetailsItemsUnit.Width
                            ZIndex: =6

                        lblVendorInvoiceDetailsItemsUnit As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.UnitOfMeasure
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderUnit.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsQuantity.X+lblVendorInvoiceDetailsItemsQuantity.Width
                            ZIndex: =8

                        lblVendorInvoiceDetailsItemsQuantity As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.Quantity,
                                    "[$-en-US]#,##0.000"
                                )
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderMaterialQuantity.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsDescription.X+lblVendorInvoiceDetailsItemsDescription.Width
                            ZIndex: =9

                        lblVendorInvoiceDetailsItemsDescription As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Description
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderMaterialDescription.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsMaterial.X+lblVendorInvoiceDetailsItemsMaterial.Width
                            ZIndex: =10

                        lblVendorInvoiceDetailsItemsMaterial As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.MaterialNumber
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderMaterialNumber.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsLocation.X+lblVendorInvoiceDetailsItemsLocation.Width
                            ZIndex: =11

                        lblVendorInvoiceDetailsItemsLocation As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Location
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderLocation.Width
                            Wrap: =false
                            X: =lblVendorInvoiceDetailsItemsItem.X+lblVendorInvoiceDetailsItemsItem.Width
                            ZIndex: =12

                        lblVendorInvoiceDetailsItemsItem As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.ItemNumber
                            Tooltip: =Self.Text
                            Width: =conVendorInvoiceItemsTableHeaderItem.Width
                            Wrap: =false
                            X: =conVendorInvoiceItemsTableHeaderItem.X
                            ZIndex: =13

                        chbVendorInvoiceDetailsItemSelectRow As checkbox:
                            CheckboxBorderColor: =varThemeColors.primaryGray
                            CheckboxSize: =20
                            Color: =RGBA(0, 0, 0, 0)
                            Default: |
                                =varResetSelectRows
                            DisabledColor: =Self.Color
                            DisplayMode: =chbVendorInvoiceDetailsItemsSelectAll.DisplayMode
                            FocusedBorderColor: =varThemeColors.focusBorder
                            Font: =Font.'Segoe UI'
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =
                            OnCheck: =
                            OnSelect: =//Select(Parent)
                            OnUncheck: =
                            PressedColor: =Self.Color
                            Reset: =true
                            Size: =0
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: If(
                                            Self.Value,
                                            "Unselect row",
                                            "Select row"
                                        )
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Tooltip: =Self.Text
                            Visible: |-
                                =Or(
                                    varIsEdit,
                                    varIsNew
                                )
                            Width: =chbVendorInvoiceDetailsItemsSelectAll.Width
                            X: =2
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =14

                    cmpVendorInvoiceOrderItemsDisplay As NoItemsDisplay:
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galVendorInvoiceItems.Visible
                        Width: =
                        ZIndex: =6

                conVendorInvoiceDetailsFooter As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =30
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    ZIndex: =6

                    lblVendorInvoiceItemsNumberOfFoundRecords As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Lighter
                        Height: =30
                        LayoutMinWidth: =
                        Live: =Live.Polite
                        PaddingLeft: =0
                        Size: =10.5
                        Text: |-
                            =//Show how many rows are returned in the results
                            CountRows(galVendorInvoiceItems.AllItems) & " " &//Count the rows in the gallery
                            // Define a variable named "Text" with the value "{value}"
                             With(
                                {Text: "record(s)"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =galVendorInvoiceItems.Visible
                        Width: =
                        X: =1
                        ZIndex: =1

                    lblVendorInvoiceDetailsFooterMessage As label:
                        Align: =Align.Right
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FillPortions: =1
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        Height: =34
                        Italic: =true
                        LayoutMinWidth: =0
                        Live: =Live.Assertive
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: varFooterMessage},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(varIsProcessing, "...")
                        Visible: =!IsBlank(varFooterMessage)
                        Width: =
                        ZIndex: =2

    cmpVendorInvoiceDetailsLeftNavigation As LeftNavigation:
        Height: =Parent.Height-Self.Y
        Width: =cmpVendorInvoiceDetailsLeftNavigation.MenuWidth
        Y: =cmpVendorInvoiceDetailsHeader.Height
        ZIndex: =2

    cmpVendorInvoiceDetailsHeader As ScreenHeader:
        Width: =Parent.Width
        ZIndex: =3

    btnVendorInvoiceSearchLogicHidden As button:
        OnSelect: |-
            =If(
                !IsBlank(varSelectedVendorInvoiceID),
            //Sets processing indicator control behavior 
                Set(
                    varIsProcessing,
                    true
                );
                Set(
                    varFooterMessage,
                    "Loading"
                );
                //Remove any existing cached vendor invoice data whether variables or collections
            Set(
                    varVendorInvoiceHeader,
                    Blank()
                );
                Set(
                    varNewPurchaseOrderHeader,
                    Blank()
                );
                Set(
                    varPurchaseOrderNumber,
                    Blank()
                );
                Set(
                    varNewPurchaseOrderNumber,
                    Blank()
                );
                Set(
                    varVendorInvoicePostingDate,
                    Blank()
                );
                Clear(colVendorInvoiceItems);
                
            //Call ReadVendorInvoice Power Automate to read the vendor invoice from SAP
            ClearCollect(
                    colReadVendorInvoiceResponseTemp,//collection that temporarily stores the vendor invoice response data
                    ReadVendorInvoice.Run(varSelectedVendorInvoiceID)
                );
                
            //Evalute response conditions
            Switch(
                    true,
                    And(//Check to see if read vendor invoice call was successful and process happy path logic
                        First(colReadVendorInvoiceResponseTemp).Status = "Success",
                        !IsBlank(First(colReadVendorInvoiceResponseTemp).InvoiceNumber)
                    ),
                    Set(
                        varVendorInvoiceNumber,//Variable that stores the returned vendor invoice number
                        First(colReadVendorInvoiceResponseTemp).InvoiceNumber
                    );
                    Set(
                        varVendorInvoiceHeader,//Variable that stores the returned main vendor invoice data
                        First(colReadVendorInvoiceResponseTemp).Header
                    );
                    Set(
                        varPurchaseOrderNumber,//Variable that stores the returned vendor invoice for the vendor invoice
                        First(colReadVendorInvoiceResponseTemp).PurchaseOrderNumber
                    );
                    Set(//Set default sort column of items table
                        varVendorInvoiceItemsSortByColumn,
                        btnVendorInvoiceItemsTableHeaderItem.Text
                    );
                    Set(//Set default sort order of items table
                        varVendorInvoiceItemsSortOrder,
                        SortOrder.Ascending
                    );
                    //Reset any controls that interact with existing vendor invoice data
            Reset(chbVendorInvoiceDetailsItemsSelectAll);
                    Reset(galVendorInvoiceItems);
                    Reset(txtVendorInvoiceDetailsItemsFilter);
                 /*Cache associated vendor invoice child records. Collections are used to pass updated data back in update vendor invoice transactions
                Default CrudType fields to 'R'. CrudType will be changed if user changes/removes child records and used by update vendor invoice flow*/
            UpdateIf(
                        ClearCollect(
                            colVendorInvoiceItems,//Collection that caches associated vendor invoice items
                            First(colReadVendorInvoiceResponseTemp).Items
                        );
                        ,
                        true,
                        {CrudType: "R"}
                    );
                    //Create/update vendor invoice search history record
            Patch(
                        'SAP Search Histories',
                        Coalesce(
                            LookUp(
                                'SAP Search Histories',
                                And(
                                    'Object ID' = varVendorInvoiceNumber,
                                    'Object Type' = 'Object Type (SAP Search Histories)'.'Vendor Invoice',
                                    'Created By'.User = varSystemUserID
                                )
                            ),
                            Defaults('SAP Search Histories')
                        ),
                        {
                            'Object ID': varVendorInvoiceNumber,
                            'Object Type': 'Object Type (SAP Search Histories)'.'Vendor Invoice',
                            Name: Concatenate(
                                varVendorInvoiceNumber,
                                " - ",
                                varVendorInvoiceHeader.VendorName
                            ),
                            'Last Searched On': Now()
                        }
                    );
                //Check if the patch function was successful and notify if there was any errors.
            If(
                        !IsEmpty(Errors('SAP Search Histories')),
                        Notify(
                            First(Errors('SAP Search Histories')).Message,
                            NotificationType.Error,
                            0
                        ),
                        Reset(cmpVendorInvoiceDetailsMainCommandBar);
                        Refresh('SAP Search Histories');
                    );
                //End if ReadVendorInvoice Power Automate call was success
            ,
                    And(//Flow returned and error
                        First(colReadVendorInvoiceResponseTemp).Status = "Error",
                        IsBlank(First(colReadVendorInvoiceResponseTemp).Header.Vendor)
                    ),
                    Notify(
                        Concat(
                            First(colReadVendorInvoiceResponseTemp).Messages,
                            Message,
                            " "
                        ),
                        NotificationType.Error,
                        0
                    ),
                    And(//Check to see if call was successful, but no vendor invoice was found
                        First(colReadVendorInvoiceResponseTemp).Status = "Information",
                        IsBlank(First(colReadVendorInvoiceResponseTemp).InvoiceNumber)
                    ),
                    Notify(
                        With(
                            {Text: "Vendor invoice not found"},
                            If(
                    // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                    // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ),
                        NotificationType.Information,
                        7000
                    ),//Default response for an unhandled error return
                    Notify(
                        With(
                            {Text: "Unexpected error occurred"},
                            If(
                    // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                    // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ),
                        NotificationType.Error,
                        0
                    )
                );
                
            //End vendor invoice response switch statement
            //Reset loading to false as the data query is complete
            Set(
                    varSelectedVendorInvoiceID,//done with selected vendor invoice ID variable, set back to blank
                    Blank()
                );
               // Clear(colReadVendorInvoiceResponseTemp);
            //done with read vendor invoice temp collections, clear cache
            Set(
                    varIsProcessing,//done processing read vendor invoice, set variable back to false stopping any processing control behavior
                    false
                );
                Set(
                    varFooterMessage,
                    Blank()
                );
                
            )
        Text: ="Button"
        Visible: =false
        X: =1206
        Y: =96
        ZIndex: =4

