PurchaseOrderSearch As CanvasComponent:
    Fill: =varThemeColors.background
    Height: =App.Height
    OnReset: |
        =Set(
            varCurrentPurchaseOrderSearchTab,//Variable that drives which tab is selected control behavior, default to search all
            btnPurchaseOrderSearchAllTab.Text
        );
        Set(
            varRecentlySearchedSortOrder,//Variable that drives the sort order of recently searched gallery, default to descending
            SortOrder.Descending
        );
        Set(
            varRecentlySearchedSortByColumn,//Variable that drives the sort by column of recently searched gallery, default to last searched datetime field
            btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Text
        );
        Set(
            varPurchaseOrderSearchAllSortOrder,//Variable that drives the sort order of search all results gallery, default to ascending
            SortOrder.Ascending
        );
        Set(
            varPurchaseOrderSearchAllSortByColumn,//Variable that drives the sort by column of search all results gallery, default to vendor
            btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text
        );
        Set(
            varSelectedPurchaseOrderID, //Variable that will capture the selected purchase order user selected
            Blank()
        );
        Set(
            varSelectedVendorID, //Variable that will capture the selected vendor that user wants to search the purchase orders for
            Blank()
        );
        //Ensure any cached searched results and recent search history is blank
        Clear(colPurchaseOrderSearchResults);
    ResetSearch: =true
    Width: =1240
    X: =0
    Y: =0
    ZIndex: =2

    conPurchaseOrderSearchMain As groupContainer.verticalAutoLayoutContainer:
        Height: =PurchaseOrderSearch.Height
        LayoutAlignItems: =LayoutAlignItems.Stretch
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        LayoutOverflowX: =LayoutOverflow.Scroll
        LayoutOverflowY: =LayoutOverflow.Scroll
        Width: =PurchaseOrderSearch.Width
        ZIndex: =2

        conPurchaseOrderSearchHeader As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =48
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conPurchaseOrderSearchAll.Visible,
                    conPurchaseOrderSearchAll.LayoutMinWidth,
                    conPurchaseOrderRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =Parent.Width
            ZIndex: =1

            "icoPurchaseOrderSearchHeader As icon.'3DPrinting'":
                AccessibleLabel: =Self.Tooltip
                BorderColor: =varThemeColors.primary
                Color: =varThemeColors.primary
                DisabledBorderColor: =varThemeColors.disabledText
                DisabledColor: =varThemeColors.backgroundFillDisabled
                DisabledFill: =RGBA(0,0,0,0)
                DisplayMode: |-
                    =If(
                        varIsProcessing,
                        DisplayMode.Disabled,
                        DisplayMode.Edit
                    )
                Fill: =RGBA(0,0,0,0)
                FocusedBorderColor: =varThemeColors.tertiaryGray
                Height: =30
                HoverBorderColor: =varThemeColors.primary
                HoverColor: =varThemeColors.tertiary
                HoverFill: =RGBA(0,0,0,0)
                Icon: =Icon.ArrowLeft
                OnSelect: |
                    =Set(
                        varNewVendorHeader,
                        Blank()
                    );
                    Navigate(
                        Last(
                            Sort(
                                colAppNavigationThreads,
                                Order
                            )
                        ).Screen,
                        ScreenTransition.CoverRight
                    );
                PaddingBottom: =5
                PaddingLeft: =5
                PaddingRight: =5
                PaddingTop: =5
                PressedBorderColor: =varThemeColors.primary
                PressedColor: =varThemeColors.primary
                PressedFill: =RGBA(0,0,0,0)
                TabIndex: =0
                Tooltip: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Back"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =30
                Y: =Parent.Height/2-Self.Height/2
                ZIndex: =1

            lblPurchaseOrderSearchHeader As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Semibold
                Height: =Parent.Height
                PaddingBottom: =0
                PaddingLeft: =0
                PaddingTop: =0
                Role: =TextRole.Heading1
                Size: =14.5
                Text: |-
                    =// Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "Purchase order search"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text 
                            ).'Localized Value'
                        )
                    )
                Width: =Parent.Width-Self.X
                Wrap: =false
                ZIndex: =2

        conPurchaseOrderSearchTabs As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Fill: =RGBA(255, 255, 255, 1)
            FillPortions: =0
            Height: =43
            LayoutAlignItems: =LayoutAlignItems.Center
            LayoutGap: =5
            LayoutMinHeight: =
            LayoutMinWidth: |-
                =If(
                    conPurchaseOrderSearchAll.Visible,
                    conPurchaseOrderSearchAll.LayoutMinWidth,
                    conPurchaseOrderRecentlySearched.LayoutMinWidth
                )
            LayoutMode: =LayoutMode.Auto
            PaddingLeft: =32
            PaddingRight: =32
            Width: =Parent.Width
            ZIndex: =2

            conPurchaseOrderSearchAllTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnPurchaseOrderSearchAllTab.Text)*8
                Y: =36
                ZIndex: =1

                shpPurchaseOrderSearchAllTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentPurchaseOrderSearchTab=btnPurchaseOrderSearchAllTab.Text
                    Width: =btnPurchaseOrderSearchAllTab.Width
                    X: =1
                    Y: =btnPurchaseOrderSearchAllTab.Y+btnPurchaseOrderSearchAllTab.Height
                    ZIndex: =1

                btnPurchaseOrderSearchAllTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: |-
                        =If(
                            varCurrentPurchaseOrderSearchTab = Self.Text,
                            FontWeight.Semibold,
                            FontWeight.Normal
                        )
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: |
                        =Set(
                            varCurrentPurchaseOrderSearchTab, //Variable that drives which tab is selected and drives which search results to show
                            Self.Text
                        );
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search all"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

            conPurchaseOrderSearchRecentTab As groupContainer.manualLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =Parent.Height
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                Width: =Len(btnPurchaseOrderSearchRecentTab.Text)*8
                Y: =36
                ZIndex: =2

                shpPurchaseOrderSearchRecentTab As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Tab selected"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    Height: =2
                    Visible: =varCurrentPurchaseOrderSearchTab=btnPurchaseOrderSearchRecentTab.Text
                    Width: =btnPurchaseOrderSearchRecentTab.Width
                    X: =1
                    Y: =btnPurchaseOrderSearchRecentTab.Y+btnPurchaseOrderSearchRecentTab.Height
                    ZIndex: =1

                btnPurchaseOrderSearchRecentTab As button:
                    BorderColor: =varThemeColors.primaryGray
                    BorderThickness: =0
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.primaryGray
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    FontWeight: |-
                        =If(
                            varCurrentPurchaseOrderSearchTab = Self.Text,
                            FontWeight.Semibold,
                            FontWeight.Normal
                        )
                    Height: =Parent.Height-Self.Y*2
                    HoverBorderColor: =varThemeColors.tertiaryGray
                    HoverColor: =varThemeColors.primary
                    HoverFill: =
                    OnSelect: |-
                        =Reset(txtPurchaseOrderRecentlySearchedCommandBarFilter);
                        Set(
                            varCurrentPurchaseOrderSearchTab,//Variable that drives which tab is selected and drives which search results to show
                            Self.Text
                        );
                        Refresh('SAP Search Histories')
                    PaddingLeft: =0
                    PaddingRight: =0
                    PressedBorderColor: =
                    PressedColor: =varThemeColors.text
                    PressedFill: =
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Recently searched"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width-Self.X*2
                    X: =Self.FocusedBorderThickness
                    Y: =Self.FocusedBorderThickness
                    ZIndex: =2

        conPurchaseOrderSearchAll As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =RGBA(0, 0, 0, 0)
            BorderStyle: =BorderStyle.None
            Height: =700
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutGap: =15
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conPurchaseOrderSearchAllFooter.Height +  conPurchaseOrderSearchAllResults.LayoutMinHeight + conPurchaseOrderSearchAllFields.Height + conPurchaseOrderSearchButtons.Height + Self.PaddingTop + Self.PaddingBottom + Self.LayoutGap * 2 + 10
            LayoutMinWidth: =conPurchaseOrderSearchAllResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =25
            Visible: =varCurrentPurchaseOrderSearchTab = btnPurchaseOrderSearchAllTab.Text
            Width: =Parent.Width
            ZIndex: =3

            conPurchaseOrderSearchAllFields As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: =64
                LayoutGap: =10
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                LayoutWrap: =true
                Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                ZIndex: =1

                conPurchaseOrderSearchAllOrderNumber As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            244,
                            Len(txtPurchaseOrderSearchAllOrderNumber.HintText) * 10
                        )
                    X: =40
                    ZIndex: =1

                    txtPurchaseOrderSearchAllOrderNumber As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: =varThemeColors.primaryGray
                        BorderThickness: =1
                        Clear: =true
                        Color: =varThemeColors.text
                        Default: =If(PurchaseOrderSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter order number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =varThemeColors.tertiaryGray
                        HoverColor: =varThemeColors.text
                        HoverFill: =varThemeColors.backgroundFill
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderSearchAllOrderNumber.Width
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderSearchAllOrderNumber.Y+lblPurchaseOrderSearchAllOrderNumber.Height
                        ZIndex: =2

                    lblPurchaseOrderSearchAllOrderNumber As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Order number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =3

                conPurchaseOrderSearchAllVendor As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            224,
                            Len(lblPurchaseOrderSearchAllVendor.Text) * 10
                        )
                    X: =40
                    ZIndex: =4

                    txtPurchaseOrderSearchAllVendor As text:
                        AccessibleLabel: =Self.HintText
                        BorderColor: |-
                            =If(
                                Self.Color = varThemeColors.requiredRed,
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        Color: |-
                            =If(
                                Self.Italic,
                                varThemeColors.requiredRed,
                                varThemeColors.text
                            )
                        Default: |-
                            =If(
                                PurchaseOrderSearch.ResetSearch,
                                "",
                                varNewVendorHeader.Vendor
                            )
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Format: =TextFormat.Number
                        Height: =32
                        HintText: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Enter vendor number"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        HoverBorderColor: =Self.BorderColor
                        HoverColor: =Self.Color
                        HoverFill: =varThemeColors.backgroundFill
                        Italic: |+
                            =Switch(true,
                                IsBlank(Self.Text),
                                false,
                                !IsBlank(varNewVendorHeader.Vendor) && Self.Text = varNewVendorHeader.Vendor,
                                false,
                                true
                            )
                            
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        PressedBorderColor: =varThemeColors.tertiaryGray
                        PressedColor: =varThemeColors.text
                        PressedFill: =varThemeColors.backgroundFill
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Reset: =true
                        Size: =10.5
                        Tooltip: |-
                            =Coalesce(
                                Self.Text,
                                Self.HintText
                            )
                        Width: =lblPurchaseOrderSearchAllVendor.Width-icoPurchaseOrderSearchAllVendorAdvanced.Width-10-Self.X
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderSearchAllVendor.Y+lblPurchaseOrderSearchAllVendor.Height
                        ZIndex: =2

                    "icoPurchaseOrderSearchAllVendorAdvanced As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primary
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        Height: =32
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.FilterFlat
                        OnSelect: |-
                            =//Collection that tracks cross screen navigation thread and allows to back out in reverse sequence
                            Collect(
                                colAppNavigationThreads,
                                Table(
                                    {
                                        Screen: App.ActiveScreen,
                                        Order: CountRows(colAppNavigationThreads) + 1
                                    }
                                )
                            );
                            //sets global variable so the component knows which screen to navigate back to
                            Navigate(
                                'Purchase Order Vendor Search Screen',
                                ScreenTransition.Cover
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor advanced search"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =32
                        X: =conPurchaseOrderSearchAllVendor.Width-Self.Width-Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderSearchAllVendor.Y+lblPurchaseOrderSearchAllVendor.Height
                        ZIndex: =3

                    "icoPurchaseOrderSearchAllVendor As icon.'3DPrinting'":
                        AccessibleLabel: =Self.Tooltip
                        BorderColor: =varThemeColors.primary
                        Color: =varThemeColors.primaryGray
                        DisabledBorderColor: =varThemeColors.disabledText
                        DisabledColor: =varThemeColors.backgroundFillDisabled
                        DisabledFill: =RGBA(0,0,0,0)
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        Fill: =RGBA(0,0,0,0)
                        FocusedBorderColor: =varThemeColors.tertiaryGray
                        Height: =32  
                        HoverBorderColor: =
                        HoverColor: =varThemeColors.primary
                        HoverFill: =RGBA(0,0,0,0)
                        Icon: =Icon.ArrowRight
                        OnSelect: |
                            =//Sets processing indicator control behavior 
                            Set(
                                varIsProcessing,
                                true
                            );
                            //Call ReadVendor Power Automate to read the vendor from SAP
                            ClearCollect(
                                colReadVendorResponseTemp,//collection that temporarily stores the vendor response data
                                ReadVendor.Run(Trim(txtPurchaseOrderSearchAllVendor.Text))
                            );
                            //Evalute response conditions
                            Switch(
                                true,
                                And(//Check to see if vendor call was successful and process happy path logic
                                    First(colReadVendorResponseTemp).Status = "Success",
                                    !IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                ),
                                Set(
                                    varNewVendorHeader,//Variable that stores the returned main vendor header data
                                    First(colReadVendorResponseTemp).Header
                                );
                                Set(
                                    varSelectedVendorID,
                                    varNewVendorHeader.Vendor
                                );
                                Patch(
                                    'SAP Search Histories',
                                    Coalesce(
                                        LookUp(
                                            'SAP Search Histories',
                                            And(
                                                'Object Type' = 'Object Type (SAP Search Histories)'.Vendor,
                                                'Object ID' = varNewVendorHeader.Vendor,
                                                'Created By'.User = varSystemUserID
                                            )
                                        ),
                                        Defaults('SAP Search Histories')
                                    ),
                                    {
                                        'Object ID': varNewVendorHeader.Vendor,
                                        'Object Type': 'Object Type (SAP Search Histories)'.Vendor,
                                        Name: varNewVendorHeader.VendorName,
                                        'Attribute 1': Concatenate(
                                        varNewVendorHeader.Vendor,
                                        "-",
                                        varNewVendorHeader.VendorName
                                    ),
                                    'Last Searched On': Now()
                                    }
                                );
                                //Check if the patch function was successful and notify if there was any errors.
                            If(
                                    !IsEmpty(Errors('SAP Search Histories')),
                                    Notify(
                                        First(Errors('SAP Search Histories')).Message,
                                        NotificationType.Error,
                                        0
                                    ),
                                    Refresh('SAP Search Histories')
                                );
                                ,//End if ReadVendor Power Automate call was success
                                And(//Check to see if call was successful, but no vendor was found
                                    First(colReadVendorResponseTemp).Status = "Information",
                                    IsBlank(First(colReadVendorResponseTemp).Header.Vendor)
                                ),
                                Notify(
                                    With(
                                        {Text: "Vendor not found"},
                                        If(
                                    // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                    // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    NotificationType.Information,
                                    7000
                                ),//Default response for an unhandled error return
                                Notify(
                                    With(
                                        {Text: "Unexpected error occurred"},
                                        If(
                                    // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                    // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    NotificationType.Error,
                                    0
                                )
                            );
                            //End vendor response switch statement
                            //Reset loading to false as the data query is complete
                            //done with read vendor temp collections, clear cache
                            Clear(colReadVendorResponseTemp);
                            Set(
                                varIsProcessing,//done processing read vendor, set variable back to false stopping any processing control behavior
                                false
                            );
                        PaddingBottom: =5
                        PaddingLeft: =5
                        PaddingRight: =5
                        PaddingTop: =5
                        PressedBorderColor: =
                        PressedColor: =
                        PressedFill: =RGBA(0,0,0,0)
                        TabIndex: =0
                        Tooltip: |-
                            =With(
                                {Text: "Execute vendor search"},
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Visible: =!IsBlank(txtPurchaseOrderSearchAllVendor.Text)
                        Width: =30
                        X: =txtPurchaseOrderSearchAllVendor.X+txtPurchaseOrderSearchAllVendor.Width-Self.Width
                        Y: =txtPurchaseOrderSearchAllVendor.Y
                        ZIndex: =4

                    lblPurchaseOrderSearchAllVendor As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingLeft: =0
                        PaddingRight: =0
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Vendor"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Parent.Width-Self.FocusedBorderThickness*2
                        X: =Self.FocusedBorderThickness
                        ZIndex: =5

                conPurchaseOrderSearchAllDateFrom As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            160,
                            Len(dtePurchaseOrderSearchAllDateFrom.InputTextPlaceholder) * 10
                        )
                    ZIndex: =7

                    dtePurchaseOrderSearchAllDateFrom As datepicker:
                        AccessibleLabel: |-
                            =If(
                                Or(
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                With(
                                    {Text: "Select created from date required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        BorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: =If(PurchaseOrderSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select from date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =Self.FocusedBorderThickness
                        Y: =lblPurchaseOrderSearchAllDateFrom.Height+lblPurchaseOrderSearchAllDateFrom.Y
                        ZIndex: =1

                    lblPurchaseOrderSearchAllDateFrom As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Created from"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(
                                Or(
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                " *"
                            )
                        Width: =Parent.Width
                        X: =dtePurchaseOrderSearchAllDateFrom.X
                        ZIndex: =2

                conPurchaseOrderSearchAllDateTo As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    FillPortions: =0
                    Height: =64
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    Width: |-
                        =Max(
                            160,
                            Len(dtePurchaseOrderSearchAllDateTo.InputTextPlaceholder) * 10
                        )
                    ZIndex: =8

                    dtePurchaseOrderSearchAllDateTo As datepicker:
                        AccessibleLabel: |-
                            =If(
                                Or(
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                With(
                                    {Text: "Select created to date required"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                    // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                    // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            )
                        BorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.primaryGray
                            )
                        BorderThickness: =1
                        CalendarHeaderFill: =ColorFade(RGBA(105, 121, 126, 1), -30%)
                        Color: =varThemeColors.text
                        DefaultDate: =If(PurchaseOrderSearch.ResetSearch,"")
                        DisabledBorderColor: =varThemeColors.primaryGray
                        DisabledColor: =varThemeColors.disabledText
                        DisabledFill: =varThemeColors.backgroundFillDisabled
                        DisplayMode: |-
                            =If(
                                varIsProcessing,
                                DisplayMode.Disabled,
                                DisplayMode.Edit
                            )
                        EndYear: =2025
                        Fill: =varThemeColors.backgroundFill
                        FocusedBorderColor: |-
                            =If(
                                And(
                                    IsBlank(Self.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate)
                                ),
                                varThemeColors.requiredRed,
                                varThemeColors.focusBorder
                            )
                        FocusedBorderThickness: =2
                        Font: =Font.'Segoe UI'
                        Height: =32
                        HoverDateFill: =RGBA(200, 200, 200, 1)
                        IconBackground: =varThemeColors.backgroundFill
                        IconFill: =varThemeColors.text
                        InputTextPlaceholder: |-
                            =With(
                                {Text: "Select to date"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        OnChange: =
                        PaddingBottom: =6
                        PaddingLeft: =8
                        PaddingRight: =8
                        PaddingTop: =6
                        Reset: =true
                        SelectedDateFill: =RGBA(105, 121, 126, 1)
                        Size: =10.5
                        StartYear: =2016
                        Tooltip: |-
                            =If(
                                IsBlank(Self.SelectedDate),
                                Self.InputTextPlaceholder,
                                Self.SelectedDate
                            )
                        Width: =Parent.Width-Self.X*2
                        X: =4
                        Y: =lblPurchaseOrderSearchAllDateTo.Height+lblPurchaseOrderSearchAllDateTo.Y
                        ZIndex: =1

                    lblPurchaseOrderSearchAllDateTo As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =30
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingTop: =0
                        Size: =10.5
                        Text: |-
                            =With(
                                {Text: "Created to"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            ) & If(
                                Or(
                                    !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                    !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                                ),
                                " *"
                            )
                        Width: =Parent.Width
                        X: =dtePurchaseOrderSearchAllDateTo.X
                        ZIndex: =2

            conPurchaseOrderSearchButtons As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                FillPortions: =0
                Height: =42
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =20
                LayoutMinHeight: =
                LayoutMinWidth: =
                LayoutMode: =LayoutMode.Auto
                PaddingLeft: =2
                PaddingRight: =2
                Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                ZIndex: =2

                btnPurchaseOrderSearchCommandBarSearch As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.altText
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.primary
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |
                        =//Check if required search fields and store missing fields in a collection
                        Clear(colRequiredFieldsTemp);
                        If(
                            And(
                                IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                !IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                            ),
                            Collect(
                                colRequiredFieldsTemp,
                                lblPurchaseOrderSearchAllDateFrom.Text
                            )
                        );
                        If(
                            And(
                                !IsBlank(dtePurchaseOrderSearchAllDateFrom.SelectedDate),
                                IsBlank(dtePurchaseOrderSearchAllDateTo.SelectedDate)
                            ),
                            Collect(
                                colRequiredFieldsTemp,
                                lblPurchaseOrderSearchAllDateTo.Text
                            )
                        );
                        //Check to see if required fields collection, notify which fields are missing if so
                        If(
                            !IsEmpty(colRequiredFieldsTemp),
                            Notify(
                                Substitute(
                                    With(
                                        {Text: "The following information is required before searching"},
                                        If(
                                // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ) & ": " & Concat(
                                        colRequiredFieldsTemp,
                                        Value,
                                        ", "
                                    ),
                                    " *",
                                    ""
                                ),
                                NotificationType.Error,
                                0
                            );
                            ,
                            //Reset filter controls, cached data and table sort orders
                            Set(
                                varPurchaseOrderSearchAllSortOrder,
                                SortOrder.Ascending
                            );
                            Set(
                                varPurchaseOrderSearchAllSortByColumn,
                                btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text
                            );
                            Set(
                                varIsProcessing,
                                true
                            );
                            Set(
                                varFooterMessage,
                                "Searching"
                            );
                            
                        //Invoke the ReadPurchaseOrderList power automate and store results in a collection
                        ClearCollect(
                                colPurchaseOrderSearchResultsTemp,
                                ReadPurchaseOrderList.Run(
                                    Substitute(
                                        JSON(
                                            {
                                                OrderNumber: Trim(txtPurchaseOrderSearchAllOrderNumber.Text),
                                                Vendor: Trim(txtPurchaseOrderSearchAllVendor.Text),
                                                DateFrom: Text(
                                                    dtePurchaseOrderSearchAllDateFrom.SelectedDate,
                                                    "yyyymmdd",
                                                    "en-US"
                                                ),
                                                DateTo: Text(
                                                    dtePurchaseOrderSearchAllDateTo.SelectedDate,
                                                    "yyyymmdd",
                                                    "en-US"
                                                )
                                            },
                                            JSONFormat.IndentFour
                                        ),
                                        "null",
                                        """"""
                                    )
                                )
                            );
                            //Add vendor name column to support rendering in gallery list
                        ClearCollect(
                                colPurchaseOrderSearchResults,
                                AddColumns(
                                    First(colPurchaseOrderSearchResultsTemp).List,
                                    "_VendorName",
                                    LookUp(
                                        First(colPurchaseOrderSearchResultsTemp).Names As tempCol1,
                                        Vendor = tempCol1.Vendor,
                                        tempCol1.VendorName
                                    ),
                                    "_Amount",
                                    Sum(
                                        Filter(
                                            First(colPurchaseOrderSearchResultsTemp).PurchaseOrderLines As tempCol2,
                                            OrderNumber = tempCol2.OrderNumber
                                        ),
                                        Amount
                                    )
                                )
                            );
                            //Evaluate return statuses to determine what type of notification
                        With(
                                {
                                    Text: Switch(
                                        First(colPurchaseOrderSearchResultsTemp).Status,
                                        "Information",
                                        "No purchase orders were found based on your search criteria",
                                        "Warning",
                                        "The maximum number of search results were found based upon your criteria and some records may be missing. Please try changing your search criteria.",
                                        "Error",
                                        Concat(
                                            First(colPurchaseOrderSearchResultsTemp).Messages,
                                            Message,
                                            " "
                                        ),
                                        "purchase orders found based upon your search criteria"
                                    ),
                                    Status: First(colPurchaseOrderSearchResultsTemp).Status
                                },
                                Notify(
                                //Append record count to message if success
                                    Concatenate(
                                        If(
                                            Status = "Success",
                                            CountRows(colPurchaseOrderSearchResults)
                                        ) & " ",
                                        If(
                                // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    ),
                                    //Set the notification type
                                    Switch(
                                        Status,
                                        "Information",
                                        NotificationType.Information,
                                        "Warning",
                                        NotificationType.Warning,
                                        "Error",
                                        NotificationType.Error,
                                        NotificationType.Success
                                    ),
                                    If(
                                        Status = "Error",
                                        0,
                                        7000
                                    )
                                );
                            );
                            
                        );
                        Clear(colRequiredFieldsTemp);
                        Clear(colPurchaseOrderSearchResultsTemp);
                        Reset(galPurchaseOrderSearchResults);
                        //Done processing
                        Set(
                            varIsProcessing,
                            false
                        );
                        Set(
                            varFooterMessage,
                            Blank()
                        );
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Search"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =1
                    Y: =1
                    ZIndex: =1

                btnPurchaseOrderSearchCommandBarSearchClear As button:
                    BorderColor: =varThemeColors.primary
                    BorderThickness: =1
                    Color: =varThemeColors.text
                    DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                    DisabledColor: =varThemeColors.disabledText
                    DisabledFill: =varThemeColors.backgroundFillDisabled
                    DisplayMode: |-
                        =If(
                            varIsProcessing,
                            DisplayMode.Disabled,
                            DisplayMode.Edit
                        )
                    Fill: =varThemeColors.backgroundFill
                    FocusedBorderColor: =varThemeColors.focusBorder
                    FocusedBorderThickness: =2
                    Font: =Font.'Segoe UI'
                    HoverBorderColor: =varThemeColors.primary
                    HoverColor: =varThemeColors.altText
                    HoverFill: =varThemeColors.tertiary
                    OnSelect: |-
                        =Set(
                            varNewVendorHeader,
                            Blank()
                        );
                        Clear(colPurchaseOrderSearchResults);
                        //Reset all the controls and clear the cache
                        Reset(txtPurchaseOrderSearchAllOrderNumber);
                        Reset(dtePurchaseOrderSearchAllDateFrom);
                        Reset(dtePurchaseOrderSearchAllDateTo);
                        Reset(txtPurchaseOrderSearchAllVendor);
                        Reset(txtPurchaseOrderSearchResultsFilter_1);
                        Reset(txtPurchaseOrderSearchAllVendor)
                    PressedBorderColor: =varThemeColors.primary
                    PressedColor: =varThemeColors.altText
                    PressedFill: =varThemeColors.primary
                    RadiusBottomLeft: =4
                    RadiusBottomRight: =4
                    RadiusTopLeft: =4
                    RadiusTopRight: =4
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: "Clear"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =150
                    X: =btnPurchaseOrderSearchCommandBarSearch.X+btnPurchaseOrderSearchCommandBarSearch.Width+20
                    Y: =1
                    ZIndex: =2

            conPurchaseOrderSearchAllResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                Height: =
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conPurchaseOrderSearchResultsTable.LayoutMinHeight + conPurchaseOrderSearchAllCommandBar.Height + shpPurchaseOrderSearchAllDivider.Height
                LayoutMinWidth: =conPurchaseOrderSearchResultsTable.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =
                ZIndex: =3

                conPurchaseOrderSearchAllCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblPurchaseOrderSearchAllCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Search results"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*9
                        ZIndex: =1

                    conPurchaseOrderSearchCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtPurchaseOrderSearchResultsFilter_1.X+txtPurchaseOrderSearchResultsFilter_1.Width+txtPurchaseOrderSearchResultsFilter_1.FocusedBorderThickness
                        ZIndex: =4

                        txtPurchaseOrderSearchResultsFilter_1 As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    Or(
                                        IsEmpty(colPurchaseOrderSearchResults),
                                        varIsProcessing
                                    ),
                                    DisplayMode.Disabled,
                                    DisplayMode.Edit
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |
                                =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Filter purchase orders"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                        // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                        // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpPurchaseOrderSearchCommandBarDivider_1.X+shpPurchaseOrderSearchCommandBarDivider_1.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpPurchaseOrderSearchCommandBarDivider_1 As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpPurchaseOrderSearchAllDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Width: =
                    ZIndex: =2

                conPurchaseOrderSearchResultsTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conPurchaseOrderSearchResultsTableHeader.Height + shpPurchaseOrderSearchResultsDivider.Height + If(galPurchaseOrderSearchResults.Visible,
                            galPurchaseOrderSearchResults.LayoutMinHeight,
                            conPurchaseOrderSearchNoResults.LayoutMinHeight
                        ) + Self.PaddingBottom + Self.PaddingTop
                    LayoutMinWidth: =conPurchaseOrderSearchResultsTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                    ZIndex: =3

                    conPurchaseOrderSearchResultsTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutMinHeight: =
                        LayoutMinWidth: =conPurchaseOrderSearchResultsTableHeaderPurchaseOrder.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderVendor.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderVendorName.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderCreatedOn.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderCompanyCode.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderPurchaseGroup.LayoutMinWidth + conPurchaseOrderSearchResultsTableHeaderAmount.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conPurchaseOrderSearchResultsTableHeaderPurchaseOrder As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderPurchaseOrder.X+icoPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =1

                            icoPurchaseOrderSearchResultsTableHeaderPurchaseOrder As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text)*8+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Y+btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(
                                            varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                            varPurchaseOrderSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchase order"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderVendor As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderVendor.X+icoPurchaseOrderSearchResultsTableHeaderVendor.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderVendor.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =2

                            icoPurchaseOrderSearchResultsTableHeaderVendor As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderVendor.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderVendor.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderVendor.Text)*10+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderVendor.Y+btnPurchaseOrderSearchResultsTableHeaderVendor.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderVendor As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Vendor"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderVendorName As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            FillPortions: =2
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderVendorName.X+icoPurchaseOrderSearchResultsTableHeaderVendorName.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderVendorName.Text) * 10,
                                    164
                                )
                            Y: =37
                            ZIndex: =3

                            icoPurchaseOrderSearchResultsTableHeaderVendorName As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderVendorName.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderVendorName.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderVendorName.Text)*9+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderVendorName.Y+btnPurchaseOrderSearchResultsTableHeaderVendorName.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderVendorName As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Vendor name"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderCreatedOn As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderCreatedOn.X+icoPurchaseOrderSearchResultsTableHeaderCreatedOn.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Text) * btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Size,
                                    244
                                )
                            Y: =37
                            ZIndex: =4

                            icoPurchaseOrderSearchResultsTableHeaderCreatedOn As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderCreatedOn.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Text)*8.5+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Y+btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderCreatedOn As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(
                                            varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                            varPurchaseOrderSearchAllSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Created on"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderCompanyCode As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderCompanyCode.X+icoPurchaseOrderSearchResultsTableHeaderCompanyCode.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =5

                            icoPurchaseOrderSearchResultsTableHeaderCompanyCode As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderCompanyCode.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Text)*9+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Y+btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderCompanyCode As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Company code"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderPurchaseOrganization As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.X+icoPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =6

                            icoPurchaseOrderSearchResultsTableHeaderPurchaseOrganization As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Text)*7.5+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Y+btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchasing organization"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderPurchaseGroup As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderPurchaseGroup.X+icoPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =7

                            icoPurchaseOrderSearchResultsTableHeaderPurchaseGroup As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Text)*8+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Y+btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchasing group"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderSearchResultsTableHeaderAmount As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderSearchResultsTableHeaderAmount.X+icoPurchaseOrderSearchResultsTableHeaderAmount.Width+10
                            Width: |-
                                =Max(
                                    Len(btnPurchaseOrderSearchResultsTableHeaderAmount.Text) * 10,
                                    244
                                )
                            Y: =37
                            ZIndex: =8

                            icoPurchaseOrderSearchResultsTableHeaderAmount As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderSearchResultsTableHeaderAmount.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varPurchaseOrderSearchAllSortByColumn=btnPurchaseOrderSearchResultsTableHeaderAmount.Text && galPurchaseOrderSearchResults.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderSearchResultsTableHeaderAmount.Text)*10.5+8
                                Y: =btnPurchaseOrderSearchResultsTableHeaderAmount.Y+btnPurchaseOrderSearchResultsTableHeaderAmount.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderSearchResultsTableHeaderAmount As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: =If(galPurchaseOrderSearchResults.Visible,DisplayMode.Edit,DisplayMode.View)
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varPurchaseOrderSearchAllSortOrder = SortOrder.Ascending,varPurchaseOrderSearchAllSortByColumn=Self.Text),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varPurchaseOrderSearchAllSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varPurchaseOrderSearchAllSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galPurchaseOrderSearchResults)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Amount"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpPurchaseOrderSearchResultsDivider As rectangle:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Divider"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        LayoutMinWidth: =
                        Width: =Parent.Width-Parent.PaddingLeft-Parent.PaddingRight
                        ZIndex: =2

                    galPurchaseOrderSearchResults As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Search results"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: =
                        ItemAccessibleLabel: =ThisItem.OrderNumber
                        Items: |-
                            =//Display purchase order search result items based upon whether filters results further and/or by sort column selected
                            With(
                                {
                                    searchResults: If(
                                        IsBlank(txtPurchaseOrderSearchResultsFilter_1.Text),//If additional filter text not entered, then just display results
                                        colPurchaseOrderSearchResults,
                                        Search(//Otherwise, search on cached results based upon entered text
                                            colPurchaseOrderSearchResults,
                                            txtPurchaseOrderSearchResultsFilter_1.Text,
                                            "CompanyCode",
                                            "OrderNumber",
                                            "PurchasingGroup",
                                            "PurchasingOrganization",
                                            "Vendor",
                                            "_VendorName"
                                        )
                                    )
                                },
                                SortByColumns(
                                    searchResults,
                                    Switch(
                                        varPurchaseOrderSearchAllSortByColumn,//determine which field to sort by based upon the tabel header column value selected and stored in variable
                                        btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Text,
                                        "OrderNumber",
                                        btnPurchaseOrderSearchResultsTableHeaderVendor.Text,
                                        "Vendor",
                                        btnPurchaseOrderSearchResultsTableHeaderCreatedOn.Text,
                                        "CreatedOn",
                                        btnPurchaseOrderSearchResultsTableHeaderCompanyCode.Text,
                                        "CompanyCode",
                                        btnPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Text,
                                        "PurchasingOrganization",
                                        btnPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Text,
                                        "PurchasingGroup",
                                        btnPurchaseOrderSearchResultsTableHeaderAmount.Text,
                                        "_Amount",
                                        btnPurchaseOrderSearchResultsTableHeaderVendorName.Text,
                                        "_VendorName"
                                    ),
                                    varPurchaseOrderSearchAllSortOrder//sort ascending or descending based upon value stored in variable
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: =!IsEmpty(colPurchaseOrderSearchResults)
                        Width: =
                        ZIndex: =4

                        shpPurchaseOrderSearchResultsRowDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblPurchaseOrderSearchResultsAmount As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem._Amount,
                                    "[$-en-US]#,###.00"
                                ) & Concatenate(
                                    " (",
                                    ThisItem.Currency,
                                    ")"
                                )
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderAmount.Width-15//scrollbar padding
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsPurchasingGroup.X+lblPurchaseOrderSearchResultsPurchasingGroup.Width
                            ZIndex: =2

                        lblPurchaseOrderSearchResultsPurchasingGroup As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchasingGroup
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderPurchaseGroup.Width
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsPurchasingOrganization.X+lblPurchaseOrderSearchResultsPurchasingOrganization.Width
                            ZIndex: =3

                        lblPurchaseOrderSearchResultsPurchasingOrganization As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.PurchasingOrganization
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderPurchaseOrganization.Width
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsCompanyCode.X+lblPurchaseOrderSearchResultsCompanyCode.Width
                            ZIndex: =4

                        lblPurchaseOrderSearchResultsCompanyCode As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.CompanyCode
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderCompanyCode.Width
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsCreatedOn.X+lblPurchaseOrderSearchResultsCreatedOn.Width
                            ZIndex: =5

                        lblPurchaseOrderSearchResultsCreatedOn As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    DateValue(ThisItem.CreatedOn),
                                    DateTimeFormat.ShortDate
                                )
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderCreatedOn.Width
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsVendorName.X+lblPurchaseOrderSearchResultsVendorName.Width
                            ZIndex: =6

                        lblPurchaseOrderSearchResultsVendorName As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem._VendorName
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderVendorName.Width
                            Wrap: =false
                            X: =lblPurchaseOrderSearchResultsVendor.X + lblPurchaseOrderSearchResultsVendor.Width
                            ZIndex: =7

                        lblPurchaseOrderSearchResultsVendor As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: =ThisItem.Vendor
                            Tooltip: =Self.Text
                            Width: =conPurchaseOrderSearchResultsTableHeaderVendor.Width
                            Wrap: =false
                            X: =btnPurchaseOrderSearchResultsSelect.X * 2 + btnPurchaseOrderSearchResultsSelect.Width
                            ZIndex: =8

                        btnPurchaseOrderSearchResultsSelect As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =Parent.TemplateHeight-Self.Y*2
                            HoverBorderColor: =
                            HoverColor: =varThemeColors.primary
                            HoverFill: =
                            OnSelect: |
                                =Set(
                                    varSelectedPurchaseOrderID,
                                    ThisItem.OrderNumber
                                );
                                Select(icoPurchaseOrderSearchHeader);
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.OrderNumber
                            Tooltip: =Self.Text
                            Width: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.Width-Self.X*2
                            X: =Self.FocusedBorderThickness
                            Y: =Self.FocusedBorderThickness
                            ZIndex: =9

                    conPurchaseOrderSearchNoResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =
                        Visible: =!galPurchaseOrderSearchResults.Visible
                        Width: =
                        ZIndex: =5

                        icoPurchaseOrderSearchNoResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No results"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            Visible: =!varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblPurchaseOrderSearchNoResults.Y-lblPurchaseOrderSearchNoResults.Height-30
                            ZIndex: =1

                        lblPurchaseOrderSearchNoResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Visible: =!varIsProcessing
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

                        imgPurchaseOrdersLoadingSubGrid As image:
                            Height: =46
                            Image: ='loading-grey'
                            Visible: =varIsProcessing
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblPurchaseOrderSearchNoResults.Y-lblPurchaseOrderSearchNoResults.Height-33
                            ZIndex: =3

            conPurchaseOrderSearchAllFooter As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                FillPortions: =0
                Height: =30
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                ZIndex: =5

                lblPurchaseOrderSearchNumberOfFoundRecords As label:
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    FontWeight: =FontWeight.Lighter
                    Height: =30
                    LayoutMinWidth: =
                    PaddingLeft: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.PaddingLeft
                    Size: =10.5
                    Text: |-
                        =//Show how many rows are returned in the results
                        CountRows(galPurchaseOrderSearchResults.AllItems) & " " &//Count the rows in the gallery
                        // Define a variable named "Text" with the value "{value}"
                         With(
                            {Text: "record(s)"},
                            // Check if a localized text exists for "Text" in the user's preferred language
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Visible: =galPurchaseOrderSearchResults.Visible
                    Width: =
                    X: =1
                    ZIndex: =1

                lblPurchaseOrderSearchAllFooterMessage As label:
                    Align: =Align.Right
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    BorderThickness: =2
                    Color: =varThemeColors.text
                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                    FillPortions: =1
                    FocusedBorderColor: =varThemeColors.primary
                    FocusedBorderThickness: =4
                    Font: =Font.'Segoe UI'
                    Height: =34
                    Italic: =true
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    Live: =Live.Assertive
                    PaddingBottom: =0
                    PaddingLeft: =32
                    PaddingRight: =32
                    PaddingTop: =0
                    Role: =TextRole.Heading2
                    Size: =10.5
                    Text: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {Text: varFooterMessage},
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        ) & If(varIsProcessing, "...")
                    Visible: =!IsBlank(varFooterMessage)
                    Width: =
                    ZIndex: =2

        conPurchaseOrderRecentlySearched As groupContainer.verticalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            Height: =600
            LayoutAlignItems: =LayoutAlignItems.Stretch
            LayoutDirection: =LayoutDirection.Vertical
            LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
            LayoutMinHeight: =conPurchaseOrderRecentlySearchedResults.LayoutMinHeight + lblNumberOfRecentlySearchedPurchaseOrderRecords.Height + Self.PaddingBottom + Self.PaddingTop + 10
            LayoutMinWidth: =conPurchaseOrderRecentlySearchedResults.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight + 125
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: =10
            PaddingLeft: =32
            PaddingRight: =32
            PaddingTop: =24
            Visible: =varCurrentPurchaseOrderSearchTab = btnPurchaseOrderSearchRecentTab.Text
            Width: =Parent.Width
            X: =40
            Y: =40
            ZIndex: =4

            conPurchaseOrderRecentlySearchedResults As groupContainer.verticalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                LayoutAlignItems: =LayoutAlignItems.Stretch
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMinHeight: =conPurchaseOrderRecentlySearchTable.LayoutMinHeight + shpPurchaseOrderRecentlySearchedResultsDivider.Height + conPurchaseOrderRecentlySearchedCommandBar.Height
                LayoutMinWidth: =conPurchaseOrderRecentlySearchTable.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                LayoutMode: =LayoutMode.Auto
                Width: =Parent.Width
                ZIndex: =6

                conPurchaseOrderRecentlySearchedCommandBar As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderColor: =RGBA(0, 0, 0, 0)
                    BorderStyle: =BorderStyle.None
                    Fill: =RGBA(255, 255, 255, 1)
                    FillPortions: =0
                    Height: =42
                    LayoutAlignItems: =LayoutAlignItems.Center
                    LayoutGap: =20
                    LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                    LayoutMinHeight: =
                    LayoutMinWidth: =
                    LayoutMode: =LayoutMode.Auto
                    PaddingLeft: =12
                    PaddingRight: =2
                    Width: =
                    ZIndex: =1

                    lblPurchaseOrderRecentlySearchedCommandBar As label:
                        BorderColor: =RGBA(0, 0, 0, 0)
                        BorderStyle: =BorderStyle.None
                        BorderThickness: =2
                        Color: =varThemeColors.text
                        DisabledBorderColor: =RGBA(0, 0, 0, 0)
                        FocusedBorderColor: =varThemeColors.primary
                        FocusedBorderThickness: =4
                        Font: =Font.'Segoe UI'
                        FontWeight: =FontWeight.Semibold
                        Height: =Parent.Height
                        PaddingBottom: =0
                        PaddingLeft: =0
                        PaddingRight: =0
                        PaddingTop: =0
                        Role: =TextRole.Heading2
                        Size: =10.5
                        Text: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {
                                    Text: "Recent records"
                                },
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        Width: =Len(Self.Text)*7.5
                        ZIndex: =1

                    conPurchaseOrderRecentlySearchedCommandBarFilter As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FillPortions: =0
                        Height: =Parent.Height
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        Width: =txtPurchaseOrderRecentlySearchedCommandBarFilter.X+txtPurchaseOrderRecentlySearchedCommandBarFilter.Width+txtPurchaseOrderRecentlySearchedCommandBarFilter.FocusedBorderThickness
                        ZIndex: =3

                        txtPurchaseOrderRecentlySearchedCommandBarFilter As text:
                            AccessibleLabel: =Self.HintText
                            BorderColor: =varThemeColors.primaryGray
                            BorderThickness: =1
                            Clear: =true
                            Color: =varThemeColors.text
                            Default: =
                            DelayOutput: =true
                            DisabledBorderColor: =varThemeColors.primaryGray
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =varThemeColors.backgroundFillDisabled
                            DisplayMode: |-
                                =If(
                                    galRecentlySearchedPurchaseOrders.Visible,
                                    DisplayMode.Edit,
                                    DisplayMode.Disabled
                                )
                            Fill: =varThemeColors.backgroundFill
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            Height: =32
                            HintText: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "Filter purchase orders"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            HoverBorderColor: =varThemeColors.tertiaryGray
                            HoverColor: =varThemeColors.text
                            HoverFill: =varThemeColors.backgroundFill
                            MaxLength: =70
                            OnChange: =
                            PaddingBottom: =6
                            PaddingLeft: =8
                            PaddingRight: =8
                            PaddingTop: =6
                            PressedBorderColor: =varThemeColors.tertiaryGray
                            PressedColor: =
                            PressedFill: =varThemeColors.backgroundFill
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Reset: =true
                            Size: =10.5
                            Tooltip: |-
                                =Coalesce(
                                    Self.Text,
                                    Self.HintText
                                )
                            Width: =248
                            X: =shpPurchaseOrderRecentlySearchedCommandBarFilterDivider.X+shpPurchaseOrderRecentlySearchedCommandBarFilterDivider.Width+7
                            Y: =Parent.Height/2-Self.Height/2
                            ZIndex: =1

                        shpPurchaseOrderRecentlySearchedCommandBarFilterDivider As rectangle:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "Divider"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Fill: =varThemeColors.secondaryGray
                            Height: =30
                            OnSelect: =
                            Width: =2
                            Y: =6
                            ZIndex: =2

                shpPurchaseOrderRecentlySearchedResultsDivider As rectangle:
                    AccessibleLabel: |-
                        =// Define a variable named "Text" with the value "{value}"
                        With(
                            {
                                Text: "Divider"
                            },
                            If(
                                // If the localized text is blank, return the default text
                                IsBlank(
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                ),
                                Text,
                                // If a localized text is found, return that instead of the default text
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            )
                        )
                    Fill: =varThemeColors.secondaryGray
                    Height: =1
                    LayoutMinHeight: =
                    LayoutMinWidth: =Parent.LayoutMinWidth
                    Width: =
                    ZIndex: =2

                conPurchaseOrderRecentlySearchTable As groupContainer.verticalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    Fill: =RGBA(255, 255, 255, 1)
                    Height: =
                    LayoutAlignItems: =LayoutAlignItems.Stretch
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =conPurchaseOrderRecentlySearchedTableHeader.Height + shpPurchaseOrderRecentlySearchedDivider.Height + If(galRecentlySearchedPurchaseOrders.Visible,
                            galRecentlySearchedPurchaseOrders.LayoutMinHeight,
                            conPurchaseOrderNoRecentlySearchedResults.Height
                        )+Self.PaddingTop+Self.PaddingBottom
                    LayoutMinWidth: =conPurchaseOrderRecentlySearchedTableHeader.LayoutMinWidth + Self.PaddingLeft + Self.PaddingRight
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =2
                    PaddingLeft: =16
                    PaddingRight: =16
                    Width: =
                    ZIndex: =7

                    conPurchaseOrderRecentlySearchedTableHeader As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 1)
                        FillPortions: =0
                        Height: =43
                        LayoutAlignItems: =LayoutAlignItems.Center
                        LayoutJustifyContent: =LayoutJustifyContent.SpaceBetween
                        LayoutMinHeight: =
                        LayoutMinWidth: =conPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.LayoutMinWidth + conPurchaseOrderRecentlySearchedTableHeaderLastSearched.LayoutMinWidth
                        LayoutMode: =LayoutMode.Auto
                        Width: =
                        ZIndex: =1

                        conPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.X+icoPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Width+10
                            Y: =37
                            ZIndex: =1

                            icoPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Text && galRecentlySearchedPurchaseOrders.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Text)*8+8
                                Y: =btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Y+btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedPurchaseOrders.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =If(//Stores the sort order of that column
                                        And(varRecentlySearchedSortOrder = SortOrder.Ascending,varRecentlySearchedSortByColumn=Self.Text),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    Reset(galRecentlySearchedPurchaseOrders)//Resets the gallery to move the scrollbar to the top
                                PaddingLeft: =12
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Purchase order"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                        conPurchaseOrderRecentlySearchedTableHeaderLastSearched As groupContainer.manualLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            Height: =44
                            LayoutMinHeight: =100
                            LayoutMinWidth: =icoPurchaseOrderRecentlySearchedTableHeaderLastSearched.X+icoPurchaseOrderRecentlySearchedTableHeaderLastSearched.Width+10
                            Width: =162
                            Y: =37
                            ZIndex: =3

                            icoPurchaseOrderRecentlySearchedTableHeaderLastSearched As icon.Save:
                                AccessibleLabel: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {
                                            Text: If(
                                                Self.Icon = Icon.ArrowUp,
                                                "Sorted ascending",
                                                "Sorted descending"
                                            )
                                        },
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Color: =varThemeColors.tertiaryGray
                                DisabledColor: =varThemeColors.disabledText
                                DisplayMode: =btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.DisplayMode
                                FocusedBorderColor: =varThemeColors.primary
                                Height: =12
                                Icon: |-
                                    =If(
                                        varRecentlySearchedSortOrder = SortOrder.Ascending,
                                        Icon.ArrowUp,
                                        Icon.ArrowDown
                                    )
                                Visible: =varRecentlySearchedSortByColumn=btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Text && galRecentlySearchedPurchaseOrders.Visible
                                Width: =12
                                X: =Len(btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Text)*7.5+8
                                Y: =btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Y+btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Height/2-Self.Height/2
                                ZIndex: =1

                            btnPurchaseOrderRecentlySearchedTableHeaderLastSearched As button:
                                Align: =Align.Left
                                BorderColor: =RGBA(0,0,0,0)
                                BorderThickness: =1
                                Color: =varThemeColors.text
                                DisabledBorderColor: =varThemeColors.backgroundFillDisabled
                                DisabledColor: =varThemeColors.disabledText
                                DisabledFill: =varThemeColors.backgroundFillDisabled
                                DisplayMode: |-
                                    =If(
                                        galRecentlySearchedPurchaseOrders.Visible,
                                        DisplayMode.Edit,
                                        DisplayMode.View
                                    )
                                Fill: =RGBA(0,0,0,0)
                                FocusedBorderColor: =varThemeColors.focusBorder
                                FocusedBorderThickness: =2
                                Font: =Font.'Segoe UI'
                                Height: =Parent.Height-Self.Y*2
                                HoverBorderColor: =
                                HoverColor: =varThemeColors.primary
                                HoverFill: =
                                OnSelect: |-
                                    =Set(//Stores which column is currently being sorted
                                        varRecentlySearchedSortByColumn,
                                        Self.Text
                                    );
                                    If(//Stores the sort order of that column
                                        And(
                                            varRecentlySearchedSortOrder = SortOrder.Ascending,
                                            varRecentlySearchedSortByColumn = Self.Text
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Descending
                                        ),
                                        Set(
                                            varRecentlySearchedSortOrder,
                                            SortOrder.Ascending
                                        )
                                    );
                                    Reset(galRecentlySearchedPurchaseOrders)//Resets the gallery to move the scrollbar to the top
                                PressedBorderColor: =
                                PressedColor: =varThemeColors.text
                                PressedFill: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0
                                RadiusTopRight: =0
                                Size: =10.5
                                Text: |-
                                    =// Define a variable named "Text" with the value "{value}"
                                    With(
                                        {Text: "Last searched"},
                                        // Check if a localized text exists for "Text" in the user's preferred language
                                        If(
                                            // If the localized text is blank, return the default text
                                            IsBlank(
                                                LookUp(
                                                    colUserLocalizedStrings,
                                                    'English Value' = Text
                                                ).'Localized Value'
                                            ),
                                            Text,
                                            // If a localized text is found, return that instead of the default text
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: =Parent.Width-Self.X*2
                                X: =Self.FocusedBorderThickness
                                Y: =Self.FocusedBorderThickness
                                ZIndex: =2

                    shpPurchaseOrderRecentlySearchedDivider As rectangle:
                        Fill: =varThemeColors.secondaryGray
                        Height: =1
                        LayoutMinHeight: =
                        Width: =
                        ZIndex: =2

                    galRecentlySearchedPurchaseOrders As gallery.galleryVertical:
                        AccessibleLabel: |-
                            =// Define a variable named "Text" with the value "{value}"
                            With(
                                {Text: "Purchase orders recently searched"},
                                // Check if a localized text exists for "Text" in the user's preferred language
                                If(
                                    // If the localized text is blank, return the default text
                                    IsBlank(
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    ),
                                    Text,
                                    // If a localized text is found, return that instead of the default text
                                    LookUp(
                                        colUserLocalizedStrings,
                                        'English Value' = Text
                                    ).'Localized Value'
                                )
                            )
                        AlignInContainer: =AlignInContainer.SetByContainer
                        FocusedBorderColor: =varThemeColors.focusBorder
                        FocusedBorderThickness: =2
                        Height: =
                        Items: |-
                            =//Display recent search result items sorting according to table header buttons selected and searched on further based upon filter text input
                            With(
                                {
                                    recentItems: If(
                                        IsBlank(txtPurchaseOrderRecentlySearchedCommandBarFilter.Text),//Items are not being filtered further
                                        Filter(
                                            'SAP Search Histories',
                                            'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                            'Object Type' = 'Object Type (SAP Search Histories)'.'Purchase Order'
                                        ),
                                        Search(//Search further on history records
                                            Filter(
                                                'SAP Search Histories',
                                                'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                                'Object Type' = 'Object Type (SAP Search Histories)'.'Purchase Order'
                                            ),
                                            txtPurchaseOrderRecentlySearchedCommandBarFilter.Text,//Search on text entered in filter control
                                            "mpa_objectid",
                                            "mpa_name"
                                        )
                                    )
                                },
                                SortByColumns(
                                    recentItems,
                                    Switch(
                                        varRecentlySearchedSortByColumn,//determine which field to sort by based upon the tabel header column value selected and stored in variable
                                        btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Text,
                                        "mpa_name",
                                        btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Text,
                                        "mpa_lastsearchedon"
                                    ),
                                    varRecentlySearchedSortOrder//sort ascending or descending based upon value stored in variable
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =Self.TemplateHeight * 6
                        LayoutMinWidth: =320
                        TabIndex: =0
                        TemplateFill: =RGBA(255, 255, 255, 1)
                        TemplatePadding: =0
                        TemplateSize: =43
                        Visible: |-
                            =!IsEmpty(
                                Filter(
                                    'SAP Search Histories',
                                    'SAP Search Histories (Views)'.'My Recent SAP Search History',//Entity view that has filter logic to return user's search history records
                                    'Object Type' = 'Object Type (SAP Search Histories)'.'Purchase Order'//Filter on object type purchase order
                                )
                            )
                        Width: =
                        ZIndex: =3

                        shpPurchaseOrderRecentlySearchedDivider_1 As rectangle:
                            Fill: =varThemeColors.secondaryGray
                            Height: =1
                            Width: =Parent.Width
                            Y: =Parent.TemplateHeight-Self.Height
                            ZIndex: =1

                        lblPurchaseOrderRecentlySearchedLastSearched As label:
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            Height: =43
                            PaddingBottom: =0
                            PaddingLeft: =12
                            PaddingTop: =0
                            Size: =10.5
                            Text: |-
                                =Text(
                                    ThisItem.'Last Searched On',
                                    DateTimeFormat.ShortDateTime
                                )
                            Tooltip: =Self.Text
                            Width: =btnPurchaseOrderRecentlySearchedTableHeaderLastSearched.Width
                            Wrap: =false
                            X: =btnPurchaseOrderRecentlySearchedPurchaseOrder.X*2+btnPurchaseOrderRecentlySearchedPurchaseOrder.Width
                            ZIndex: =2

                        btnPurchaseOrderRecentlySearchedPurchaseOrder As button:
                            Align: =Align.Left
                            BorderColor: =RGBA(0,0,0,0)
                            BorderThickness: =0
                            Color: =varThemeColors.lookupBlue
                            DisabledBorderColor: =
                            DisabledColor: =varThemeColors.disabledText
                            DisabledFill: =
                            DisplayMode: =
                            Fill: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.focusBorder
                            FocusedBorderThickness: =2
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Normal
                            Height: =43
                            HoverBorderColor: =
                            HoverColor: =Self.Color
                            HoverFill: =Color.Transparent
                            OnSelect: |
                                =Set(
                                    varSelectedPurchaseOrderID,
                                    ThisItem.'Object ID'
                                );
                                Select(icoPurchaseOrderSearchHeader);
                            PaddingLeft: =12
                            PressedColor: =Self.Color
                            PressedFill: =Color.Transparent
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Size: =10.5
                            Text: =ThisItem.Name
                            Tooltip: =Self.Text
                            Width: =btnPurchaseOrderRecentlySearchedTableHeaderPurchaseOrder.Width-Self.X*2
                            X: =2
                            ZIndex: =5

                    conPurchaseOrderNoRecentlySearchedResults As groupContainer.manualLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        Fill: =RGBA(255, 255, 255, 2)
                        FillPortions: =0
                        Height: =215
                        LayoutMinHeight: =215
                        LayoutMinWidth: =250
                        Visible: |
                            =CountRows(galRecentlySearchedPurchaseOrders.AllItems)=0
                        Width: =
                        ZIndex: =4

                        icoPurchaseOrderNoRecentlySearchedResults As icon.ListScrollEmpty:
                            AccessibleLabel: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {
                                        Text: "No items"
                                    },
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Color: =varThemeColors.disabledText
                            DisabledColor: =varThemeColors.disabledText
                            DisplayMode: =DisplayMode.View
                            Height: =38
                            Icon: =Icon.ListScrollEmpty
                            OnSelect: =
                            Width: =46
                            X: =Parent.Width/2-Self.Width/2
                            Y: =lblPurchaseOrderNoRecentlySearchedResults.Y-lblPurchaseOrderNoRecentlySearchedResults.Height-30
                            ZIndex: =1

                        lblPurchaseOrderNoRecentlySearchedResults As label:
                            Align: =Align.Center
                            BorderColor: =RGBA(0, 0, 0, 0)
                            BorderStyle: =BorderStyle.None
                            BorderThickness: =2
                            Color: =varThemeColors.text
                            DisabledBorderColor: =RGBA(0, 0, 0, 0)
                            FocusedBorderColor: =varThemeColors.primary
                            FocusedBorderThickness: =4
                            Font: =Font.'Segoe UI'
                            FontWeight: =FontWeight.Semibold
                            Height: =34
                            PaddingBottom: =0
                            PaddingLeft: =0
                            PaddingTop: =0
                            Size: =13.5
                            Text: |-
                                =// Define a variable named "Text" with the value "{value}"
                                With(
                                    {Text: "No items"},
                                    // Check if a localized text exists for "Text" in the user's preferred language
                                    If(
                                        // If the localized text is blank, return the default text
                                        IsBlank(
                                            LookUp(
                                                colUserLocalizedStrings,
                                                'English Value' = Text
                                            ).'Localized Value'
                                        ),
                                        Text,
                                        // If a localized text is found, return that instead of the default text
                                        LookUp(
                                            colUserLocalizedStrings,
                                            'English Value' = Text
                                        ).'Localized Value'
                                    )
                                )
                            Width: =Parent.Width
                            Y: =Parent.Height-40
                            ZIndex: =2

            lblNumberOfRecentlySearchedPurchaseOrderRecords As label:
                BorderColor: =RGBA(0, 0, 0, 0)
                BorderStyle: =BorderStyle.None
                BorderThickness: =2
                Color: =varThemeColors.text
                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                FocusedBorderColor: =varThemeColors.primary
                FocusedBorderThickness: =4
                Font: =Font.'Segoe UI'
                FontWeight: =FontWeight.Lighter
                Height: =30
                PaddingBottom: =0
                PaddingLeft: =btnPurchaseOrderSearchResultsTableHeaderPurchaseOrder.PaddingLeft
                Size: =10.5
                Text: |-
                    =//Show how many rows are returned in the results
                    
                    CountRows(galRecentlySearchedPurchaseOrders.AllItems) & " "& //Count the rows in the gallery
                    // Define a variable named "Text" with the value "{value}"
                    With(
                        {Text: "record(s)"},
                        // Check if a localized text exists for "Text" in the user's preferred language
                        If(
                            // If the localized text is blank, return the default text
                            IsBlank(
                                LookUp(
                                    colUserLocalizedStrings,
                                    'English Value' = Text
                                ).'Localized Value'
                            ),
                            Text,
                            // If a localized text is found, return that instead of the default text
                            LookUp(
                                colUserLocalizedStrings,
                                'English Value' = Text
                            ).'Localized Value'
                        )
                    )
                Visible: =galRecentlySearchedPurchaseOrders.Visible
                X: =1
                ZIndex: =7

