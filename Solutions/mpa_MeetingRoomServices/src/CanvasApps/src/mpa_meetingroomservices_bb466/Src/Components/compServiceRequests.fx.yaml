compServiceRequests As CanvasComponent:
    ComponentHeight: =720 
    ComponentWidth: =1024
    ControlLayoutProperties: |-
        ={
            outerPadding: {top: 20, right: 20, bottom: 20, left: 20},
            gap: {singlePX: 1, extraSmall: 5, small: 10, medium: 20, semiLarge:30, large:40},
            iconBorderRadius: {top: 3.5, right: 3, bottom: 3, left: 3},
            myRequestsGallery:
            {
                LayoutDirection: 
                If(
                    App.ActiveScreen.Size >= ScreenSize.Large,
                    LayoutDirection.Horizontal,
                    LayoutDirection.Vertical
                ), 
                serviceReqNumberMinWidth : 120,
                B2ControlSizeHeight: 28
            }
        }
    Fill: =ColorValue(varThemeColors.backgroundFill)
    FilteredMeetings: |-
        =Distinct(
            Filter(
                'Service Requests',
                'Owning User'.User = varCurrentUser.User,
                'Status Reason' in Self.MeetingFilter.StatusReasons
            ),
            Meeting.'Meeting ID'
        )
    GalleryItemCount: =CountRows(galMeetings_ServiceRequests.AllItems)
    Height: =Self.ComponentHeight
    MeetingFilter: |
        ={
            MeetingName: "",
            MeetingStartDate: Today()-60,
            MeetingEndDate: Today()+60,
            StatusReasons: ['Status Reason (Service Requests)'.New, 'Status Reason (Service Requests)'.'In progress', 'Status Reason (Service Requests)'.Completed, 'Status Reason (Service Requests)'.Cancelled, 'Status Reason (Service Requests)'.Resubmitted]
        }
    OnReset: =Reset(galMeetings_ServiceRequests)
    TemplateHeight: |-
        =If(
            App.ActiveScreen.Size >= ScreenSize.Large, //Desktop
            32,
            120
        )
    Width: =Self.ComponentWidth
    X: =0
    Y: =0
    ZIndex: =1

    conMain_ServiceRequestsMain As groupContainer.horizontalAutoLayoutContainer:
        DropShadow: =DropShadow.None
        Height: =Parent.Height
        LayoutDirection: =LayoutDirection.Vertical
        LayoutMode: =LayoutMode.Auto
        RadiusBottomLeft: =0
        RadiusBottomRight: =0
        RadiusTopLeft: =0
        RadiusTopRight: =0
        Width: =Parent.Width
        ZIndex: =1

        conSyncStatus_MyRequest As groupContainer.horizontalAutoLayoutContainer:
            AlignInContainer: =AlignInContainer.SetByContainer
            DropShadow: =DropShadow.None
            FillPortions: =0
            Height: =conSyncStatusIconLabel_MyRequest.Height + Self.PaddingTop + Self.PaddingBottom + If(Self.LayoutDirection = LayoutDirection.Vertical, Self.LayoutGap + btnShowHideUnsynchedMeetings_ServiceRequest.Height, 0)
            LayoutDirection: |-
                =If(
                    App.ActiveScreen.Size >= ScreenSize.Large, LayoutDirection.Horizontal, LayoutDirection.Vertical
                )
            LayoutGap: |-
                =If(
                    Self.LayoutDirection = LayoutDirection.Horizontal,
                    compServiceRequests.ControlLayoutProperties.gap.small,
                    btnShowHideUnsynchedMeetings_ServiceRequest.FocusedBorderThickness
                )
            LayoutMinHeight: =100
            LayoutMinWidth: =250
            LayoutMode: =LayoutMode.Auto
            PaddingBottom: |-
                =If(
                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop,
                    compServiceRequests.ControlLayoutProperties.gap.medium,
                    compServiceRequests.ControlLayoutProperties.gap.small
                )
            PaddingLeft: =compServiceRequests.ControlLayoutProperties.gap.medium
            PaddingRight: =compServiceRequests.ControlLayoutProperties.gap.medium
            PaddingTop: |-
                =If(
                    App.ActiveScreen.Size >= ScreenSize.Large, //Desktop,
                    compServiceRequests.ControlLayoutProperties.gap.medium,
                    compServiceRequests.ControlLayoutProperties.gap.small
                )
            RadiusBottomLeft: =0
            RadiusBottomRight: =0
            RadiusTopLeft: =0
            RadiusTopRight: =0
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =1

            conSyncStatusIconLabel_MyRequest As groupContainer.horizontalAutoLayoutContainer:
                AlignInContainer: =AlignInContainer.SetByContainer
                DropShadow: =DropShadow.None
                FillPortions: =0
                Height: =lblSyncStatus_MyRequest.Height + Self.PaddingTop + Self.PaddingBottom
                LayoutAlignItems: =LayoutAlignItems.Center
                LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.small
                LayoutMinHeight: =100
                LayoutMinWidth: =250
                LayoutMode: =LayoutMode.Auto
                PaddingBottom: =
                PaddingLeft: =
                PaddingRight: =
                PaddingTop: =
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: |-
                    =Min(
                        Self.PaddingLeft + 
                        conSyncStatus_ServiceRequest.Width + Self.LayoutGap + 
                        ((lblSyncStatus_MyRequest.Size * 0.65) * Len(lblSyncStatus_MyRequest.Text)) + 
                        Self.PaddingRight,
                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    )
                ZIndex: =1

                conSyncStatus_ServiceRequest As groupContainer.manualLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    BorderStyle: =BorderStyle.None
                    DropShadow: =DropShadow.None
                    Fill: =
                    FillPortions: =0
                    Height: =icoSyncStatus_ServiceRequest.Height
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    RadiusBottomLeft: =Self.Height
                    RadiusBottomRight: =Self.Height
                    RadiusTopLeft: =Self.Height
                    RadiusTopRight: =Self.Height
                    Width: =icoSyncStatus_ServiceRequest.Height
                    ZIndex: =1

                    icoSyncStatus_ServiceRequest As icon.Waypoint:
                        BorderStyle: =BorderStyle.None
                        Color: =ColorValue(varThemeColors.backgroundFill)
                        DisplayMode: =DisplayMode.View
                        Fill: =lblSyncStatus_MyRequest.Color
                        FocusedBorderThickness: =1
                        Height: =18
                        Icon: |-
                            =If(
                                Self.Fill = ColorValue(varThemeColors.error),
                                Icon.Warning,
                                Icon.Information
                            )
                        PaddingBottom: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.bottom
                        PaddingLeft: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.left
                        PaddingRight: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.right
                        PaddingTop: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.top
                        Width: =18
                        ZIndex: =1

                lblSyncStatus_MyRequest As label:
                    AutoHeight: =true
                    Color: |-
                        =If(
                            CountIf(
                                galMeetings_ServiceRequests.AllItems,
                                Or(
                                    IsBlank(calendarrecord),
                                    calendarrecord.startWithTimeZone <> 'Start Date',
                                    calendarrecord.endWithTimeZone <> 'End Date'
                                )
                            ) > 0,
                            ColorValue(varThemeColors.error),
                            ColorValue(varThemeColors.tertiaryGray)
                        )
                    Font: =varThemeFont.B2.face
                    FontWeight: =varThemeFont.B2.weightSemibold
                    Height: |-
                        =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom + 
                        If(
                            App.ActiveScreen.Size < ScreenSize.Large, //Mobile,
                            compServiceRequests.ControlLayoutProperties.gap.medium,
                            0
                        )
                    Italic: =varThemeFont.B2.italic
                    LayoutMinWidth: =Len(Self.Text) * Self.Size
                    PaddingBottom: |-
                        =If(
                            App.ActiveScreen.Size < ScreenSize.Large, //Mobile,
                            compServiceRequests.ControlLayoutProperties.gap.small
                        )
                    PaddingLeft: =
                    PaddingRight: =0
                    PaddingTop: |-
                        =If(
                            App.ActiveScreen.Size < ScreenSize.Large, //Mobile,
                            compServiceRequests.ControlLayoutProperties.gap.small
                        )
                    Size: =varThemeFont.B2.size
                    Text: |-
                        =With(
                            {
                                _OutdatedMeetingsCount: 
                                CountIf(
                                    galMeetings_ServiceRequests.AllItems,
                                    Or(
                                        IsBlank(calendarrecord),
                                        calendarrecord.startWithTimeZone <> 'Start Date',
                                        calendarrecord.endWithTimeZone <> 'End Date',
                                        calendarrecord.subject <> 'Meeting Name'
                                    )
                                )
                            },
                        
                            If(
                                _OutdatedMeetingsCount = 0,
                               "All meetings are in sync",
                        
                                If(
                                    !varShowOutOfSyncMeetings, 
                                    _OutdatedMeetingsCount & " ", 
                                    ""
                                ) & 
                               If(varShowOutOfSyncMeetings, "Showing meetings that are out of sync", "meetings are out of sync")
                                
                            )
                        )
                    Tooltip: =Self.Text
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.LayoutGap - conSyncStatus_ServiceRequest.Width - Parent.PaddingRight
                    X: =40
                    Y: =40
                    ZIndex: =2

            btnShowHideUnsynchedMeetings_ServiceRequest As button:
                Align: =Align.Left
                BorderColor: =ColorValue(varThemeColors.background)
                BorderThickness: =0
                Color: =ColorValue(varThemeColors.primary)
                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                DisabledColor: =ColorValue(varThemeColors.disabledText)
                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                Fill: =ColorValue(varThemeColors.backgroundFill)
                FocusedBorderColor: =ColorValue(varThemeColors.text)
                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                Font: =varThemeFont.B2.face
                FontWeight: =varThemeFont.B2.weightSemibold
                Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                HoverBorderColor: =ColorValue(varThemeColors.backgroundFill)
                HoverColor: =ColorValue(varThemeColors.tertiary)
                HoverFill: =ColorValue(varThemeColors.backgroundFill)
                Italic: =varThemeFont.CTA.italic
                OnSelect: |-
                    =//Toggle between showing only out of sync meetings in the gallery
                    Set(
                        varShowOutOfSyncMeetings,  
                        !varShowOutOfSyncMeetings
                    )
                PaddingBottom: =0
                PaddingLeft: =    
                PaddingRight: =0
                PaddingTop: =
                PressedBorderColor: =ColorValue(varThemeColors.backgroundFill)
                PressedColor: =Self.Color
                PressedFill: =ColorValue(varThemeColors.backgroundFill)
                RadiusBottomLeft: =6
                RadiusBottomRight: =6
                RadiusTopLeft: =varControlLayoutProperties.buttonLink.borderRadius
                RadiusTopRight: =6
                Size: =varThemeFont.B2.size
                Text: ="Show " & If(varShowOutOfSyncMeetings, "all", "out-of-sync") & " meetings"
                Tooltip: =Self.Text
                Underline: =true
                Visible: =lblSyncStatus_MyRequest.Color = ColorValue(varThemeColors.error)
                Width: |-
                    =Min(
                        (Self.Size * 0.75) * Len(Self.Text), 
                        Parent.Width - Self.X - Parent.PaddingRight
                    )
                X: =33
                Y: =87
                ZIndex: =4

        shpHeaderDivider_MyRequest As rectangle:
            BorderColor: =ColorValue(varThemeColors.text)
            DisplayMode: =DisplayMode.View
            Fill: =ColorValue(varThemeColors.secondaryGray)
            Height: =2
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            Y: =
            ZIndex: =2

        galMeetings_ServiceRequests As gallery.variableTemplateHeightGallery:
            '#CopilotOverlayLabel': ="Filtered"
            AccessibleLabel: ="Meetings with service requests"
            AlignInContainer: =AlignInContainer.SetByContainer
            BorderColor: =Parent.Fill
            FillPortions: =0
            FocusedBorderThickness: =varThemeColors.focusBorderThickness
            Height: =Parent.Height - conSyncStatus_MyRequest.Height -  shpHeaderDivider_MyRequest.Height - Parent.PaddingTop - Parent.PaddingBottom
            Items: |-
                =SortByColumns(
                    Filter(
                        AddColumns(
                            Meetings,
                            meetingstartdate, Date(Year('Start Date'), Month('Start Date'), Day('Start Date')), //Get the start date w/o the time from meeting lookup column
                            meetingenddate, Date(Year('End Date'), Month('End Date'), Day('End Date')), //Get the end date w/o the time from meeting lookup column
                            calendarrecord, LookUp(
                                Office365Outlook.V4CalendarGetItems(varCalendar.Name).value,
                                iCalUId = 'Outlook Meeting Id'
                            )
                        ),
                        Status = 'Status (Meetings)'.Active,
                        'Owning User'.User = varCurrentUser.User, //Restrict the requests shown to only requests the currentuser has initiated
                        And(
                            IsBlank(Trim(compServiceRequests.MeetingFilter.MeetingName)) || compServiceRequests.MeetingFilter.MeetingName in 'Meeting Name', //Meeting Title
                            IsBlank(compServiceRequests.MeetingFilter.MeetingStartDate) || meetingstartdate >= compServiceRequests.MeetingFilter.MeetingStartDate, //Start Date
                            IsBlank(compServiceRequests.MeetingFilter.MeetingEndDate) || meetingenddate <= compServiceRequests.MeetingFilter.MeetingEndDate, //End Date
                            CountRows(compServiceRequests.MeetingFilter.StatusReasons) = 0 || IsBlank(compServiceRequests.MeetingFilter.StatusReasons) || 'Meeting ID' in compServiceRequests.FilteredMeetings, //Status
                            !varShowOutOfSyncMeetings || (
                                varShowOutOfSyncMeetings &&
                                //Check if current meeting is still in sync with outlook
                                Or(
                                    calendarrecord.startWithTimeZone <> 'Start Date',
                                    calendarrecord.endWithTimeZone <> 'End Date'
                                )
                            )
                        )
                    ),
                    "meetingenddate"
                )
            Layout: =Layout.Vertical
            LayoutMinHeight: =Self.TemplateHeight * Max(Self.AllItemsCount, 1)
            LayoutMinWidth: =320
            LoadingSpinner: =LoadingSpinner.Data
            Selectable: =false
            TabIndex: =0
            TemplatePadding: =0
            TemplateSize: =Max(conMain_ServiceRequests.Height, 1)
            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
            ZIndex: =3

            conMain_ServiceRequests As groupContainer.horizontalAutoLayoutContainer:
                DropShadow: =DropShadow.None
                Height: |-
                    =Self.PaddingTop +
                    
                    conMeetingDetails_ServiceRequest.Height +
                    conServiceRequests_ServiceRequest.Height +
                    shpgalServiceRequestDivider_ServiceRequest.Height + 
                    
                    Self.PaddingBottom + (Self.LayoutGap * 2)
                LayoutDirection: =LayoutDirection.Vertical
                LayoutMode: =LayoutMode.Auto
                RadiusBottomLeft: =0
                RadiusBottomRight: =0
                RadiusTopLeft: =0
                RadiusTopRight: =0
                Width: =Parent.Width
                ZIndex: =1

                conMeetingDetails_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: |-
                        =Self.PaddingTop + conMeetingStartEnd_ServiceRequest.Height + 
                        If(
                            Self.LayoutDirection = LayoutDirection.Vertical,
                            Self.LayoutGap + conMeetingNameLocation_ServiceRequest.Height + 
                            
                            If(
                                conActionsContainer_ServiceRequest.Visible, 
                                Self.LayoutGap + conActionsContainer_ServiceRequest.Height,
                                0
                            ),
                            
                            0
                        ) + Self.PaddingBottom
                    LayoutDirection: =compServiceRequests.ControlLayoutProperties.myRequestsGallery.LayoutDirection
                    LayoutGap: |-
                        =If(
                            Self.LayoutDirection = LayoutDirection.Horizontal,
                            compServiceRequests.ControlLayoutProperties.gap.medium,
                            compServiceRequests.ControlLayoutProperties.gap.extraSmall
                        )
                    LayoutMinHeight: =100
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: |-
                        =If(
                            Self.LayoutDirection = LayoutDirection.Horizontal,
                            compServiceRequests.ControlLayoutProperties.outerPadding.top,
                            compServiceRequests.ControlLayoutProperties.gap.small
                        )
                    PaddingLeft: =compServiceRequests.ControlLayoutProperties.outerPadding.left
                    PaddingRight: =compServiceRequests.ControlLayoutProperties.outerPadding.left
                    PaddingTop: |-
                        =If(
                            Self.LayoutDirection = LayoutDirection.Horizontal,
                            compServiceRequests.ControlLayoutProperties.outerPadding.top,
                            compServiceRequests.ControlLayoutProperties.gap.small
                        )
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    ZIndex: =1

                    conMeetingStartEnd_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: |
                            =Self.PaddingTop + lblMeetingEndDate_ServiceRequest.Height + 
                            Self.LayoutGap + lblMeetingStartEndTime_ServiceRequest.Height + 
                            If(
                                conMeetingSync_ServiceRequest.Visible, 
                                Self.LayoutGap + conMeetingSync_ServiceRequest.Height
                             ) + Self.PaddingBottom
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.small
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =2
                        PaddingLeft: =
                        PaddingTop: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: |-
                            =If(
                                Parent.LayoutDirection = LayoutDirection.Horizontal,
                                Parent.Width * 0.125,
                                Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            )
                        ZIndex: =2

                        lblMeetingEndDate_ServiceRequest As label:
                            AutoHeight: =true
                            Color: =ColorValue(varThemeColors.text)
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weightSemibold
                            Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =
                            PaddingLeft: =
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B1.size
                            Text: =Text(ThisItem.'End Date', "dd mmm, yyyy")
                            Tooltip: =Self.Text
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            Wrap: =false
                            X: =40
                            Y: =40
                            ZIndex: =1

                        lblMeetingStartEndTime_ServiceRequest As label:
                            Color: =ColorValue(varThemeColors.text)
                            Font: =varThemeFont.B3.face
                            FontWeight: =varThemeFont.B3.weight
                            Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                            Italic: =varThemeFont.B1.italic
                            PaddingBottom: =
                            PaddingLeft: =
                            PaddingRight: =0
                            PaddingTop: =0
                            Size: =varThemeFont.B3.size
                            Text: |-
                                =Concatenate(
                                    Text(ThisItem.'Start Date', "h:mm AM/PM"), 
                                    " ",
                                    "to", 
                                    " ",
                                    Text(ThisItem.'End Date', "h:mm AM/PM")
                                )
                            Tooltip: =Self.Text
                            VerticalAlign: =VerticalAlign.Top
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            Wrap: =false
                            X: =40
                            Y: =40
                            ZIndex: =2

                        conMeetingSync_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            Fill: =RGBA(0,0,0,0)
                            FillPortions: =0
                            Height: =Self.PaddingTop + conMeetingOutdated_ServiceRequest.Height + Self.PaddingBottom
                            LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                            LayoutMinHeight: =100
                            LayoutMinWidth: =100
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =
                            PaddingLeft: =
                            PaddingRight: =
                            PaddingTop: =
                            RadiusBottomLeft: =Self.Height
                            RadiusBottomRight: =Self.Height
                            RadiusTopLeft: =Self.Height
                            RadiusTopRight: =Self.Height
                            Visible: |-
                                =//Check if current meeting is still in sync with outlook
                                Or(
                                    ThisItem.calendarrecord.startWithTimeZone <> ThisItem.'Start Date',
                                    ThisItem.calendarrecord.endWithTimeZone <> ThisItem.'End Date',
                                    ThisItem.calendarrecord.subject <> ThisItem.'Meeting Name'
                                )
                            Width: =Min(Self.PaddingLeft + conMeetingOutdated_ServiceRequest.Width + Self.LayoutGap + lblMeetingOutdated_ServiceRequest.Width + Self.PaddingRight, lblService_ServiceRequest.Width)
                            ZIndex: =3

                            conMeetingOutdated_ServiceRequest As groupContainer.manualLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                BorderStyle: =BorderStyle.None
                                DropShadow: =DropShadow.None
                                Fill: =
                                FillPortions: =0
                                Height: =icoMeetingOutdated_ServiceRequest.Height
                                LayoutMinHeight: =100
                                LayoutMinWidth: =250
                                RadiusBottomLeft: =Self.Height
                                RadiusBottomRight: =Self.Height
                                RadiusTopLeft: =Self.Height
                                RadiusTopRight: =Self.Height
                                Width: =icoMeetingOutdated_ServiceRequest.Height
                                ZIndex: =2

                                icoMeetingOutdated_ServiceRequest As icon.Waypoint:
                                    BorderStyle: =BorderStyle.None
                                    Color: =ColorValue(varThemeColors.backgroundFill)
                                    DisplayMode: =DisplayMode.View
                                    Fill: =lblSyncStatus_MyRequest.Color
                                    FocusedBorderThickness: =1
                                    Height: =lblMeetingOutdated_ServiceRequest.Height - lblMeetingOutdated_ServiceRequest.PaddingTop - lblMeetingOutdated_ServiceRequest.PaddingBottom
                                    Icon: =Icon.Warning
                                    PaddingBottom: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.bottom
                                    PaddingLeft: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.left
                                    PaddingRight: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.right
                                    PaddingTop: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.top
                                    Width: =Self.Height
                                    ZIndex: =1

                            lblMeetingOutdated_ServiceRequest As label:
                                BorderColor: =RGBA(0, 0, 0, 0)
                                BorderStyle: =BorderStyle.None
                                BorderThickness: =2
                                Color: =ColorValue(varThemeColors.text)
                                DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B2.italic
                                OnSelect: =
                                PaddingBottom: =
                                PaddingLeft: =0
                                PaddingRight: =0
                                PaddingTop: =
                                Role: =TextRole.Heading2
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    = If(
                                            IsBlank(ThisItem.calendarrecord),
                                            "Cancelled",
                                            "Out of sync"
                                        )
                                Tooltip: =Self.Text
                                Width: |-
                                    =(
                                        If(
                                            Len(Self.Text) > 5,    
                                            (Self.Size * 0.75),
                                            Self.Size 
                                        ) * Len(Self.Text)  
                                    ) + Self.PaddingRight
                                Wrap: =false
                                X: =
                                Y: =Parent.PaddingTop
                                ZIndex: =3

                    conMeetingNameLocation_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: |-
                            =Self.PaddingTop + Self.LayoutGap + Self.PaddingBottom + 
                            lblMeetingName_ServiceRequest.Height + conMeetingLocation_ServiceRequest.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.small
                        LayoutMinHeight: =100
                        LayoutMinWidth: =250
                        LayoutMode: =LayoutMode.Auto
                        PaddingLeft: =
                        PaddingTop: =
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Width: |-
                            =If(
                                Parent.LayoutDirection = LayoutDirection.Horizontal,
                                (Parent.Width * 0.6),
                                Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            )
                        ZIndex: =3

                        conMeetingSubject_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblMeetingName_ServiceRequest.Height
                            LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =
                            PaddingLeft: =
                            PaddingRight: =
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            ZIndex: =2

                            lblMeetingName_ServiceRequest As label:
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B1.face
                                FontWeight: =varThemeFont.B1.weightSemibold
                                Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =
                                PaddingLeft: =
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B1.size
                                Text: =Coalesce(ThisItem.'Meeting Name', "---")
                                Tooltip: =Self.Text
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                Wrap: =false
                                X: =40
                                Y: =40
                                ZIndex: =1

                        conMeetingLocation_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                            AlignInContainer: =AlignInContainer.SetByContainer
                            DropShadow: =DropShadow.None
                            FillPortions: =0
                            Height: =lblMeetingLocation_ServiceRequest.Height
                            LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                            LayoutMinHeight: =100
                            LayoutMinWidth: =250
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: =
                            PaddingLeft: =
                            PaddingRight: =
                            PaddingTop: =
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            ZIndex: =3

                            icoLocationIcon_ServiceRequest As icon.Waypoint:
                                Color: =lblMeetingLocation_ServiceRequest.Color
                                DisplayMode: =DisplayMode.View
                                Height: =(lblMeetingLocation_ServiceRequest.Size * 1.8) + lblMeetingLocation_ServiceRequest.PaddingTop + lblMeetingLocation_ServiceRequest.PaddingBottom 
                                Icon: =Icon.Waypoint
                                Width: =Self.Height
                                ZIndex: =1

                            lblMeetingLocation_ServiceRequest As label:
                                AutoHeight: =true
                                Color: =ColorValue(varThemeColors.tertiaryGray)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B2.italic
                                PaddingBottom: =
                                PaddingLeft: =
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B2.size
                                Text: =Coalesce(ThisItem.Location, "-") //Location
                                Tooltip: =Self.Text
                                VerticalAlign: =VerticalAlign.Top
                                Width: =Parent.Width - Self.X - Parent.PaddingRight
                                X: =40
                                Y: =40
                                ZIndex: =2

                    conActionsContainer_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                        AlignInContainer: =AlignInContainer.SetByContainer
                        DropShadow: =DropShadow.None
                        FillPortions: =0
                        Height: |-
                            =Self.PaddingTop + Self.PaddingBottom + 
                            btnActionButton_ServiceRequest.Height
                        LayoutDirection: =LayoutDirection.Vertical
                        LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.small
                        LayoutMinHeight: =100
                        LayoutMinWidth: =Len(btnActionButton_ServiceRequest.Text) * btnActionButton_ServiceRequest.Size
                        LayoutMode: =LayoutMode.Auto
                        PaddingBottom: =btnActionButton_ServiceRequest.FocusedBorderThickness
                        PaddingLeft: =btnActionButton_ServiceRequest.FocusedBorderThickness
                        PaddingRight: =btnActionButton_ServiceRequest.FocusedBorderThickness
                        PaddingTop: =btnActionButton_ServiceRequest.FocusedBorderThickness
                        RadiusBottomLeft: =0
                        RadiusBottomRight: =0
                        RadiusTopLeft: =0
                        RadiusTopRight: =0
                        Visible: =conMeetingSync_ServiceRequest.Visible
                        Width: |-
                            =If(
                                Parent.LayoutDirection = LayoutDirection.Horizontal,
                                ((Parent.Width * 0.25) - (Parent.LayoutGap * 2) - Parent.PaddingLeft - Parent.PaddingRight) + Self.PaddingLeft + Self.PaddingRight,
                                Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                            )
                        ZIndex: =4

                        btnActionButton_ServiceRequest As button:
                            BorderColor: =Self.Color
                            BorderThickness: =1
                            Color: |-
                                =If(
                                    IsBlank(ThisItem.calendarrecord),
                                    ColorValue(varThemeColors.error),
                                    ColorValue(varThemeColors.primary)
                                )
                            DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                            DisabledColor: =ColorValue(varThemeColors.disabledText)
                            DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                            Fill: =ColorValue(varThemeColors.backgroundFill)
                            FocusedBorderColor: =ColorValue(varThemeColors.focusBorder)
                            FocusedBorderThickness: =varThemeColors.focusBorderThickness
                            Font: =varThemeFont.B1.face
                            FontWeight: =varThemeFont.B1.weightSemibold
                            Height: |-
                                =If(
                                    Parent.Width > ((Self.Size * 0.75) * Len(Self.Text)),
                                    Self.Size * 1.8,
                                    Self.Size * 3.6
                                ) + Self.PaddingTop + Self.PaddingBottom
                            HoverBorderColor: =ColorValue(varThemeColors.primary)
                            HoverColor: =Self.Color
                            HoverFill: =Self.Fill
                            Italic: =varThemeFont.CTA.italic
                            LayoutMinHeight: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                            OnSelect: |-
                                =//Collect service requests to update
                                ClearCollect(
                                    colServiceRequests, 
                                    Filter(
                                        'Service Requests',
                                        Meeting.'Meeting ID' = ThisItem.'Meeting ID',
                                        'Status Reason' = 'Status Reason (Service Requests)'.New ||
                                        'Status Reason' = 'Status Reason (Service Requests)'.'In progress'
                                    )
                                );
                                
                                //Check if button cancels new and in progress SRs
                                If(
                                    //button selected is for Cancel requests
                                    IsBlank(ThisItem.calendarrecord),
                                    
                                    //Tag meeting as inactive
                                    IfError(
                                        Patch(
                                            Meetings,
                                            LookUp(Meetings, 'Meeting ID' = ThisItem.'Meeting ID'),
                                            {
                                                Status: 'Status (Meetings)'.Inactive
                                            }
                                        )
                                        ,
                                        Notify(
                                           "Error on deactivating record in dataverse for meeting" & " " & ThisItem.'Meeting Name' & 
                                            Concat(
                                                Errors(Meetings),
                                                Column & ": " & Message
                                            ),
                                            NotificationType.Error
                                        ),
                                
                                        //Meeting patch was successful
                                        //Check if there are requests to cancel
                                        If(
                                            CountRows(colServiceRequests) > 0,
                                            ForAll(
                                                colServiceRequests,
                                                Patch(
                                                    'Service Requests',
                                                    ThisRecord,
                                                    {
                                                        Status: 'Status (Service Requests)'.Inactive,
                                                        'Status Reason': 'Status Reason (Service Requests)'.Cancelled
                                                    }
                                                )
                                            ),
                                
                                            //Else, nothing to cancel
                                            Notify(
                                               "Nothing to cancel."
                                            )
                                        ),
                                
                                        //Error encountered on cancelling SRs
                                        Notify(
                                            "Error on cancelling service request(s) for meeting" & " " & ThisItem.'Meeting Name' & 
                                            Concat(
                                                Errors('Service Requests'),
                                                Column & ": " & Message
                                            ),
                                            NotificationType.Error
                                        ),
                                        //Patch successful for SRs
                                        Navigate(
                                            'Success Screen', 
                                            Transition.None, 
                                            {
                                                var_Header: "Cancelled meeting synched successfully",
                                                var_Message: "Service requests associated to this meeting have been cancelled successfully.",
                                                var_Destination: 'My Requests Screen',
                                                var_ButtonText: "Return to My Requests Screen",
                                                var_ButtonWidth: 250
                                            }
                                        );
                                    ) //End IfError
                                        
                                    , 
                                    //ELSE - button selected is for Sync meeting details
                                    //Update/sync meeting details to this record
                                    IfError(
                                        Patch(
                                            Meetings,
                                            LookUp(Meetings, 'Meeting ID' = ThisItem.'Meeting ID'),
                                            {
                                                'Meeting Name': ThisItem.calendarrecord.subject,
                                                'Start Date': ThisItem.calendarrecord.startWithTimeZone,
                                                'End Date': ThisItem.calendarrecord.endWithTimeZone,
                                                Location: ThisItem.calendarrecord.location
                                            }
                                        )
                                        ,
                                        //Error encountered on updating meeting record
                                        Notify(
                                           "Error on synching record in dataverse with outlook meeting" & " " & ThisItem.'Meeting Name' & 
                                            Concat(
                                                Errors(Meetings),
                                                Column & ": " & Message
                                            ),
                                            NotificationType.Error
                                        ),
                                
                                        //Meeting patch was successful
                                        //Check if there are requests to resubmit
                                        If(
                                            CountRows(colServiceRequests) > 0,
                                            ForAll(
                                                colServiceRequests,
                                                Patch(
                                                    'Service Requests',
                                                    ThisRecord,
                                                    {
                                                        'Status Reason': 'Status Reason (Service Requests)'.Resubmitted
                                                    }
                                                )
                                            ),
                                
                                            //Else, nothing to cancel
                                            Notify(
                                              "Nothing to resubmit."
                                            )
                                        ),
                                
                                        //Error encountered on resubmitting SRs
                                        Notify(
                                           "Error on resubmitting service request(s) for meeting" & " " & ThisItem.'Meeting Name' & 
                                            Concat(
                                                Errors('Service Requests'),
                                                Column & ": " & Message
                                            ),
                                            NotificationType.Error
                                        ),
                                        //Patch successful for SRs
                                        Navigate(
                                            'Success Screen', 
                                            Transition.None, 
                                            {
                                                var_Header: "Synched meeting details successfully",
                                                var_Message: "Service requests associated to this meeting have been resubmitted successfully.",
                                                var_Destination: 'My Requests Screen',
                                                var_ButtonText: "Return to My Requests Screen",
                                                var_ButtonWidth: 250
                                            }
                                        );
                                    ) //End IfError
                                );
                                
                                Clear(colServiceRequests);
                            PaddingBottom: =varControlLayoutProperties.button.paddingBottom
                            PaddingLeft: =varControlLayoutProperties.button.paddingLeft
                            PaddingRight: =varControlLayoutProperties.button.paddingRight
                            PaddingTop: =varControlLayoutProperties.button.paddingTop
                            PressedBorderColor: =ColorValue(varThemeColors.primary)
                            PressedColor: =Self.Color
                            PressedFill: =Self.Fill
                            RadiusBottomLeft: =6
                            RadiusBottomRight: =6
                            RadiusTopLeft: =varControlLayoutProperties.button.borderRadius
                            RadiusTopRight: =6
                            Size: =varThemeFont.B1.size
                            Text: |-
                                = If(
                                        IsBlank(ThisItem.calendarrecord),
                                        "Cancel requests",
                                        "Sync meeting details"
                                    )
                            Width: |-
                                =Min(
                                    (Self.Size * 0.75) * Len(Self.Text), 
                                    (Parent.Width) - Parent.PaddingLeft - Parent.PaddingRight
                                )
                            X: =
                            Y: =8
                            ZIndex: =1

                conServiceRequests_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                    AlignInContainer: =AlignInContainer.SetByContainer
                    DropShadow: =DropShadow.None
                    FillPortions: =0
                    Height: =Self.PaddingTop + galServiceRequests_ServiceRequest.Height + Self.PaddingBottom
                    LayoutDirection: =LayoutDirection.Vertical
                    LayoutMinHeight: |-
                        =Self.PaddingTop + Self.PaddingBottom + 
                        galServiceRequests_ServiceRequest.Height
                    LayoutMinWidth: =250
                    LayoutMode: =LayoutMode.Auto
                    PaddingBottom: =compServiceRequests.ControlLayoutProperties.outerPadding.bottom
                    PaddingLeft: =compServiceRequests.ControlLayoutProperties.outerPadding.left
                    PaddingRight: =compServiceRequests.ControlLayoutProperties.outerPadding.right
                    PaddingTop: =2
                    RadiusBottomLeft: =0
                    RadiusBottomRight: =0
                    RadiusTopLeft: =0
                    RadiusTopRight: =0
                    Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                    ZIndex: =2

                    "galServiceRequests_ServiceRequest As gallery.'BrowseLayout_Vertical_TwoTextOneImageVariant_ver5.0'":
                        '#CopilotOverlayLabel': ="Filtered"
                        AccessibleLabel: ="Service requests for" & " " & ThisItem.'Meeting Name'
                        AlignInContainer: =AlignInContainer.SetByContainer
                        BorderColor: =Parent.Fill
                        FillPortions: =0
                        FocusedBorderColor: =ColorValue(varThemeColors.backgroundFill)
                        FocusedBorderThickness: =varThemeColors.focusBorderThickness
                        Height: =Self.AllItemsCount * Self.TemplateHeight
                        Items: |-
                            =With(
                                {
                                    _MeetingRecordId: ThisItem.'Meeting ID',
                                    _CalendarRecord: ThisItem.calendarrecord
                                },
                                Filter(
                                    AddColumns(
                                        'Service Requests',
                                        calendarrecord, 
                                        _CalendarRecord
                                    ),
                                    'Owning User'.User = varCurrentUser.User, //Restrict the requests shown to only requests the currentuser has initiated
                                    And(
                                        Meeting.'Meeting ID' = _MeetingRecordId,
                                        CountRows(compServiceRequests.FilteredMeetings) = 0 || 'Status Reason' in compServiceRequests.MeetingFilter.StatusReasons
                                    )
                                )
                            )
                        Layout: =Layout.Vertical
                        LayoutMinHeight: =287
                        LayoutMinWidth: =320
                        LoadingSpinner: =LoadingSpinner.Data
                        OnSelect: =
                        ShowScrollbar: =false
                        TabIndex: =0
                        TemplatePadding: =0
                        TemplateSize: =compServiceRequests.TemplateHeight
                        Visible: =Self.Height > 0
                        Width: =Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                        ZIndex: =1

                        conGallery_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                            BorderColor: =ColorValue(varThemeColors.secondaryGray)
                            BorderThickness: |-
                                =If(
                                    Self.LayoutDirection = LayoutDirection.Horizontal, 
                                    0, 
                                    2
                                )
                            DropShadow: =DropShadow.None
                            Height: =Parent.TemplateHeight - Self.PaddingBottom
                            LayoutDirection: =compServiceRequests.ControlLayoutProperties.myRequestsGallery.LayoutDirection
                            LayoutGap: |-
                                =If(
                                    Self.LayoutDirection = LayoutDirection.Horizontal,
                                    compServiceRequests.ControlLayoutProperties.gap.medium,
                                    compServiceRequests.ControlLayoutProperties.gap.extraSmall
                                )
                            LayoutMode: =LayoutMode.Auto
                            PaddingBottom: |-
                                =If(
                                    Self.LayoutDirection = LayoutDirection.Vertical, 
                                    compServiceRequests.ControlLayoutProperties.gap.small,
                                    0
                                )
                            PaddingLeft: =btnSRNumber_ServiceRequest.FocusedBorderThickness
                            PaddingRight: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                            PaddingTop: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                            RadiusBottomLeft: =0
                            RadiusBottomRight: =0
                            RadiusTopLeft: =0
                            RadiusTopRight: =0
                            Width: =Parent.TemplateWidth
                            ZIndex: =2

                            btnSRNumber_ServiceRequest As button:
                                Align: =Align.Left
                                BorderColor: =ColorValue(varThemeColors.background)
                                BorderThickness: =0
                                Color: =ColorValue(varThemeColors.primary)
                                DisabledBorderColor: =ColorValue(varThemeColors.backgroundFillDisabled)
                                DisabledColor: =ColorValue(varThemeColors.disabledText)
                                DisabledFill: =ColorValue(varThemeColors.backgroundFillDisabled)
                                Fill: =ColorValue(varThemeColors.backgroundFill)
                                FocusedBorderColor: =ColorValue(varThemeColors.text)
                                FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weightSemibold
                                Height: =conStatus_ServiceRequest.Height + Self.PaddingTop + Self.PaddingBottom
                                HoverBorderColor: =ColorValue(varThemeColors.backgroundFill)
                                HoverColor: =ColorValue(varThemeColors.tertiary)
                                HoverFill: =ColorValue(varThemeColors.backgroundFill)
                                Italic: =varThemeFont.CTA.italic
                                OnSelect: |-
                                    =NewForm(frmRequestDetails_RequestDetails);
                                    Set(varServiceRequestItem,ThisItem);
                                    //Navigate to Request Detail Screen with Variable to identify if the meeting is cancelled or not
                                    Navigate('Request Details Screen', Transition.None,{var_Status: 
                                    
                                    lblMeetingOutdated_ServiceRequest
                                        .Text =
                                        "Cancelled" || ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.Cancelled
                                    } 
                                    
                                    
                                    );
                                PaddingBottom: =0
                                PaddingLeft: =    
                                PaddingRight: =0
                                PaddingTop: =
                                PressedBorderColor: =ColorValue(varThemeColors.backgroundFill)
                                PressedColor: =Self.Color
                                PressedFill: =ColorValue(varThemeColors.backgroundFill)
                                RadiusBottomLeft: =6
                                RadiusBottomRight: =6
                                RadiusTopLeft: =varControlLayoutProperties.buttonLink.borderRadius
                                RadiusTopRight: =6
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    ="#" & Coalesce(ThisItem.'Service Request Number', "-")
                                Underline: =true
                                Width: |-
                                    =If(
                                        Parent.LayoutDirection = LayoutDirection.Horizontal,
                                        Max(Parent.Width * 0.125, compServiceRequests.ControlLayoutProperties.myRequestsGallery.serviceReqNumberMinWidth),
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    )
                                X: =33
                                Y: =87
                                ZIndex: =1

                            lblService_ServiceRequest As label:
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =conStatus_ServiceRequest.Height + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =
                                PaddingLeft: =
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    =Coalesce(ThisItem.Service.'Service Name', "-") & 
                                    If(
                                        Parent.LayoutDirection = LayoutDirection.Vertical,
                                        "  " & 
                                        Coalesce(ThisItem.SubService.'Subservice Name', "-"), 
                                        ""
                                    )
                                Tooltip: =Self.Text
                                Width: |-
                                    =If(
                                        Parent.LayoutDirection = LayoutDirection.Horizontal,
                                        Max(Parent.Width * 0.125, compServiceRequests.ControlLayoutProperties.myRequestsGallery.serviceReqNumberMinWidth),
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    )
                                Wrap: =false
                                X: =40
                                Y: =40
                                ZIndex: =2

                            lblSubService_ServiceRequest As label:
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =conStatus_ServiceRequest.Height + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =0
                                PaddingLeft: =
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B2.size
                                Text: =Coalesce(ThisItem.SubService.'Subservice Name', "-")
                                Tooltip: =Self.Text
                                Visible: =Parent.LayoutDirection = LayoutDirection.Horizontal
                                Width: |-
                                    =If(
                                        Parent.LayoutDirection = LayoutDirection.Horizontal,
                                        Max(Parent.Width * 0.125, compServiceRequests.ControlLayoutProperties.myRequestsGallery.serviceReqNumberMinWidth),
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    )
                                Wrap: =false
                                X: =40
                                Y: =40
                                ZIndex: =3

                            lblRequestDate_ServiceRequest As label:
                                Color: =ColorValue(varThemeColors.text)
                                Font: =varThemeFont.B2.face
                                FontWeight: =varThemeFont.B2.weight
                                Height: =conStatus_ServiceRequest.Height + Self.PaddingTop + Self.PaddingBottom
                                Italic: =varThemeFont.B1.italic
                                PaddingBottom: =
                                PaddingLeft: =
                                PaddingRight: =0
                                PaddingTop: =0
                                Size: =varThemeFont.B2.size
                                Text: |-
                                    =Concatenate(
                                       "Requested on",
                                        " ",
                                        Coalesce(
                                            Text(
                                                ThisItem.'Requested On',
                                                "d mmm, yyyy"
                                            ),
                                            "-"
                                        )
                                    )
                                Tooltip: =Self.Text
                                Width: |-
                                    =If(
                                        Parent.LayoutDirection = LayoutDirection.Horizontal,
                                        Max(Parent.Width * 0.25, compServiceRequests.ControlLayoutProperties.myRequestsGallery.serviceReqNumberMinWidth),
                                        Parent.Width - Parent.PaddingLeft - Parent.PaddingRight
                                    )
                                Wrap: =false
                                X: =40
                                Y: =40
                                ZIndex: =5

                            conStatus_ServiceRequest As groupContainer.horizontalAutoLayoutContainer:
                                AlignInContainer: =AlignInContainer.SetByContainer
                                DropShadow: =DropShadow.None
                                Fill: =RGBA(0,0,0,0)
                                FillPortions: =0
                                Height: =conStatusIcon_ServiceRequest.Height + Self.PaddingTop + Self.PaddingBottom
                                LayoutGap: =compServiceRequests.ControlLayoutProperties.gap.extraSmall
                                LayoutMinHeight: =100
                                LayoutMinWidth: =250
                                LayoutMode: =LayoutMode.Auto
                                PaddingBottom: =
                                PaddingLeft: =
                                PaddingRight: =
                                PaddingTop: =
                                RadiusBottomLeft: =0
                                RadiusBottomRight: =0
                                RadiusTopLeft: =0   
                                RadiusTopRight: =0
                                Width: |-
                                    =Min(
                                        Self.PaddingLeft + 
                                        conStatusIcon_ServiceRequest.Width + Self.LayoutGap + 
                                        lblStatus_ServiceRequest.Width + Self.LayoutGap + 
                                        icoCancelledOrUpdated_ServiceRequest.Width + 
                                        Self.PaddingRight,
                                    
                                        (Parent.Width - Self.X) - Parent.PaddingRight
                                    )
                                ZIndex: =6

                                conStatusIcon_ServiceRequest As groupContainer.manualLayoutContainer:
                                    AlignInContainer: =AlignInContainer.SetByContainer
                                    BorderStyle: =BorderStyle.None
                                    DropShadow: =DropShadow.None
                                    Fill: =
                                    FillPortions: =0
                                    Height: =icoStatus_ServiceRequest.Height
                                    LayoutMinHeight: =100
                                    LayoutMinWidth: =250
                                    RadiusBottomLeft: =Self.Height
                                    RadiusBottomRight: =Self.Height
                                    RadiusTopLeft: =Self.Height
                                    RadiusTopRight: =Self.Height
                                    Width: =icoStatus_ServiceRequest.Height
                                    ZIndex: =2

                                    icoStatus_ServiceRequest As icon.Waypoint:
                                        AccessibleLabel: =Self.Tooltip
                                        BorderStyle: =BorderStyle.None
                                        Color: =ColorValue(varThemeColors.backgroundFill)
                                        DisplayMode: =DisplayMode.View
                                        Fill: |-
                                            =// Determine the color based on the Status of the current item.
                                            Switch(
                                                ThisItem.'Status Reason',
                                                'Status Reason (Service Requests)'.New,
                                                ColorValue(varThemeColors.warning),
                                                'Status Reason (Service Requests)'.Completed,
                                                ColorValue(varThemeColors.confirmation),
                                                'Status Reason (Service Requests)'.Cancelled,
                                                ColorValue(varThemeColors.error),
                                                ColorValue(varThemeColors.tertiaryGray)
                                            )
                                        FocusedBorderThickness: =1
                                        Height: =lblStatus_ServiceRequest.Height
                                        Icon: |-
                                            =Switch(
                                                ThisItem.'Status Reason',
                                                'Status Reason (Service Requests)'.Completed,
                                                Icon.Check,
                                                'Status Reason (Service Requests)'.New,
                                                Icon.Clock,
                                                'Status Reason (Service Requests)'.Cancelled,
                                                Icon.Cancel,
                                                Icon.Sync
                                            )
                                        PaddingBottom: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.bottom
                                        PaddingLeft: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.left
                                        PaddingRight: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.right
                                        PaddingTop: =compServiceRequests.ControlLayoutProperties.iconBorderRadius.top
                                        Tooltip: =If(!lblStatus_ServiceRequest.Visible, lblStatus_ServiceRequest.Text)
                                        Width: =Self.Height
                                        ZIndex: =1

                                lblStatus_ServiceRequest As label:
                                    BorderColor: =RGBA(0, 0, 0, 0)
                                    BorderStyle: =BorderStyle.None
                                    BorderThickness: =2
                                    Color: =ColorValue(varThemeColors.text)
                                    DisabledBorderColor: =RGBA(0, 0, 0, 0)
                                    FocusedBorderColor: =ColorValue(varThemeColors.primaryGray)
                                    FocusedBorderThickness: =varThemeColors.focusBorderThickness
                                    Font: =varThemeFont.B2.face
                                    FontWeight: =varThemeFont.B2.weight
                                    Height: =(Self.Size * 1.8) + Self.PaddingTop + Self.PaddingBottom
                                    Italic: =varThemeFont.B2.italic
                                    OnSelect: =
                                    PaddingBottom: =
                                    PaddingLeft: =0
                                    PaddingRight: |-
                                        =If(
                                            ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.New Or
                                            ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.Completed,
                                            5,
                                            0
                                        )
                                    PaddingTop: =
                                    Role: =TextRole.Heading2
                                    Size: =varThemeFont.B2.size
                                    Text: =ThisItem.'Status Reason'
                                    Tooltip: =Self.Text
                                    Visible: |-
                                        =If(
                                            Self.Width + conStatusIcon_ServiceRequest.Width + If(icoCancelledOrUpdated_ServiceRequest.Visible, icoCancelledOrUpdated_ServiceRequest.Width, 0) > Parent.Width, 
                                            false, 
                                            true
                                        )
                                    Width: |-
                                        =(
                                            (Self.Size *  
                                                If(Len(Self.Text) > 5,
                                                    0.75,
                                                    1
                                                )
                                            ) * Len(Self.Text)
                                        ) + Self.PaddingRight
                                    Wrap: =false
                                    X: =icoStatus_ServiceRequest.X + icoStatus_ServiceRequest.Width
                                    Y: =Parent.PaddingTop
                                    ZIndex: =3

                                icoCancelledOrUpdated_ServiceRequest As icon.Waypoint:
                                    AccessibleLabel: =Self.Tooltip
                                    BorderStyle: =BorderStyle.None
                                    Color: |-
                                        =If(
                                            Self.Icon = Icon.Warning, //Cancelled
                                            ColorValue(varThemeColors.error),
                                            ColorValue(varThemeColors.text) //Default for out of sync, or active meetings
                                        )
                                    DisplayMode: =DisplayMode.View
                                    Fill: =RGBA(0,0,0,0)
                                    FocusedBorderThickness: =1
                                    Height: =lblStatus_ServiceRequest.Height
                                    Icon: |
                                        =//Check parent meeting's current status
                                        If(
                                            IsBlank(ThisItem.calendarrecord) && 
                                            Or(
                                                ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.New,
                                                ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.'In progress'
                                            ), //Cancelled
                                            Icon.Warning,
                                        
                                            Or(
                                            ThisItem.calendarrecord.startWithTimeZone <> ThisItem.Meeting.'Start Date',
                                            ThisItem.calendarrecord.endWithTimeZone <> ThisItem.Meeting.'End Date'
                                            ) &&
                                            ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.Completed, //out of sync
                                            Icon.Information,
                                            
                                            //Else
                                            Blank()
                                        )
                                    PaddingBottom: =
                                    PaddingLeft: =
                                    PaddingRight: =
                                    PaddingTop: =
                                    Tooltip: |-
                                        =        If(
                                                    Self.Icon = Icon.Warning, //Cancelled meeting
                                                    "This request is associated with a cancelled meeting. Cancel this request if you no longer need it.", 
                                                    Self.Icon = Icon.Information, //Out of sync, and completed already
                                                    "The meeting details are changed after this request was completed. Create a new request for the updated meeting.",
                                                    //Else, no tooltip
                                                    ""
                                                )
                                    Visible: |-
                                        =//Check if current meeting is still in sync with outlook
                                        Or(
                                            ThisItem.calendarrecord.startWithTimeZone <> ThisItem.Meeting.'Start Date',
                                            ThisItem.calendarrecord.endWithTimeZone <> ThisItem.Meeting.'End Date'
                                        ) && 
                                        Or(
                                            IsBlank(ThisItem.calendarrecord) && 
                                            Or(
                                                ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.New,
                                                ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.'In progress'
                                            ),
                                            !IsBlank(ThisItem.calendarrecord) && ThisItem.'Status Reason' = 'Status Reason (Service Requests)'.Completed
                                        )
                                    Width: =Self.Height
                                    ZIndex: =4

                shpgalServiceRequestDivider_ServiceRequest As rectangle:
                    BorderColor: =ColorValue(varThemeColors.text)
                    Fill: =ColorValue(varThemeColors.secondaryGray)
                    Height: =1
                    Width: =Parent.Width
                    Y: =
                    ZIndex: =3

